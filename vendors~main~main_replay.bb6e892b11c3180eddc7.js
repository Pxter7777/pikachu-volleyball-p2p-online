(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[function(t,e,n){"use strict";n.d(e,"a",(function(){return U})),n.d(e,"b",(function(){return k})),n.d(e,"d",(function(){return M})),n.d(e,"e",(function(){return L})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return T})),n.d(e,"h",(function(){return R})),n.d(e,"i",(function(){return B})),n.d(e,"k",(function(){return V})),n.d(e,"l",(function(){return v})),n.d(e,"m",(function(){return y})),n.d(e,"o",(function(){return A})),n.d(e,"p",(function(){return d})),n.d(e,"q",(function(){return S})),n.d(e,"r",(function(){return I})),n.d(e,"s",(function(){return _})),n.d(e,"t",(function(){return w})),n.d(e,"u",(function(){return x})),n.d(e,"v",(function(){return E})),n.d(e,"w",(function(){return O})),n.d(e,"x",(function(){return m})),n.d(e,"y",(function(){return p})),n.d(e,"z",(function(){return P})),n.d(e,"A",(function(){return g})),n.d(e,"B",(function(){return F})),n.d(e,"C",(function(){return D}));var r=n(4);n.d(e,"n",(function(){return r.a}));var i=n(43),o=n.n(i);n.d(e,"c",(function(){return o.a}));var s=n(44),a=n.n(s);n.d(e,"j",(function(){return a.a}));var u=n(35),h=n.n(u);n.d(e,"D",(function(){return h.a}));var c=n(1);
/*!
 * @pixi/utils - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */r.b.RETINA_PREFIX=/@([0-9\.]+)x/,r.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var l,f=!1;function p(t){var e;if(!f){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 5.3.3 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,n)}else window.console&&window.console.log("PixiJS 5.3.3 - "+t+" - http://www.pixijs.com/");f=!0}}function d(){return void 0===l&&(l=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:r.b.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var o=n.getExtension("WEBGL_lose_context");o&&o.loseContext()}return n=null,i}catch(t){return!1}}()),l}function v(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function y(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function g(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16)}function m(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var _=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[c.b.NORMAL_NPM]=c.b.NORMAL,t[c.b.ADD_NPM]=c.b.ADD,t[c.b.SCREEN_NPM]=c.b.SCREEN,e[c.b.NORMAL]=c.b.NORMAL_NPM,e[c.b.ADD]=c.b.ADD_NPM,e[c.b.SCREEN]=c.b.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function b(t,e){return _[e?1:0][t]}function w(t,e,n,r){return n=n||new Float32Array(4),r||void 0===r?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n}function x(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,r=t>>8&255,i=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(i=i*e+.5|0)}function E(t,e,n,r){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(r||void 0===r)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function T(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}Float32Array,Uint32Array,Int32Array,Uint8Array;function I(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function A(t){return!(t&t-1||!t)}function S(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function O(t,e,n){var r,i=t.length;if(!(e>=i||0===n)){var o=i-(n=e+n>i?i-e:n);for(r=e;r<o;++r)t[r]=t[r+n];t.length=o}}function P(t){return 0===t?0:t<0?-1:1}var C=0;function D(){return++C}var N={};function R(t,e,n){if(void 0===n&&(n=3),!N[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),N[e]=!0}}var M={},L=Object.create(null),U=Object.create(null);var k=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||r.b.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0}),t}();function F(t){var e,n,r,i=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,i,o).data,u=a.length,h={top:null,left:null,right:null,bottom:null},c=null;for(e=0;e<u;e+=4)0!==a[e+3]&&(n=e/4%i,r=~~(e/4/i),null===h.top&&(h.top=r),(null===h.left||n<h.left)&&(h.left=n),(null===h.right||h.right<n)&&(h.right=n+1),(null===h.bottom||h.bottom<r)&&(h.bottom=r));return null!==h.top&&(i=h.right-h.left,o=h.bottom-h.top+1,c=s.getImageData(h.left,h.top,i,o)),{height:o,width:i,data:c}}var j;function B(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,j||(j=document.createElement("a")),j.href=t;var n=Object(u.parse)(j.href),r=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&r&&n.protocol===e.protocol?"":"anonymous"}function V(t,e){var n=r.b.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}},function(t,e,n){"use strict";
/*!
 * @pixi/constants - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r,i,o,s,a,u,h,c,l,f,p,d,v,y,g,m,_;n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return v})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return y})),n.d(e,"i",(function(){return m})),n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return _})),n.d(e,"l",(function(){return g})),n.d(e,"m",(function(){return i})),n.d(e,"n",(function(){return l})),n.d(e,"o",(function(){return h})),n.d(e,"p",(function(){return c})),n.d(e,"q",(function(){return f})),function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(r||(r={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(i||(i={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(o||(o={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(s||(s={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(a||(a={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(u||(u={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(h||(h={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(c||(c={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(l||(l={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(f||(f={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(p||(p={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(d||(d={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(v||(v={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(y||(y={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(g||(g={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(m||(m={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(_||(_={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return f})),n.d(e,"h",(function(){return c})),n.d(e,"i",(function(){return o})),n.d(e,"j",(function(){return a})),n.d(e,"k",(function(){return l})),n.d(e,"l",(function(){return r})),n.d(e,"m",(function(){return E})),n.d(e,"n",(function(){return x}));
/*!
 * @pixi/math - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r,i=2*Math.PI,o=180/Math.PI,s=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(r||(r={}));var a=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=r.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this},t}(),u=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=r.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-t,i=this.y-e;return(r*=r)+(i*=i)<=n},t.prototype.getBounds=function(){return new a(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),h=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=r.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,r=(e-this.y)/this.height;return(n*=n)+(r*=r)<=1},t.prototype.getBounds=function(){return new a(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),c=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var o=[],s=0,a=i.length;s<a;s++)o.push(i[s].x,i[s].y);i=o}this.points=i,this.type=r.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,o=r-1;i<r;o=i++){var s=this.points[2*i],a=this.points[2*i+1],u=this.points[2*o],h=this.points[2*o+1];a>e!=h>e&&t<(e-a)/(h-a)*(u-s)+s&&(n=!n)}return n},t}(),l=function(){function t(t,e,n,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=o,this.type=r.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var n=t-(this.x+this.radius),r=e-(this.y+this.radius),i=this.radius*this.radius;if(n*n+r*r<=i)return!0;if((n=t-(this.x+this.width-this.radius))*n+r*r<=i)return!0;if(n*n+(r=e-(this.y+this.height-this.radius))*r<=i)return!0;if((n=t-(this.x+this.radius))*n+r*r<=i)return!0}return!1},t}(),f=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),p=function(){function t(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),this._x=n,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),d=function(){function t(t,e,n,r,i,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new f;var n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new f;var n=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,o=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,n,r,i,o,s,a,u){return this.a=Math.cos(s+u)*i,this.b=Math.sin(s+u)*i,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,r=this.c,o=this.d,s=-Math.atan2(-r,o),a=Math.atan2(n,e),u=Math.abs(s+a);return u<1e-5||Math.abs(i-u)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+o*o),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,o=t*r-e*n;return this.a=r/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-r*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),v=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],y=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],g=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],m=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],_=[],b=[],w=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];_.push(e);for(var n=0;n<16;n++)for(var r=w(v[t]*v[n]+g[t]*y[n]),i=w(y[t]*v[n]+m[t]*y[n]),o=w(v[t]*g[n]+g[t]*m[n]),s=w(y[t]*g[n]+m[t]*m[n]),a=0;a<16;a++)if(v[a]===r&&y[a]===i&&g[a]===o&&m[a]===s){e.push(a);break}}for(t=0;t<16;t++){var u=new d;u.set(v[t],y[t],g[t],m[t],0,0),b.push(u)}}();var x={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return v[t]},uY:function(t){return y[t]},vX:function(t){return g[t]},vY:function(t){return m[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return _[t][e]},sub:function(t,e){return _[t][x.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?x.S:x.N:2*Math.abs(e)<=Math.abs(t)?t>0?x.E:x.W:e>0?t>0?x.SE:x.SW:t>0?x.NE:x.NW},matrixAppendRotationInv:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=b[x.inv(e)];i.tx=n,i.ty=r,t.append(i)}},E=function(){function t(){this.worldTransform=new d,this.localTransform=new d,this.position=new p(this.onChange,this,0,0),this.scale=new p(this.onChange,this,1,1),this.pivot=new p(this.onChange,this,0,0),this.skew=new p(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return ne})),n.d(e,"b",(function(){return C})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return ae})),n.d(e,"e",(function(){return fe})),n.d(e,"f",(function(){return ve})),n.d(e,"g",(function(){return ue})),n.d(e,"h",(function(){return j})),n.d(e,"i",(function(){return Mt})),n.d(e,"j",(function(){return X})),n.d(e,"k",(function(){return J})),n.d(e,"l",(function(){return Dt})),n.d(e,"m",(function(){return Y})),n.d(e,"n",(function(){return L})),n.d(e,"o",(function(){return re})),n.d(e,"p",(function(){return Nt})),n.d(e,"q",(function(){return Rt})),n.d(e,"r",(function(){return R})),n.d(e,"s",(function(){return Ut})),n.d(e,"t",(function(){return K})),n.d(e,"u",(function(){return ie})),n.d(e,"v",(function(){return se})),n.d(e,"w",(function(){return oe})),n.d(e,"x",(function(){return A}));var r=n(4),i=n(1),o=n(0),s=n(14),a=n(8),u=n(2);
/*!
 * @pixi/core - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
r.b.PREFER_ENV=o.n.any?i.f.WEBGL:i.f.WEBGL2,r.b.STRICT_TEXTURE_CACHE=!1;var h=[];function c(t,e){if(!t)return null;var n="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(var i=h.length-1;i>=0;--i){var o=h[i];if(o.test&&o.test(t,n))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var p=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new s.a("setRealSize"),this.onUpdate=new s.a("update"),this.onError=new s.a("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),d=function(t){function e(e,n){var r=this,i=n||{},o=i.width,s=i.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(r=t.call(this,o,s)||this).data=e,r}return f(e,t),e.prototype.upload=function(t,e,n){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===i.a.UNPACK),n.width===e.width&&n.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,r.texImage2D(e.target,0,n.internalFormat,e.width,e.height,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(p),v={scaleMode:i.n.NEAREST,format:i.g.RGBA,alphaMode:i.a.NPM},y=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var s=t.call(this)||this,a=(n=n||{}).alphaMode,u=n.mipmap,h=n.anisotropicLevel,l=n.scaleMode,f=n.width,d=n.height,v=n.wrapMode,y=n.format,g=n.type,m=n.target,_=n.resolution,b=n.resourceOptions;return!e||e instanceof p||((e=c(e,b)).internal=!0),s.width=f||0,s.height=d||0,s.resolution=_||r.b.RESOLUTION,s.mipmap=void 0!==u?u:r.b.MIPMAP_TEXTURES,s.anisotropicLevel=void 0!==h?h:r.b.ANISOTROPIC_LEVEL,s.wrapMode=v||r.b.WRAP_MODE,s.scaleMode=void 0!==l?l:r.b.SCALE_MODE,s.format=y||i.g.RGBA,s.type=g||i.p.UNSIGNED_BYTE,s.target=m||i.o.TEXTURE_2D,s.alphaMode=void 0!==a?a:i.a.UNPACK,void 0!==n.premultiplyAlpha&&(s.premultiplyAlpha=n.premultiplyAlpha),s.uid=Object(o.C)(),s.touched=0,s.isPowerOfTwo=!1,s._refreshPOT(),s._glTextures={},s.dirtyId=0,s.dirtyStyleId=0,s.cacheId=null,s.valid=f>0&&d>0,s.textureCacheIds=[],s.destroyed=!1,s.resource=null,s._batchEnabled=0,s._batchLocation=0,s.parentTextureArray=null,s.setResource(e),s}return f(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(o.o)(this.realWidth)&&Object(o.o)(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete o.a[this.cacheId],delete o.e[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){void 0===i&&(i=r.b.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+Object(o.C)()),a=t._pixiId);var u=o.a[a];if(s&&i&&!u)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return u||((u=new e(t,n)).cacheId=a,e.addToCache(u,a)),u},e.fromBuffer=function(t,n,r,o){t=t||new Float32Array(n*r*4);var s=new d(t,{width:n,height:r}),a=t instanceof Float32Array?i.p.FLOAT:i.p.UNSIGNED_BYTE;return new e(s,Object.assign(v,o||{width:n,height:r,type:a}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),o.a[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),o.a[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=o.a[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete o.a[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete o.a[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(o.c),g=function(t){function e(e,n){var r=this,i=n||{},o=i.width,s=i.height;(r=t.call(this,o,s)||this).items=[],r.itemDirtyIds=[];for(var a=0;a<e;a++){var u=new y;r.items.push(u),r.itemDirtyIds.push(-2)}return r.length=e,r._load=null,r.baseTexture=null,r}return f(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof p?this.addResourceAt(t[n],n):this.addResourceAt(c(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,r=e.realHeight;return t.resize(n,r),Promise.resolve(t)})),this._load},e}(p),m=function(t){function e(e,n){var r,i,o=this,s=n||{},a=s.width,u=s.height;return Array.isArray(e)?(r=e,i=e.length):i=e,o=t.call(this,i,{width:a,height:u})||this,r&&o.initFromArray(r,n),o}return f(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=i.o.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,n){var r=this.length,i=this.itemDirtyIds,o=this.items,s=t.gl;n.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var u=o[a];i[a]<u.dirtyId&&(i[a]=u.dirtyId,u.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,a,u.resource.width,u.resource.height,1,e.format,e.type,u.resource.source))}return!0},e}(g),_=function(t){function e(e){var n=this,r=e,i=r.naturalWidth||r.videoWidth||r.width,o=r.naturalHeight||r.videoHeight||r.height;return(n=t.call(this,i,o)||this).source=e,n.noSubImage=!1,n}return f(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=Object(o.i)(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,r){var o=t.gl,s=e.realWidth,a=e.realHeight;return r=r||this.source,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===i.a.UNPACK),this.noSubImage||e.target!==o.TEXTURE_2D||n.width!==s||n.height!==a?(n.width=s,n.height=a,o.texImage2D(e.target,0,e.format,e.format,e.type,r)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(n,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(p),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(_),w=function(t){function e(n,r){var o=this,s=r||{},a=s.width,u=s.height,h=s.autoLoad,c=s.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");o=t.call(this,6,{width:a,height:u})||this;for(var l=0;l<e.SIDES;l++)o.items[l].target=i.o.TEXTURE_CUBE_MAP_POSITIVE_X+l;return o.linkBaseTexture=!1!==c,n&&o.initFromArray(n,r),!1!==h&&o.load(),o}return f(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=i.o.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=i.o.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,n,r){for(var i=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];i[o]<s.dirtyId&&(s.valid&&s.resource?(s.resource.upload(t,s,r),i[o]=s.dirtyId):i[o]<-1&&(t.gl.texImage2D(s.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(g),x=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var o=new Image;_.crossOrigin(o,e,n.crossorigin),o.src=e,e=o}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:r.b.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,void 0!==n.premultiplyAlpha&&(i.premultiplyAlpha=n.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return f(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var r=e.source;e.url=r.src;var i=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(e,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===i.a.UNPACK?"premultiply":"none"}).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process):Promise.resolve(this)},e.prototype.upload=function(e,n,r){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,r,this.bitmap),!this.preserveBitmap){var i=!0,o=n._glTextures;for(var s in o){var a=o[s];if(a!==r&&a.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(_),E=function(t){function e(e,n){var r=this;return n=n||{},(r=t.call(this,document.createElement("canvas"))||this)._width=0,r._height=0,r.svg=e,r.scale=n.scale||1,r._overrideWidth=n.width,r._overrideHeight=n.height,r._resolve=null,r._crossorigin=n.crossorigin,r._load=null,!1!==n.autoLoad&&r.load(),r}return f(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;_.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,r=e.height;if(!n||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=n*t.scale,s=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(i=t._overrideWidth||t._overrideHeight/r*n,s=t._overrideHeight||t._overrideWidth/n*r),i=Math.round(i),s=Math.round(s);var a=t.source;a.width=i,a.height=s,a._pixiId="canvas_"+Object(o.C)(),a.getContext("2d").drawImage(e,0,0,n,r,0,0,i,s),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(_),T=function(t){function e(n,r){var i=this;if(r=r||{},!(n instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var s=n[0].src||n[0];_.crossOrigin(o,s,r.crossorigin);for(var a=0;a<n.length;++a){var u=document.createElement("source"),h=n[a],c=h.src,l=h.mime,f=(c=c||n[a]).split("?").shift().toLowerCase(),p=f.substr(f.lastIndexOf(".")+1);l=l||e.MIME_TYPES[p]||"video/"+p,u.src=c,u.type=l,o.appendChild(u)}n=o}return(i=t.call(this,n)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=r.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==r.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),!1!==r.autoLoad&&i.load(),i}return f(e,t),e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var n=a.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(a.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(a.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&a.a.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(a.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(a.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(_),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(_);h.push(x,I,b,T,E,d,w,m);var A={Resource:p,BaseImageResource:_,INSTALLED:h,autoDetectResource:c,AbstractMultiResource:g,ArrayResource:m,BufferResource:d,CanvasResource:b,CubeResource:w,ImageResource:x,SVGResource:E,VideoResource:T,ImageBitmapResource:I},S=function(){function t(t){this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.upload=function(t,e,n){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===i.a.UNPACK),n.width===e.width&&n.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(n.width=e.width,n.height=e.height,r.texImage2D(e.target,0,1===t.context.webGLVersion?r.DEPTH_COMPONENT:r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(d),P=function(){function t(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new s.a("disposeFramebuffer"),this.multisample=i.k.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new y(null,{scaleMode:i.n.NEAREST,resolution:1,mipmap:i.j.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new y(new O(null,{width:this.width,height:this.height}),{scaleMode:i.n.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:i.j.OFF,format:i.g.DEPTH_COMPONENT,type:i.p.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),C=function(t){function e(e){var n=this;if("number"==typeof e){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3];e={width:r,height:i,scaleMode:o,resolution:s}}n=t.call(this,null,e)||this;var a=e||{},u=a.width,h=a.height;return n.mipmap=0,n.width=Math.ceil(u)||100,n.height=Math.ceil(h)||100,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new P(n.width*n.resolution,n.height*n.resolution).addColorTexture(0,n),n.maskStack=[],n.filterStack=[{}],n}return f(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(y),D=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var r=e.width,i=e.height;if(n){var o=t.width/2/r,s=t.height/2/i,a=t.x/r+o,h=t.y/i+s;n=u.n.add(n,u.n.NW),this.x0=a+o*u.n.uX(n),this.y0=h+s*u.n.uY(n),n=u.n.add(n,2),this.x1=a+o*u.n.uX(n),this.y1=h+s*u.n.uY(n),n=u.n.add(n,2),this.x2=a+o*u.n.uX(n),this.y2=h+s*u.n.uY(n),n=u.n.add(n,2),this.x3=a+o*u.n.uX(n),this.y3=h+s*u.n.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t}(),N=new D,R=function(t){function e(n,r,i,o,s,a){var h=t.call(this)||this;if(h.noFrame=!1,r||(h.noFrame=!0,r=new u.j(0,0,1,1)),n instanceof e&&(n=n.baseTexture),h.baseTexture=n,h._frame=r,h.trim=o,h.valid=!1,h._uvs=N,h.uvMatrix=null,h.orig=i||r,h._rotate=Number(s||0),!0===s)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new u.g(a.x,a.y):new u.g(0,0),h._updateID=0,h.textureCacheIds=[],n.valid?h.noFrame?n.valid&&h.onBaseTextureUpdated(n):h.frame=r:n.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&n.on("update",h.onBaseTextureUpdated,h),h}return f(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture;n&&n.url&&o.e[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===N&&(this._uvs=new D),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=r.b.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+Object(o.C)()),a=t._pixiId);var u=o.e[a];if(s&&i&&!u)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return u||(n.resolution||(n.resolution=Object(o.k)(t)),(u=new e(new y(t,n))).baseTexture.cacheId=a,y.addToCache(u.baseTexture,a),e.addToCache(u,a)),u},e.fromURL=function(t,n){var r=Object.assign({autoLoad:!1},null==n?void 0:n.resourceOptions),i=e.from(t,Object.assign({resourceOptions:r},n),!1),o=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):o.load().then((function(){return Promise.resolve(i)}))},e.fromBuffer=function(t,n,r,i){return new e(y.fromBuffer(t,n,r,i))},e.fromLoader=function(t,n,i){var s=new x(t);s.url=n;var a=new e(new y(s,{scaleMode:r.b.SCALE_MODE,resolution:Object(o.k)(n)}));return i||(i=n),y.addToCache(a.baseTexture,i),e.addToCache(a,i),i!==n&&(y.addToCache(a.baseTexture,n),e.addToCache(a,n)),a},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),o.e[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),o.e[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=o.e[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete o.e[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)o.e[t.textureCacheIds[r]]===t&&delete o.e[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,r=t.width,i=t.height,o=e+r>this.baseTexture.width,s=n+i>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",u="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,h="Y: "+n+" + "+i+" = "+(n+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+a+" "+h)}this.valid=r&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(o.c);function M(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}R.EMPTY=new R(new y),M(R.EMPTY),M(R.EMPTY.baseTexture),R.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new R(new y(new b(t)))}(),M(R.WHITE),M(R.WHITE.baseTexture);var L=function(t){function e(e,n){var r=this,i=null;if(!(e instanceof C)){var o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+s+") instead of the ctor directly."),i=arguments[0],n=null,e=new C({width:o,height:s,scaleMode:a,resolution:u})}return(r=t.call(this,e,n)||this).legacyRenderer=i,r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return f(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,n&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new C(t))},e}(R),U=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e){var n=new C(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new L(n)},t.prototype.getOptimalTexture=function(e,n,r){void 0===r&&(r=1);var i=t.SCREEN_KEY;e*=r,n*=r,this.enableFullScreen&&e===this._pixelsWidth&&n===this._pixelsHeight||(i=(65535&(e=Object(o.r)(e)))<<16|65535&(n=Object(o.r)(n))),this.texturePool[i]||(this.texturePool[i]=[]);var s=this.texturePool[i].pop();return s||(s=this.createTexture(e,n)),s.filterPoolKey=i,s.setResolution(r),s},t.prototype.getFilterTexture=function(t,e){var n=this.getOptimalTexture(t.width,t.height,e||t.resolution);return n.filterFrame=t.filterFrame,n},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var n=t.SCREEN_KEY,r=this.texturePool[n];if(this.enableFullScreen=e.width>0&&e.height>0,r)for(var i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[n]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},t.SCREEN_KEY="screen",t}(),k=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=i,this.start=o,this.instance=s}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,n,r,i,o){return new t(e,n,r,i,o)},t}(),F=0,j=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=F++,this.disposeRunner=new s.a("disposeBuffer")}return t.prototype.update=function(t){this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}();function B(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var V={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var G={5126:4,5123:2,5121:1},z=0,H={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},X=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=z++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new s.a("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,n,r,i,o,s,a){if(void 0===n&&(n=0),void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof j||(e instanceof Array&&(e=new Float32Array(e)),e=new j(e));var u=t.split("|");if(u.length>1){for(var h=0;h<u.length;h++)this.addAttribute(u[h],e,n,r,i);return this}var c=this.buffers.indexOf(e);return-1===c&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new k(c,n,r,i,o,s,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof j||(t instanceof Array&&(t=new Uint16Array(t)),t=new j(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],r=new j;for(t in this.attributes){var i=this.attributes[t],o=this.buffers[i.buffer];e.push(o.data),n.push(i.size*G[i.type]/4),i.buffer=0}for(r.data=function(t,e){for(var n=0,r=0,i={},o=0;o<t.length;o++)r+=e[o],n+=t[o].length;var s=new ArrayBuffer(4*n),a=null,u=0;for(o=0;o<t.length;o++){var h=e[o],c=t[o],l=B(c);i[l]||(i[l]=new V[l](s)),a=i[l];for(var f=0;f<c.length;f++){a[(f/h|0)*r+u+f%h]=c[f]}u+=h}return new Float32Array(s)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new j(this.buffers[n].data.slice(0));for(var n in this.attributes){var r=this.attributes[n];e.attributes[n]=new k(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},t.merge=function(e){for(var n,r=new t,i=[],o=[],s=[],a=0;a<e.length;a++){n=e[a];for(var u=0;u<n.buffers.length;u++)o[u]=o[u]||0,o[u]+=n.buffers[u].data.length,s[u]=0}for(a=0;a<n.buffers.length;a++)i[a]=new(H[B(n.buffers[a].data)])(o[a]),r.buffers[a]=new j(i[a]);for(a=0;a<e.length;a++){n=e[a];for(u=0;u<n.buffers.length;u++)i[u].set(n.buffers[u].data,s[u]),s[u]+=n.buffers[u].data.length}if(r.attributes=n.attributes,n.indexBuffer){r.indexBuffer=r.buffers[n.buffers.indexOf(n.indexBuffer)],r.indexBuffer.index=!0;var h=0,c=0,l=0,f=0;for(a=0;a<n.buffers.length;a++)if(n.buffers[a]!==n.indexBuffer){f=a;break}for(var a in n.attributes){var p=n.attributes[a];(0|p.buffer)===f&&(c+=p.size*G[p.type]/4)}for(a=0;a<e.length;a++){var d=e[a].indexBuffer.data;for(u=0;u<d.length;u++)r.indexBuffer.data[u+l]+=h;h+=n.buffers[f].data.length/c,l+=d.length}}return r},t}(),q=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return f(e,t),e}(X),Y=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new j(e.vertices),e.uvBuffer=new j(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return f(e,t),e.prototype.map=function(t,e){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(X),W=0,K=function(){function t(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=W++,this.static=!!e}return t.prototype.update=function(){this.dirtyId++},t.prototype.add=function(e,n,r){this.uniforms[e]=new t(n,r)},t.from=function(e,n){return new t(e,n)},t}(),Q=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new u.j,this.destinationFrame=new u.j,this.filters=[]}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),Z=function(t){function e(e){var n=t.call(this,e)||this;return n.defaultFilterStack=[{}],n.texturePool=new U,n.texturePool.setScreenSize(e.view),n.statePool=[],n.quad=new q,n.quadUv=new Y,n.tempRect=new u.j,n.activeState={},n.globalUniforms=new K({outputFrame:n.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),n.forceClear=!1,n.useMaxPadding=!1,n}return f(e,t),e.prototype.push=function(t,e){for(var n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new Q,o=e[0].resolution,s=e[0].padding,a=e[0].autoFit,u=e[0].legacy,h=1;h<e.length;h++){var c=e[h];o=Math.min(o,c.resolution),s=this.useMaxPadding?Math.max(s,c.padding):s+c.padding,a=a||c.autoFit,u=u||c.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),r.push(i),i.resolution=o,i.legacy=u,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(s),a&&i.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),i.sourceFrame.ceil(o),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,o),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var l=this.tempRect;l.width=i.sourceFrame.width,l.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,n.renderTexture.bind(i.renderTexture,i.sourceFrame,l),n.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var o=r.inputSize,s=r.inputPixel,a=r.inputClamp;if(o[0]=e.destinationFrame.width,o[1]=e.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],s[0]=o[0]*e.resolution,s[1]=o[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],a[0]=.5*s[2],a[1]=.5*s[3],a[2]=e.sourceFrame.width*o[2]-.5*s[2],a[3]=e.sourceFrame.height*o[3]-.5*s[3],e.legacy){var u=r.filterArea;u[0]=e.destinationFrame.width,u[1]=e.destinationFrame.height,u[2]=e.sourceFrame.x,u[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(e.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,h.renderTexture,i.d.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var c=e.renderTexture,l=this.getOptimalFilterTexture(c.width,c.height,e.resolution);l.filterFrame=c.filterFrame;var f=0;for(f=0;f<n.length-1;++f){n[f].apply(this,c,l,i.d.CLEAR,e);var p=c;c=l,l=p}n[f].apply(this,c,h.renderTexture,i.d.BLEND,e),this.returnFilterTexture(c),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.bindAndClear=function(t,e){if(void 0===e&&(e=i.d.CLEAR),t&&t.filterFrame){var n=this.tempRect;n.width=t.filterFrame.width,n.height=t.filterFrame.height,this.renderer.renderTexture.bind(t,t.filterFrame,n)}else this.renderer.renderTexture.bind(t);"boolean"==typeof e&&(e=e?i.d.CLEAR:i.d.BLEND,Object(o.h)("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(e===i.d.CLEAR||e===i.d.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},e.prototype.applyFilter=function(t,e,n,r){var o=this.renderer;this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,o.state.set(t.state),o.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(i.e.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(i.e.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,o=e._texture.orig,s=t.set(i.width,0,0,i.height,r.x,r.y),a=e.worldTransform.copyTo(u.d.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,n){return void 0===n&&(n=1),this.texturePool.getOptimalTexture(t,e,n)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var n=t;t=e,e=n}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(S),J=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),$=function(t){function e(e){var n=t.call(this,e)||this;return n.emptyRenderer=new J(e),n.currentRenderer=n.emptyRenderer,n}return f(e,t),e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)},e.prototype.boundArray=function(t,e,n,r){for(var i=t.elements,o=t.ids,s=t.count,a=0,u=0;u<s;u++){var h=i[u],c=h._batchLocation;if(c>=0&&c<r&&e[c]===h)o[u]=c;else for(;a<r;){var l=e[a];if(!l||l._batchEnabled!==n||l._batchLocation!==a){o[u]=a,h._batchLocation=a,e[a]=h;break}a++}}},e}(S),tt=0,et=function(t){function e(e){var n=t.call(this,e)||this;return n.webGLVersion=1,n.extensions={},n.supports={uint32Indices:!1},n.handleContextLost=n.handleContextLost.bind(n),n.handleContextRestored=n.handleContextRestored.bind(n),e.view.addEventListener("webglcontextlost",n.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",n.handleContextRestored,!1),n}return f(e,t),Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=tt++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var n;if(r.b.PREFER_ENV>=i.f.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var e="WebGL2RenderingContext"in window&&t instanceof window.WebGL2RenderingContext||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=e,e||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e}(S),nt=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=i.k.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},rt=new u.j,it=function(t){function e(e){var n=t.call(this,e)||this;return n.managedFramebuffers=[],n.unknownFramebuffer=new P(10,10),n.msaaSamples=null,n}return f(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new u.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;r.b.PREFER_ENV===i.f.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},e.prototype.bind=function(t,e){var n=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var i=0;i<t.colorTextures.length;i++){var o=t.colorTextures[i];this.renderer.texture.unbind(o.parentTextureArray||o)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,n,r){var i=this.viewport;i.width===n&&i.height===r&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(t,e,n,r,o){void 0===o&&(o=i.c.COLOR|i.c.DEPTH);var s=this.gl;s.clearColor(t,e,n,r),s.clear(o)},e.prototype.initFramebuffer=function(t){var e=this.gl,n=new nt(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},e.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,i=0;i<r.length;i++)this.renderer.texture.bind(r[i],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1)),n.multisample>1&&(n.msaaBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,n.msaaBuffer));for(var i=[],o=0;o<r;o++)if(!(0===o&&n.multisample>1)){var s=t.colorTextures[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o,s.target,a._glTextures[this.CONTEXT_UID].texture,0),i.push(e.COLOR_ATTACHMENT0+o)}if((i.length>1&&e.drawBuffers(i),t.depthTexture)&&this.writeDepthTexture){var u=t.depthTexture;this.renderer.texture.bind(u,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,0)}n.stencil||!t.stencil&&!t.depth||(n.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,n.stencil))},e.prototype.detectSamples=function(t){var e=this.msaaSamples,n=i.k.NONE;if(t<=1||null===e)return n;for(var r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return 1===n&&(n=i.k.NONE),n},e.prototype.blit=function(t,e,n){var r=this.current,i=this.renderer,o=this.gl,s=this.CONTEXT_UID;if(2===i.context.webGLVersion&&r){var a=r.glFramebuffers[s];if(a){if(!t){if(a.multisample<=1)return;a.blitFramebuffer||(a.blitFramebuffer=new P(r.width,r.height),a.blitFramebuffer.addColorTexture(0,r.colorTextures[0])),(t=a.blitFramebuffer).width=r.width,t.height=r.height}e||((e=rt).width=r.width,e.height=r.height),n||(n=e);var u=e.width===n.width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,a.framebuffer),o.blitFramebuffer(e.x,e.y,e.width,e.height,n.x,n.y,n.width,n.height,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.stencil&&r.deleteRenderbuffer(n.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var n=t.width,r=t.height,i=this.gl,o=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,o),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,r),e.stencil=o,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,o)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new u.j},e}(S),ot=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},st={5126:4,5123:2,5121:1},at=function(t){function e(e){var n=t.call(this,e)||this;return n._activeGeometry=null,n._activeVao=null,n.hasVao=!0,n.hasInstance=!0,n.canUseUInt32ElementIndex=!1,n.managedGeometries={},n.managedBuffers={},n}return f(e,t),e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var n=this.renderer.context.extensions.vertexArrayObject;r.b.PREFER_ENV===i.f.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(!t.vertexAttribDivisor){var o=t.getExtension("ANGLE_instanced_arrays");o?(t.vertexAttribDivisor=function(t,e){return o.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,i){return o.drawElementsInstancedANGLE(t,e,n,r,i)},t.drawArraysInstanced=function(t,e,n,r){return o.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var i=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==i&&(this._activeVao=i,this.hasVao?n.bindVertexArray(i):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,n=0;n<t.buffers.length;n++){var r=t.buffers[n],i=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==i.updateID){i.updateID=r._updateID;var o=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(o,i.buffer),this._boundBuffer=i,i.byteLength>=r.data.byteLength)e.bufferSubData(o,0,r.data);else{var s=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=r.data.byteLength,e.bufferData(o,r.data,s)}}}},e.prototype.checkCompatibility=function(t,e){var n=t.attributes,r=e.attributeData;for(var i in r)if(!n[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},e.prototype.getSignature=function(t,e){var n=t.attributes,r=e.attributeData,i=["g",t.id];for(var o in n)r[o]&&i.push(o);return i.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var n=this.gl,r=this.CONTEXT_UID,i=this.getSignature(t,e),o=t.glVertexArrayObjects[this.CONTEXT_UID],s=o[i];if(s)return o[e.id]=s,s;var a=t.buffers,u=t.attributes,h={},c={};for(var l in a)h[l]=0,c[l]=0;for(var l in u)!u[l].size&&e.attributeData[l]?u[l].size=e.attributeData[l].size:u[l].size||console.warn("PIXI Geometry attribute '"+l+"' size cannot be determined (likely the bound shader does not have the attribute)"),h[u[l].buffer]+=u[l].size*st[u[l].type];for(var l in u){var f=u[l],p=f.size;void 0===f.stride&&(h[f.buffer]===p*st[f.type]?f.stride=0:f.stride=h[f.buffer]),void 0===f.start&&(f.start=c[f.buffer],c[f.buffer]+=p*st[f.type])}s=n.createVertexArray(),n.bindVertexArray(s);for(var d=0;d<a.length;d++){var v=a[d];v._glBuffers[r]||(v._glBuffers[r]=new ot(n.createBuffer()),this.managedBuffers[v.id]=v,v.disposeRunner.add(this)),v._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=s,o[e.id]=s,o[i]=s,s},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=t.buffers;if(t.disposeRunner.remove(this),n){for(var o=0;o<i.length;o++){var s=i[o]._glBuffers[this.CONTEXT_UID];s.refCount--,0!==s.refCount||e||this.disposeBuffer(i[o],e)}if(!e)for(var a in n)if("g"===a[0]){var u=n[a];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t);e=Object.keys(this.managedBuffers);for(n=0;n<e.length;n++)this.disposeBuffer(this.managedBuffers[e[n]],t)},e.prototype.activateVao=function(t,e){var n=this.gl,r=this.CONTEXT_UID,i=t.buffers,o=t.attributes;t.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var s=null;for(var a in o){var u=o[a],h=i[u.buffer]._glBuffers[r];if(e.attributeData[a]){s!==h&&(n.bindBuffer(n.ARRAY_BUFFER,h.buffer),s=h);var c=e.attributeData[a].location;if(n.enableVertexAttribArray(c),n.vertexAttribPointer(c,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(c,1)}}}},e.prototype.draw=function(t,e,n,r){var i=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(n||0)*s,r||1):i.drawElements(t,e||o.indexBuffer.data.length,a,(n||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(t,n,e||o.getSize(),r||1):i.drawArrays(t,n,e||o.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(S),ut=function(){function t(t){void 0===t&&(t=null),this.type=i.i.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=i.i.NONE,this.autoDetect=!0),this._target=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function ht(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function ct(t,e,n,r){var i=ht(t,t.VERTEX_SHADER,e),o=ht(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(t.attachShader(s,i),t.attachShader(s,o),r)for(var a in r)t.bindAttribLocation(s,r[a],a);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(t.getShaderParameter(i,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(i))),t.getShaderParameter(o,t.COMPILE_STATUS)||(console.warn(n),console.error(t.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(i),t.deleteShader(o),s}function lt(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function ft(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return lt(2*e);case"bvec3":return lt(3*e);case"bvec4":return lt(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var pt,dt={},vt=dt;function yt(){if(vt===dt||vt&&vt.isContextLost()){var t=document.createElement("canvas"),e=void 0;r.b.PREFER_ENV>=i.f.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),vt=e}return vt}function gt(t,e,n){if("precision"!==t.substring(0,9)){var r=e;return e===i.l.HIGH&&n!==i.l.HIGH&&(r=i.l.MEDIUM),"precision "+r+" float;\n"+t}return n!==i.l.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var mt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function _t(t){return mt[t]}var bt=null,wt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function xt(t,e){if(!bt){var n=Object.keys(wt);bt={};for(var r=0;r<n.length;++r){var i=n[r];bt[t[i]]=wt[i]}}return bt[e]}var Et=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Tt={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},It={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var At,St=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ot(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}var Pt=0,Ct={},Dt=function(){function t(e,n,o){void 0===o&&(o="pixi-shader"),this.id=Pt++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(o=o.replace(/\s+/g,"-"),Ct[o]?(Ct[o]++,o+="-"+Ct[o]):Ct[o]=1,this.vertexSrc="#define SHADER_NAME "+o+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+o+"\n"+this.fragmentSrc,this.vertexSrc=gt(this.vertexSrc,r.b.PRECISION_VERTEX,i.l.HIGH),this.fragmentSrc=gt(this.fragmentSrc,r.b.PRECISION_FRAGMENT,function(){if(!pt){pt=i.l.MEDIUM;var t=yt();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);pt=e.precision?i.l.HIGH:i.l.MEDIUM}}return pt}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return t.prototype.extractData=function(t,e){var n=yt();if(n){var r=ct(n,t,e);this.attributeData=this.getAttributeData(r,n),this.uniformData=this.getUniformData(r,n),n.deleteProgram(r)}else this.uniformData={},this.attributeData={}},t.prototype.getAttributeData=function(t,e){for(var n={},r=[],i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<i;o++){var s=e.getActiveAttrib(t,o),a=xt(e,s.type),u={type:a,name:s.name,size:_t(a),location:0};n[s.name]=u,r.push(u)}r.sort((function(t,e){return t.name>e.name?1:-1}));for(o=0;o<r.length;o++)r[o].location=o;return n},t.prototype.getUniformData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;i++){var o=e.getActiveUniform(t,i),s=o.name.replace(/\[.*?\]$/,""),a=o.name.match(/\[.*?\]$/),u=xt(e,o.type);n[s]={type:u,size:o.size,isArray:a,value:ft(u,o.size)}}return n},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,n,r){var i=e+n,s=o.d[i];return s||(o.d[i]=s=new t(e,n,r)),s},t}(),Nt=function(){function t(t,e){for(var n in this.program=t,this.uniformGroup=e?e instanceof K?e:new K(e):new K({}),t.uniformData)this.uniformGroup.uniforms[n]instanceof Array&&(this.uniformGroup.uniforms[n]=new Float32Array(this.uniformGroup.uniforms[n]))}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var r=e.uniforms[n];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,r){return new t(Dt.from(e,n),r)},t}(),Rt=function(){function t(){this.data=0,this.blendMode=i.b.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==i.b.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Mt=function(t){function e(n,i,o){var s=this,a=Dt.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(s=t.call(this,a,o)||this).padding=0,s.resolution=r.b.FILTER_RESOLUTION,s.enabled=!0,s.autoFit=!0,s.legacy=!!s.program.attributeData.aTextureCoord,s.state=new Rt,s}return f(e,t),e.prototype.apply=function(t,e,n,r,i){t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Nt),Lt=new u.d,Ut=function(){function t(t,e){this._texture=t,this.mapCoord=new u.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,r=0;r<t.length;r+=2){var i=t[r],o=t[r+1];e[r]=i*n.a+o*n.c+n.tx,e[r+1]=i*n.b+o*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=e.orig,i=e.trim;i&&(Lt.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Lt));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,u=this.clampOffset;return s[0]=(e._frame.x+a+u)/o.width,s[1]=(e._frame.y+a+u)/o.height,s[2]=(e._frame.x+e._frame.width-a+u)/o.width,s[3]=(e._frame.y+e._frame.height-a+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),kt=function(t){function e(e){var n=this,r=new u.d;return n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,e.renderable=!1,n.maskSprite=e,n.maskMatrix=r,n}return f(e,t),e.prototype.apply=function(t,e,n,r){var i=this.maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Ut(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))},e}(Mt),Ft=function(t){function e(e){var n=t.call(this,e)||this;return n.enableScissor=!1,n.alphaMaskPool=[],n.maskDataPool=[],n.maskStack=[],n.alphaMaskIndex=0,n}return f(e,t),e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var r=this.maskDataPool.pop()||new ut;r.pooled=!0,r.maskObject=e,n=r}switch(n.autoDetect&&this.detect(n),n.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),n._target=t,n.type){case i.i.SCISSOR:this.maskStack.push(n),this.renderer.scissor.push(n);break;case i.i.STENCIL:this.maskStack.push(n),this.renderer.stencil.push(n);break;case i.i.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n),this.maskStack.push(n)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case i.i.SCISSOR:this.renderer.scissor.pop();break;case i.i.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case i.i.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=i.i.SPRITE;else if(t.type=i.i.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var n=e.worldTransform,r=Math.atan2(n.b,n.a),o=Math.atan2(n.d,n.c);r=Math.round(r*(180/Math.PI)*100),o=((o=Math.round(o*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===o&&(t.type=i.i.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,n=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new kt(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var i=n.filterArea;n.filterArea=e.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(S),jt=function(t){function e(e){var n=t.call(this,e)||this;return n.maskStack=[],n.glConst=0,n}return f(e,t),e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.maskStack=null},e}(S),Bt=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n}return f(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var n=t._scissorRect,r=e.getBounds(!0),i=this.renderer.gl;e.renderable=!1,n?r.fit(n):i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,n=this.renderer.projection,r=n.transform,i=n.sourceFrame,o=n.destinationFrame,s=e?e.resolution:this.renderer.resolution,a=(t.x-i.x)*s+o.x,u=(t.y-i.y)*s+o.y,h=t.width*s,c=t.height*s;r&&(a+=r.tx*s,u+=r.ty*s),e||(u=this.renderer.height-c-u),this.renderer.gl.scissor(a,u,h,c)},e}(jt),Vt=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n}return f(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,r,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(jt),Gt=function(t){function e(e){var n=t.call(this,e)||this;return n.destinationFrame=null,n.sourceFrame=null,n.defaultFrame=null,n.projectionMatrix=new u.d,n.transform=null,n}return f(e,t),e.prototype.update=function(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,n,r){var i=this.projectionMatrix,o=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=o*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-o-e.y*i.d},e.prototype.setTransform=function(t){},e}(S),zt=new u.j,Ht=new u.j,Xt=new u.j,qt=function(t){function e(e){var n=t.call(this,e)||this;return n.clearColor=e._backgroundColorRgba,n.defaultMaskStack=[],n.current=null,n.sourceFrame=new u.j,n.destinationFrame=new u.j,n}return f(e,t),e.prototype.bind=function(t,e,n){void 0===t&&(t=null);var r,i,o,s=this.renderer;this.current=t,t?(o=(r=t.baseTexture).resolution,e||(zt.width=t.frame.width,zt.height=t.frame.height,e=zt),n||(Ht.x=t.frame.x,Ht.y=t.frame.y,Ht.width=e.width,Ht.height=e.height,n=Ht),i=r.framebuffer):(o=s.resolution,e||(zt.width=s.screen.width,zt.height=s.screen.height,e=zt),n||((n=zt).width=e.width,n.height=e.height)),Xt.x=n.x*o,Xt.y=n.y*o,Xt.width=n.width*o,Xt.height=n.height*o,this.renderer.framebuffer.bind(i,Xt),this.renderer.projection.update(n,e,o,!i),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},e.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e)},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(S),Yt=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},t}(),Wt=0,Kt={textureCount:0},Qt=function(t){function e(e){var n=t.call(this,e)||this;return n.destroyed=!1,n.systemCheck(),n.gl=null,n.shader=null,n.program=null,n.cache={},n.id=Wt++,n}return f(e,t),e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof At)return At;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");At=!0===t({a:"b"},"a","b")}catch(t){At=!1}return At}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(Kt.textureCount=0,this.syncUniformGroup(t.uniformGroup,Kt)),r},e.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var n=this.getglProgram();t.static&&t.dirtyId===n.uniformGroups[t.id]||(n.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},e.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var n=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var r in t.uniforms){var i=e[r];if(i){for(var o=t.uniforms[r],s=!1,a=0;a<Et.length;a++)if(Et[a].test(i,o)){n.push(Et[a].code(r,o)),s=!0;break}if(!s){var u=(1===i.size?Tt:It)[i.type].replace("location",'ud["'+r+'"].location');n.push('\n            cv = ud["'+r+'"].value;\n            v = uv["'+r+'"];\n            '+u+";")}}else t.uniforms[r].group&&n.push('\n                    renderer.shader.syncUniformGroup(uv["'+r+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var n=t.uniforms,r=[];for(var i in n)r.push(i),e[i]&&r.push(e[i].type);return r.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,n=t.program,r={};for(var i in n.attributeData)r[i]=n.attributeData[i].location;var o=ct(e,n.vertexSrc,n.fragmentSrc,r),s={};for(var i in n.uniformData){var a=n.uniformData[i];s[i]={location:e.getUniformLocation(o,i),value:ft(a.type,a.size)}}var u=new Yt(o,s);return n.glPrograms[this.renderer.CONTEXT_UID]=u,u},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(S);var Zt=function(t){function e(e){var n=t.call(this,e)||this;return n.gl=null,n.stateId=0,n.polygonOffset=0,n.blendMode=i.b.NONE,n._blendEq=!1,n.map=[],n.map[0]=n.setBlend,n.map[1]=n.setOffset,n.map[2]=n.setCullFace,n.map[3]=n.setDepthTest,n.map[4]=n.setFrontFace,n.checks=[],n.defaultState=new Rt,n.defaultState.blend=!0,n}return f(e,t),e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[i.b.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.ADD]=[t.ONE,t.ONE],e[i.b.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.NONE]=[0,0],e[i.b.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[i.b.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.b.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[i.b.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[i.b.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[i.b.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[i.b.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[i.b.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[i.b.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[i.b.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[i.b.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},e}(S),Jt=function(t){function e(e){var n=t.call(this,e)||this;return n.count=0,n.checkCount=0,n.maxIdle=r.b.GC_MAX_IDLE,n.checkCountMax=r.b.GC_MAX_CHECK_COUNT,n.mode=r.b.GC_MODE,n}return f(e,t),e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==i.h.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,r=0;r<e.length;r++){var i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){var o=0;for(r=0;r<e.length;r++)null!==e[r]&&(e[o++]=e[r]);e.length=o}},e.prototype.unload=function(t){var e,n=this.renderer.texture;(null===(e=t._texture)||void 0===e?void 0:e.framebuffer)&&n.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(S),$t=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},te=function(t){function e(e){var n=t.call(this,e)||this;return n.boundTextures=[],n.currentLocation=-1,n.managedTextures=[],n._unknownBoundTextures=!1,n.unknownTexture=new y,n}return f(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var r=new $t(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new $t(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(n=0;n<this.boundTextures.length;n++)this.bind(null,n)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if(t){if((t=t.castToBaseTexture()).parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),n[r]=null)},e.prototype.initTexture=function(t){var e=new $t(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var n=this.renderer.gl;t.type===n.FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA32F),t.type===i.p.HALF_FLOAT&&(e.type=n.HALF_FLOAT),e.type===n.HALF_FLOAT&&t.format===n.RGBA&&(e.internalFormat=n.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e));else{var r=t.realWidth,i=t.realHeight,o=n.gl;(e.width!==r||e.height!==i||e.dirtyId<0)&&(e.width=r,e.height=i,o.texImage2D(t.target,0,e.internalFormat,r,i,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Object(o.w)(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==i.j.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=i.q.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===i.n.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===i.n.LINEAR){var o=Math.min(t.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===i.n.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===i.n.LINEAR?n.LINEAR:n.NEAREST)},e}(S),ee=new u.d,ne=function(t){function e(e,n){void 0===e&&(e=i.m.UNKNOWN);var s=t.call(this)||this;return(n=Object.assign({},r.b.RENDER_OPTIONS,n)).roundPixels&&(r.b.ROUND_PIXELS=n.roundPixels,Object(o.h)("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),s.options=n,s.type=e,s.screen=new u.j(0,0,n.width,n.height),s.view=n.view||document.createElement("canvas"),s.resolution=n.resolution||r.b.RESOLUTION,s.transparent=n.transparent,s.autoDensity=n.autoDensity||n.autoResize||!1,s.preserveDrawingBuffer=n.preserveDrawingBuffer,s.clearBeforeRender=n.clearBeforeRender,s._backgroundColor=0,s._backgroundColorRgba=[0,0,0,0],s._backgroundColorString="#000000",s.backgroundColor=n.backgroundColor||s._backgroundColor,s._lastObjectRendered=null,s.plugins={},s}return f(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px"),this.emit("resize",t,e)},e.prototype.generateTexture=function(t,e,n,r){0===(r=r||t.getLocalBounds(null,!0)).width&&(r.width=1),0===r.height&&(r.height=1);var i=L.create({width:0|r.width,height:0|r.height,scaleMode:e,resolution:n});return ee.tx=-r.x,ee.ty=-r.y,this.render(t,i,!1,ee,!!t.parent),i},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=i.m.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Object(o.m)(t),Object(o.l)(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),e}(o.c),re=function(t){function e(n){var r=t.call(this,i.m.WEBGL,n)||this;return n=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new s.a("destroy"),contextChange:new s.a("contextChange"),reset:new s.a("reset"),update:new s.a("update"),postrender:new s.a("postrender"),prerender:new s.a("prerender"),resize:new s.a("resize")},r.globalUniforms=new K({projectionMatrix:new u.d},!0),r.addSystem(Ft,"mask").addSystem(et,"context").addSystem(Zt,"state").addSystem(Qt,"shader").addSystem(te,"texture").addSystem(at,"geometry").addSystem(it,"framebuffer").addSystem(Bt,"scissor").addSystem(Vt,"stencil").addSystem(Gt,"projection").addSystem(Jt,"textureGC").addSystem(Z,"filter").addSystem(qt,"renderTexture").addSystem($,"batch"),r.initPlugins(e.__plugins),n.context?r.context.initFromContext(n.context):r.context.initFromOptions({alpha:!!r.transparent,antialias:n.antialias,premultipliedAlpha:r.transparent&&"notMultiplied"!==r.transparent,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,Object(o.y)(2===r.context.webGLVersion?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return f(e,t),e.create=function(t){if(Object(o.p)())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=n,this.runners)this.runners[r].add(n);return this},e.prototype.render=function(t,e,n,r,i){if(this.renderingToScreen=!e,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!i){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(e,n)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(ne);function ie(t){return re.create(t)}var oe="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",se="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ae=function(){this.texArray=null,this.blend=0,this.type=i.e.TRIANGLES,this.start=0,this.size=0,this.data=null},ue=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),he=function(){function t(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),ce=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Rt.for2d(),n.size=4*r.b.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return f(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;r.b.PREFER_ENV===i.f.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var r=St.replace(/%forloop%/gi,Ot(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new ae);for(;n.length<i;)n.push(new ue);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,r=e._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++y._globalBatch,u=0,h=r[0],c=0;i.copyBoundTextures(o,n);for(var l=0;l<this._bufferSize;++l){var f=t[l];t[l]=null,f._batchEnabled!==a&&(h.count>=n&&(i.boundArray(h,o,a,n),this.buildDrawCalls(h,c,l),c=l,h=r[++u],++a),f._batchEnabled=a,f.touched=s,h.elements[h.count++]=f)}h.count>0&&(i.boundArray(h,o,a,n),this.buildDrawCalls(h,c,this._bufferSize),++u,++a);for(l=0;l<o.length;l++)o[l]=null;y._globalBatch=a},e.prototype.buildDrawCalls=function(t,n,r){var i=this._bufferedElements,s=this._attributeBuffer,a=this._indexBuffer,u=this.vertexSize,h=e._drawCallPool,c=this._dcIndex,l=this._aIndex,f=this._iIndex,p=h[c];p.start=this._iIndex,p.texArray=t;for(var d=n;d<r;++d){var v=i[d],y=v._texture.baseTexture,g=o.s[y.alphaMode?1:0][v.blendMode];i[d]=null,n<d&&p.blend!==g&&(p.size=f-p.start,n=d,(p=h[++c]).texArray=t,p.start=f),this.packInterleavedGeometry(v,s,a,l,f),l+=v.vertexData.length/2*u,f+=v.indices.length,p.blend=g}n<r&&(p.size=f-p.start,++c),this._dcIndex=c,this._aIndex=l,this._iIndex=f},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,n=this._indexBuffer;r.b.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,r=n.gl,i=n.state,o=e._drawCallPool,s=null,a=0;a<t;a++){var u=o[a],h=u.texArray,c=u.type,l=u.size,f=u.start,p=u.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),this.state.blendMode=p,i.set(this.state),r.drawElements(c,l,r.UNSIGNED_SHORT,2*f)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),r.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Object(o.r)(Math.ceil(t/8)),n=Object(o.q)(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new he(r*this.vertexSize*4)),i},e.prototype.getIndexBuffer=function(t){var e=Object(o.r)(Math.ceil(t/12)),n=Object(o.q)(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i},e.prototype.packInterleavedGeometry=function(t,e,n,r,i){for(var s=e.uint32View,a=e.float32View,u=r/this.vertexSize,h=t.uvs,c=t.indices,l=t.vertexData,f=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),d=p<1&&t._texture.baseTexture.alphaMode?Object(o.u)(t._tintRGB,p):t._tintRGB+(255*p<<24),v=0;v<l.length;v+=2)a[r++]=l[v],a[r++]=l[v+1],a[r++]=h[v],a[r++]=h[v+1],s[r++]=d,a[r++]=f;for(v=0;v<c.length;v++)n[i++]=u+c[v]},e._drawCallPool=[],e._textureArrayPool=[],e}(J),le=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=K.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Dt(this.vertexSrc,r)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new u.d,default:this.defaultGroupCache[t]};return new Nt(this.programCache[t],i)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),fe=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new j(null,e,!1),n._indexBuffer=new j(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,i.p.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,i.p.FLOAT).addAttribute("aColor",n._buffer,4,!0,i.p.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,i.p.FLOAT).addIndex(n._indexBuffer),n}return f(e,t),e}(X),pe="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",de="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",ve=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:pe,fragment:de,geometryClass:fe,vertexSize:6},t),n=e.vertex,r=e.fragment,i=e.vertexSize,o=e.geometryClass;return function(t){function e(e){var s=t.call(this,e)||this;return s.shaderGenerator=new le(n,r),s.geometryClass=o,s.vertexSize=i,s}return f(e,t),e}(ce)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return pe},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return de},enumerable:!1,configurable:!0}),t}().create()},function(t,e,n){"use strict";n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return b}));var r=/iPhone/i,i=/iPod/i,o=/iPad/i,s=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,u=/Android/i,h=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,c=/Silk/i,l=/Windows Phone/i,f=/\bWindows(?:.+)ARM\b/i,p=/BlackBerry/i,d=/BB10/i,v=/Opera Mini/i,y=/\b(CriOS|Chrome)(?:.+)Mobile/i,g=/Mobile(?:.+)Firefox\b/i,m=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
 * @pixi/settings - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var _=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,_=n.split("[FBAN");void 0!==_[1]&&(n=_[0]),void 0!==(_=n.split("Twitter"))[1]&&(n=_[0]);var b=function(t){return function(e){return e.test(t)}}(n),w={apple:{phone:b(r)&&!b(l),ipod:b(i),tablet:!b(r)&&(b(o)||m(e))&&!b(l),universal:b(s),device:(b(r)||b(i)||b(o)||b(s)||m(e))&&!b(l)},amazon:{phone:b(h),tablet:!b(h)&&b(c),device:b(h)||b(c)},android:{phone:!b(l)&&b(h)||!b(l)&&b(a),tablet:!b(l)&&!b(h)&&!b(a)&&(b(c)||b(u)),device:!b(l)&&(b(h)||b(c)||b(a)||b(u))||b(/\bokhttp\b/i)},windows:{phone:b(l),tablet:b(f),device:b(l)||b(f)},other:{blackberry:b(p),blackberry10:b(d),opera:b(v),firefox:b(g),chrome:b(y),device:b(p)||b(d)||b(v)||b(g)||b(y)},any:!1,phone:!1,tablet:!1};return w.any=w.apple.device||w.android.device||w.windows.device||w.other.device,w.phone=w.apple.phone||w.android.phone||w.windows.phone,w.tablet=w.apple.tablet||w.android.tablet||w.windows.tablet,w}(window.navigator);var b={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(_.tablet||_.phone){var n;if(_.apple.device)if(n=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(n[1],10)<11&&(e=!1);if(_.android.device)if(n=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(n[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:_.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!_.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},,,function(t,e,n){"use strict";n.d(e,"h",(function(){return D.u})),n.d(e,"d",(function(){return U.b})),n.d(e,"g",(function(){return x.a})),n.d(e,"e",(function(){return k.n})),n.d(e,"b",(function(){return b})),n.d(e,"c",(function(){return bt})),n.d(e,"f",(function(){return It})),n.d(e,"a",(function(){return cn})),n.d(e,"i",(function(){return f.b}));var r=n(48),i=n(49),o=n.n(i);
/*!
 * @pixi/polyfill - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
window.Promise||(window.Promise=r.Polyfill),Object.assign||(Object.assign=o.a);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!window.performance||!window.performance.now){var s=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-s}}for(var a=Date.now(),u=["ms","moz","webkit","o"],h=0;h<u.length&&!window.requestAnimationFrame;++h){var c=u[h];window.requestAnimationFrame=window[c+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+a-e;return n<0&&(n=0),a=e,window.setTimeout((function(){a=Date.now(),t(performance.now())}),n)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);var l=n(0),f=n(4),p=n(2);
/*!
 * @pixi/display - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
f.b.SORTABLE_CHILDREN=!1;var d=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?p.j.EMPTY:((t=t||new p.j(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,o=t[0],s=t[1];e=o<e?o:e,n=s<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[2])<e?o:e,n=(s=t[3])<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[4])<e?o:e,n=(s=t[5])<n?s:n,r=o>r?o:r,i=s>i?s:i,e=(o=t[6])<e?o:e,n=(s=t[7])<n?s:n,r=o>r?o:r,i=s>i?s:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i},t.prototype.addFrame=function(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)},t.prototype.addFrameMatrix=function(t,e,n,r,i){var o=t.a,s=t.b,a=t.c,u=t.d,h=t.tx,c=t.ty,l=this.minX,f=this.minY,p=this.maxX,d=this.maxY,v=o*e+a*n+h,y=s*e+u*n+c;l=v<l?v:l,f=y<f?y:f,p=v>p?v:p,d=y>d?y:d,l=(v=o*r+a*n+h)<l?v:l,f=(y=s*r+u*n+c)<f?y:f,p=v>p?v:p,d=y>d?y:d,l=(v=o*e+a*i+h)<l?v:l,f=(y=s*e+u*i+c)<f?y:f,p=v>p?v:p,d=y>d?y:d,l=(v=o*r+a*i+h)<l?v:l,f=(y=s*r+u*i+c)<f?y:f,p=v>p?v:p,d=y>d?y:d,this.minX=l,this.minY=f,this.maxX=p,this.maxY=d},t.prototype.addVertexData=function(t,e,n){for(var r=this.minX,i=this.minY,o=this.maxX,s=this.maxY,a=e;a<n;a+=2){var u=t[a],h=t[a+1];r=u<r?u:r,i=h<i?h:i,o=u>o?u:o,s=h>s?h:s}this.minX=r,this.minY=i,this.maxX=o,this.maxY=s},t.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},t.prototype.addVerticesMatrix=function(t,e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=i);for(var s=t.a,a=t.b,u=t.c,h=t.d,c=t.tx,l=t.ty,f=this.minX,p=this.minY,d=this.maxX,v=this.maxY,y=n;y<r;y+=2){var g=e[y],m=e[y+1],_=s*g+u*m+c,b=h*m+a*g+l;f=Math.min(f,_-i),d=Math.max(d,_+i),p=Math.min(p,b-o),v=Math.max(v,b+o)}this.minX=f,this.minY=p,this.maxX=d,this.maxY=v},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=n<s?n:s,this.minY=r<a?r:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=o){var s=this.minX,a=this.minY,u=this.maxX,h=this.maxY;this.minX=n<s?n:s,this.minY=r<a?r:a,this.maxX=i>u?i:u,this.maxY=o>h?o:h}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,r,i,o){t-=i,e-=o,n+=i,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},t}(),v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function y(t,e){function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var g=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new p.m,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new d,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return y(e,t),e.mixin=function(t){for(var n=Object.keys(t),r=0;r<n.length;++r){var i=n[r];Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new p.j),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new p.j),t=this._localBoundsRect),this._localBounds||(this._localBounds=new d);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,o},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,r,i,o,s,a,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=u,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new m),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*p.i},set:function(t){this.transform.rotation=t*p.b},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(l.c),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return y(e,t),e}(g);function _(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}g.prototype.displayObjectUpdateTransform=g.prototype.updateTransform;var b=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=f.b.SORTABLE_CHILDREN,e.sortDirty=!1,e}return y(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var r=0;r<e.length;r++)this.addChild(e[r]);else{var i=e[0];i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Object(l.w)(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var r=0;r<e.length;r++)this.removeChild(e[r]);else{var i=e[0],o=this.children.indexOf(i);if(-1===o)return null;i.parent=null,i.transform._parentID=-1,Object(l.w)(this.children,o,1),this._boundsID++,this.onChildrenChange(o),i.emit("removed",this),this.emit("childRemoved",i,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Object(l.w)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,r=t,i=e-r;if(i>0&&i<=e){n=this.children.splice(r,i);for(var o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(_),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var r=t.prototype.getLocalBounds.call(this,e);if(!n)for(var i=0,o=this.children.length;i<o;++i){var s=this.children[i];s.visible&&s.updateTransform()}return r},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}n&&t.mask.push(this,this._mask),this._render(t);r=0;for(var i=this.children.length;r<i;r++)this.children[r].render(t);t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(n)for(var i=0;i<r.length;++i)r[i].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(g);b.prototype.containerUpdateTransform=b.prototype.updateTransform;g.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var w=function(){function t(t){this._hookDiv=null,(l.n.tablet||l.n.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessability for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},t.prototype.update=function(){var t=performance.now();if(!(l.n.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=this.renderer.resolution,r=e.width/this.renderer.width*n,i=e.height/this.renderer.height*n,o=this.div;o.style.left=e.left+"px",o.style.top=e.top+"px",o.style.width=this.renderer.width+"px",o.style.height=this.renderer.height+"px";for(var s=0;s<this.children.length;s++){var a=this.children[s];if(a.renderId!==this.renderId)a._accessibleActive=!1,Object(l.w)(this.children,s,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,s--;else{o=a._accessibleDiv;var u=a.hitArea,h=a.worldTransform;a.hitArea?(o.style.left=(h.tx+u.x*h.a)*r+"px",o.style.top=(h.ty+u.y*h.d)*i+"px",o.style.width=u.width*h.a*r+"px",o.style.height=u.height*h.d*i+"px"):(u=a.getBounds(),this.capHitArea(u),o.style.left=u.x*r+"px",o.style.top=u.y*i+"px",o.style.width=u.width*r+"px",o.style.height=u.height*i+"px",o.title!==a.accessibleTitle&&null!==a.accessibleTitle&&(o.title=a.accessibleTitle),o.getAttribute("aria-label")!==a.accessibleHint&&null!==a.accessibleHint&&o.setAttribute("aria-label",a.accessibleHint)),a.accessibleTitle===o.title&&a.tabIndex===o.tabIndex||(o.title=a.accessibleTitle,o.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(o))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}(),x=n(8),E=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new p.g,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var I=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),A=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),S=function(){function t(){this._tempPoint=new p.g}return t.prototype.recursiveFindHit=function(t,e,n,r,i){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=i=e.interactive||i,u=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(r=!1,u=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(r=!1)),u&&e.interactiveChildren&&e.children)for(var h=e.children,c=h.length-1;c>=0;c--){var l=h[c],f=this.recursiveFindHit(t,l,n,r,a);if(f){if(!l.parent)continue;a=!1,f&&(t.target&&(r=!1),s=!0)}}return i&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},t.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},t}(),O={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};g.mixin(O);var P={target:null,data:{global:null}},C=function(t){function e(e,n){var r=t.call(this)||this;return n=n||{},r.renderer=e,r.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new E,r.mouse.identifier=1,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[1]=r.mouse,r.interactionDataPool=[],r.eventData=new I,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!1,r.supportsTouchEvents="ontouchstart"in window,r.supportsPointerEvents=!!window.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new S,r._tempDisplayObject=new m,r._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return function(t,e){function n(){this.constructor=t}T(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return P.target=null,P.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(P,e,null,!0),P.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(x.a.system.add(this.tickerUpdate,this,x.c.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(x.a.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var i=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*i,t.y=(n-r.top)*(this.interactionDOMElement.height/r.height)*i},e.prototype.processInteractive=function(t,e,n,r){var i=this.search.findHit(t,e,n,r),o=this.delayedEvents;if(!o.length)return i;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var u=o[a],h=u.displayObject,c=u.eventString,l=u.eventData;l.stopsPropagatingAt===h&&(l.stopPropagationHint=!0),this.dispatchEvent(h,c,l)}return i},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===i.pointerType)this.emit("touchstart",s);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var r=t.data,i=t.data.identifier;if(n)if(e.trackedPointers[i]||(e.trackedPointers[i]=new A(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var o=2===r.button;o?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){for(var r=this.normalizeToPointerData(t),i=r.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var a=r[s],u=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,u);if(h.data.originalEvent=t,this.processInteractive(h,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,h),"mouse"===a.pointerType||"pen"===a.pointerType){var c=2===a.button;this.emit(c?"rightup"+o:"mouseup"+o,h)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,h),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var r=t.data,i=t.data.identifier,o=e.trackedPointers[i],s="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,u=!1;if(a){var h=2===r.button,c=A.FLAGS,l=h?c.RIGHT_DOWN:c.LEFT_DOWN,f=void 0!==o&&o.flags&l;n?(this.dispatchEvent(e,h?"rightup":"mouseup",t),f&&(this.dispatchEvent(e,h?"rightclick":"click",t),u=!0)):f&&this.dispatchEvent(e,h?"rightupoutside":"mouseupoutside",t),o&&(h?o.rightDown=!1:o.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!u||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[i]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===i.pointerType&&this.emit("touchmove",s),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var r=t.data,i="touch"===r.pointerType,o="mouse"===r.pointerType||"pen"===r.pointerType;o&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var r=t.data,i=t.data.identifier,o="mouse"===r.pointerType||"pen"===r.pointerType,s=e.trackedPointers[i];n&&!s&&(s=e.trackedPointers[i]=new A(i)),void 0!==s&&(n&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[i]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,n);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new E).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,r=t.changedTouches.length;n<r;n++){var i=t.changedTouches[n];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else if(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent)e.push(t);else{var o=t;void 0===o.isPrimary&&(o.isPrimary=!0),void 0===o.width&&(o.width=1),void 0===o.height&&(o.height=1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="mouse"),void 0===o.pointerId&&(o.pointerId=1),void 0===o.pressure&&(o.pressure=.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(l.c),D=n(3),N=function(){function t(e){var n=this;e=Object.assign({forceCanvas:!1},e),this.renderer=Object(D.u)(e),this.stage=new b,t._plugins.forEach((function(t){t.init.call(n,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,n){var r=this,i=t._plugins.slice(0);i.reverse(),i.forEach((function(t){t.destroy.call(r)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null},t}();N._plugins=[];var R=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===window)t=window.innerWidth,n=window.innerHeight;else{var r=e._resizeTo;t=r.clientWidth,n=r.clientHeight}e.renderer.resize(t,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();N.registerPlugin(R);
/*!
 * @pixi/extract - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var M=new p.j,L=function(){function t(t){this.renderer=t,t.extract=this}return t.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(e){var n,r,i,o=this.renderer,s=!1,a=!1;e&&(e instanceof D.n?i=e:(i=this.renderer.generateTexture(e),a=!0)),i?(n=i.baseTexture.resolution,r=i.frame,s=!1,o.renderTexture.bind(i)):(n=this.renderer.resolution,s=!0,(r=M).width=this.renderer.width,r.height=this.renderer.height,o.renderTexture.bind(null));var u=Math.floor(r.width*n+1e-4),h=Math.floor(r.height*n+1e-4),c=new l.b(u,h,1),f=new Uint8Array(4*u*h),p=o.gl;p.readPixels(r.x*n,r.y*n,u,h,p.RGBA,p.UNSIGNED_BYTE,f);var d=c.context.getImageData(0,0,u,h);if(t.arrayPostDivide(f,d.data),c.context.putImageData(d,0,0),s){var v=new l.b(c.width,c.height,1);v.context.scale(1,-1),v.context.drawImage(c.canvas,0,-h),c.destroy(),c=v}return a&&i.destroy(!0),c.canvas},t.prototype.pixels=function(e){var n,r,i,o=this.renderer,s=!1;e&&(e instanceof D.n?i=e:(i=this.renderer.generateTexture(e),s=!0)),i?(n=i.baseTexture.resolution,r=i.frame,o.renderTexture.bind(i)):(n=o.resolution,(r=M).width=o.width,r.height=o.height,o.renderTexture.bind(null));var a=r.width*n,u=r.height*n,h=new Uint8Array(4*a*u),c=o.gl;return c.readPixels(r.x*n,r.y*n,a,u,c.RGBA,c.UNSIGNED_BYTE,h),s&&i.destroy(!0),t.arrayPostDivide(h,h),h},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];0!==r?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},t}(),U=n(10),k=n(1),F=function(t,e){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function j(t,e){function n(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var B,V,G=function(t){function e(e,n,r,i){void 0===e&&(e=1500),void 0===r&&(r=16384),void 0===i&&(i=!1);var o=t.call(this)||this;return r>16384&&(r=16384),o._properties=[!1,!0,!1,!1,!1],o._maxSize=e,o._batchSize=r,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=k.b.NORMAL,o.autoResize=i,o.roundPixels=!0,o.baseTexture=null,o.setProperties(n),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return j(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,Object(l.l)(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},e}(b),z=function(){function t(t,e,n){this.geometry=new D.j,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var i=t[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||k.p.FLOAT,offset:i.offset},e[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new D.h(Object(l.g)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){(s=this.dynamicProperties[n]).offset=e,e+=s.size,this.dynamicStride+=s.size}var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new D.h(this.dynamicData,!1,!1);var i=0;this.staticStride=0;for(n=0;n<this.staticProperties.length;++n){(s=this.staticProperties[n]).offset=i,i+=s.size,this.staticStride+=s.size}var o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new D.h(this.staticData,!0,!1);for(n=0;n<this.dynamicProperties.length;++n){var s=this.dynamicProperties[n];t.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===k.p.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(n=0;n<this.staticProperties.length;++n){s=this.staticProperties[n];t.addAttribute(s.attributeName,this.staticBuffer,0,s.type===k.p.UNSIGNED_BYTE,s.type,4*this.staticStride,4*s.offset)}},t.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===k.p.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===k.p.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),H=function(t){function e(e){var n=t.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new p.d,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:k.p.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=D.p.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=D.q.for2d(),n}return j(e,t),e.prototype.render=function(t){var e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer,o=e.length;if(0!==o){o>n&&!t.autoResize&&(o=n);var s=t._buffers;s||(s=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.state.blendMode=Object(l.f)(t.blendMode,a.alphaMode),i.state.set(this.state);var u=i.gl,h=t.worldTransform.copyTo(this.tempMatrix);h.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=Object(l.t)(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,a.alphaMode),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var c=!1,f=0,p=0;f<o;f+=r,p+=1){var d=o-f;d>r&&(d=r),p>=s.length&&s.push(this._generateOneMoreBuffer(t));var v=s[p];v.uploadDynamic(e,f,d);var y=t._bufferUpdateIDs[p]||0;(c=c||v._updateID<y)&&(v._updateID=t._updateID,v.uploadStatic(e,f,d)),i.geometry.bind(v.geometry),u.drawElements(u.TRIANGLES,6*d,u.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,r=t._batchSize,i=t._properties,o=0;o<n;o+=r)e.push(new z(this.properties,i,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new z(this.properties,n,e)},e.prototype.uploadVertices=function(t,e,n,r,i,o){for(var s=0,a=0,u=0,h=0,c=0;c<n;++c){var l=t[e+c],f=l._texture,p=l.scale.x,d=l.scale.y,v=f.trim,y=f.orig;v?(s=(a=v.x-l.anchor.x*y.width)+v.width,u=(h=v.y-l.anchor.y*y.height)+v.height):(s=y.width*(1-l.anchor.x),a=y.width*-l.anchor.x,u=y.height*(1-l.anchor.y),h=y.height*-l.anchor.y),r[o]=a*p,r[o+1]=h*d,r[o+i]=s*p,r[o+i+1]=h*d,r[o+2*i]=s*p,r[o+2*i+1]=u*d,r[o+3*i]=a*p,r[o+3*i+1]=u*d,o+=4*i}},e.prototype.uploadPosition=function(t,e,n,r,i,o){for(var s=0;s<n;s++){var a=t[e+s].position;r[o]=a.x,r[o+1]=a.y,r[o+i]=a.x,r[o+i+1]=a.y,r[o+2*i]=a.x,r[o+2*i+1]=a.y,r[o+3*i]=a.x,r[o+3*i+1]=a.y,o+=4*i}},e.prototype.uploadRotation=function(t,e,n,r,i,o){for(var s=0;s<n;s++){var a=t[e+s].rotation;r[o]=a,r[o+i]=a,r[o+2*i]=a,r[o+3*i]=a,o+=4*i}},e.prototype.uploadUvs=function(t,e,n,r,i,o){for(var s=0;s<n;++s){var a=t[e+s]._texture._uvs;a?(r[o]=a.x0,r[o+1]=a.y0,r[o+i]=a.x1,r[o+i+1]=a.y1,r[o+2*i]=a.x2,r[o+2*i+1]=a.y2,r[o+3*i]=a.x3,r[o+3*i+1]=a.y3,o+=4*i):(r[o]=0,r[o+1]=0,r[o+i]=0,r[o+i+1]=0,r[o+2*i]=0,r[o+2*i+1]=0,r[o+3*i]=0,r[o+3*i+1]=0,o+=4*i)}},e.prototype.uploadTint=function(t,e,n,r,i,o){for(var s=0;s<n;++s){var a=t[e+s],u=a._texture.baseTexture.alphaMode>0,h=a.alpha,c=h<1&&u?Object(l.u)(a._tintRGB,h):a._tintRGB+(255*h<<24);r[o]=c,r[o+i]=c,r[o+2*i]=c,r[o+3*i]=c,o+=4*i}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(D.k);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(B||(B={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(V||(V={}));var X={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},q=function(){function t(){this.color=16777215,this.alpha=1,this.texture=D.r.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=D.r.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Y=function(t,e){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function W(t,e){function n(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var K={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,r=t.holes,i=e.points,o=e.indices;if(n.length>=6){for(var s=[],a=0;a<r.length;a++){var u=r[a];s.push(n.length/2),n=n.concat(u.points)}var h=Object(l.j)(n,s,2);if(!h)return;var c=i.length/2;for(a=0;a<h.length;a+=3)o.push(h[a]+c),o.push(h[a+1]+c),o.push(h[a+2]+c);for(a=0;a<n.length;a++)i.push(n[a])}}},Q={build:function(t){var e,n,r=t.shape,i=t.points,o=r.x,s=r.y;if(i.length=0,t.type===p.l.CIRC)e=r.radius,n=r.radius;else{var a=t.shape;e=a.width,n=a.height}if(0!==e&&0!==n){var u=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(e+n));u/=2.3;for(var h=2*Math.PI/u,c=0;c<u-.5;c++)i.push(o+Math.sin(-h*c)*e,s+Math.cos(-h*c)*n);i.push(i[0],i[1])}},triangulate:function(t,e){var n=t.points,r=e.points,i=e.indices,o=r.length/2,s=o,a=t.shape,u=t.matrix,h=a.x,c=a.y;r.push(t.matrix?u.a*h+u.c*c+u.tx:h,t.matrix?u.b*h+u.d*c+u.ty:c);for(var l=0;l<n.length;l+=2)r.push(n[l],n[l+1]),i.push(o++,s,o)}},Z={build:function(t){var e=t.shape,n=e.x,r=e.y,i=e.width,o=e.height,s=t.points;s.length=0,s.push(n,r,n+i,r,n+i,r+o,n,r+o)},triangulate:function(t,e){var n=t.points,r=e.points,i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function J(t,e,n){return t+(e-t)*n}function $(t,e,n,r,i,o,s){void 0===s&&(s=[]);for(var a=s,u=0,h=0,c=0,l=0,f=0,p=0,d=0,v=0;d<=20;++d)u=J(t,n,v=d/20),h=J(e,r,v),c=J(n,i,v),l=J(r,o,v),f=J(u,c,v),p=J(h,l,v),a.push(f,p);return a}var tt={build:function(t){var e=t.shape,n=t.points,r=e.x,i=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));n.length=0,a?($(r,i+a,r,i,r+a,i,n),$(r+o-a,i,r+o,i,r+o,i+a,n),$(r+o,i+s-a,r+o,i+s,r+o-a,i+s,n),$(r+a,i+s,r,i+s,r,i+s-a,n)):n.push(r,i,r+o,i,r+o,i+s,r,i+s)},triangulate:function(t,e){for(var n=t.points,r=e.points,i=e.indices,o=r.length/2,s=Object(l.j)(n,null,2),a=0,u=s.length;a<u;a+=3)i.push(s[a]+o),i.push(s[a+1]+o),i.push(s[a+2]+o);for(a=0,u=n.length;a<u;a++)r.push(n[a],n[++a])}};function et(t,e,n,r,i,o,s,a){var u,h;s?(u=r,h=-n):(u=-r,h=n);var c=t-n*i+u,l=e-r*i+h,f=t+n*o+u,p=e+r*o+h;return a.push(c,l),a.push(f,p),2}function nt(t,e,n,r,i,o,s,a){var u=n-t,h=r-e,c=Math.atan2(u,h),l=Math.atan2(i-t,o-e);a&&c<l?c+=2*Math.PI:!a&&c>l&&(l+=2*Math.PI);var f=c,p=l-c,d=Math.abs(p),v=Math.sqrt(u*u+h*h),y=1+(15*d*Math.sqrt(v)/Math.PI>>0),g=p/y;if(f+=g,a){s.push(t,e),s.push(n,r);for(var m=1,_=f;m<y;m++,_+=g)s.push(t,e),s.push(t+Math.sin(_)*v,e+Math.cos(_)*v);s.push(t,e),s.push(i,o)}else{s.push(n,r),s.push(t,e);for(m=1,_=f;m<y;m++,_+=g)s.push(t+Math.sin(_)*v,e+Math.cos(_)*v),s.push(t,e);s.push(i,o),s.push(t,e)}return 2*y}function rt(t,e){t.lineStyle.native?function(t,e){var n=0,r=t.shape,i=t.points||r.points,o=r.type!==p.l.POLY||r.closeStroke;if(0!==i.length){var s=e.points,a=e.indices,u=i.length/2,h=s.length/2,c=h;for(s.push(i[0],i[1]),n=1;n<u;n++)s.push(i[2*n],i[2*n+1]),a.push(c,c+1),c++;o&&a.push(c,h)}}(t,e):function(t,e){var n=t.shape,r=t.points||n.points.slice(),i=e.closePointEps;if(0!==r.length){var o=t.lineStyle,s=new p.g(r[0],r[1]),a=new p.g(r[r.length-2],r[r.length-1]),u=n.type!==p.l.POLY||n.closeStroke,h=Math.abs(s.x-a.x)<i&&Math.abs(s.y-a.y)<i;if(u){r=r.slice(),h&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var c=.5*(s.x+a.x),l=.5*(a.y+s.y);r.unshift(c,l),r.push(c,l)}var f=e.points,d=r.length/2,v=r.length,y=f.length/2,g=o.width/2,m=g*g,_=o.miterLimit*o.miterLimit,b=r[0],w=r[1],x=r[2],E=r[3],T=0,I=0,A=-(w-E),S=b-x,O=0,P=0,C=Math.sqrt(A*A+S*S);A/=C,S/=C,A*=g,S*=g;var D=o.alignment,N=2*(1-D),R=2*D;u||(o.cap===V.ROUND?v+=nt(b-A*(N-R)*.5,w-S*(N-R)*.5,b-A*N,w-S*N,b+A*R,w+S*R,f,!0)+2:o.cap===V.SQUARE&&(v+=et(b,w,A,S,N,R,!0,f))),f.push(b-A*N,w-S*N),f.push(b+A*R,w+S*R);for(var M=1;M<d-1;++M){b=r[2*(M-1)],w=r[2*(M-1)+1],x=r[2*M],E=r[2*M+1],T=r[2*(M+1)],I=r[2*(M+1)+1],A=-(w-E),S=b-x,A/=C=Math.sqrt(A*A+S*S),S/=C,A*=g,S*=g,O=-(E-I),P=x-T,O/=C=Math.sqrt(O*O+P*P),P/=C,O*=g,P*=g;var L=x-b,U=w-E,k=x-T,F=I-E,j=U*k-F*L,G=j<0;if(Math.abs(j)<.1)f.push(x-A*N,E-S*N),f.push(x+A*R,E+S*R);else{var z=(-A+b)*(-S+E)-(-A+x)*(-S+w),H=(-O+T)*(-P+E)-(-O+x)*(-P+I),q=(L*H-k*z)/j,Y=(F*z-U*H)/j,W=(q-x)*(q-x)+(Y-E)*(Y-E),K=x+(q-x)*N,Q=E+(Y-E)*N,Z=x-(q-x)*R,J=E-(Y-E)*R;o.join===B.BEVEL||W/m>_?(G?(f.push(K,Q),f.push(x+A*R,E+S*R),f.push(K,Q),f.push(x+O*R,E+P*R)):(f.push(x-A*N,E-S*N),f.push(Z,J),f.push(x-O*N,E-P*N),f.push(Z,J)),v+=2):o.join===B.ROUND?G?(f.push(K,Q),f.push(x+A*R,E+S*R),v+=nt(x,E,x+A*R,E+S*R,x+O*R,E+P*R,f,!0)+4,f.push(K,Q),f.push(x+O*R,E+P*R)):(f.push(x-A*N,E-S*N),f.push(Z,J),v+=nt(x,E,x-A*N,E-S*N,x-O*N,E-P*N,f,!1)+4,f.push(x-O*N,E-P*N),f.push(Z,J)):(f.push(K,Q),f.push(Z,J))}}b=r[2*(d-2)],w=r[2*(d-2)+1],x=r[2*(d-1)],A=-(w-(E=r[2*(d-1)+1])),S=b-x,A/=C=Math.sqrt(A*A+S*S),S/=C,A*=g,S*=g,f.push(x-A*N,E-S*N),f.push(x+A*R,E+S*R),u||(o.cap===V.ROUND?v+=nt(x-A*(N-R)*.5,E-S*(N-R)*.5,x-A*N,E-S*N,x+A*R,E+S*R,f,!1)+2:o.cap===V.SQUARE&&(v+=et(x,E,A,S,N,R,!1,f)));var $=e.indices,tt=X.epsilon*X.epsilon;for(M=y;M<v+y-2;++M)b=f[2*M],w=f[2*M+1],x=f[2*(M+1)],E=f[2*(M+1)+1],T=f[2*(M+2)],I=f[2*(M+2)+1],Math.abs(b*(E-I)+x*(I-w)+T*(w-E))<tt||$.push(M,M+1,M+2)}}(t,e)}var it,ot=function(t){function e(e,n,r,i,o,s){void 0===s&&(s=0);o=o||i/2;for(var a=-1*Math.PI/2+s,u=2*r,h=p.f/u,c=[],l=0;l<u;l++){var f=l%2?o:i,d=l*h+a;c.push(e+f*Math.cos(d),n+f*Math.sin(d))}return t.call(this,c)||this}return W(e,t),e}(p.h),st=function(){function t(){}return t.curveTo=function(t,e,n,r,i,o){var s=o[o.length-2],a=o[o.length-1]-e,u=s-t,h=r-e,c=n-t,l=Math.abs(a*c-u*h);if(l<1e-8||0===i)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var f=a*a+u*u,p=h*h+c*c,d=a*h+u*c,v=i*Math.sqrt(f)/l,y=i*Math.sqrt(p)/l,g=v*d/f,m=y*d/p,_=v*c+y*u,b=v*h+y*a,w=u*(y+g),x=a*(y+g),E=c*(v+m),T=h*(v+m);return{cx:_+t,cy:b+e,radius:i,startAngle:Math.atan2(x-b,w-_),endAngle:Math.atan2(T-b,E-_),anticlockwise:u*h>c*a}},t.arc=function(t,e,n,r,i,o,s,a,u){for(var h=s-o,c=X._segmentsCount(Math.abs(h)*i,40*Math.ceil(Math.abs(h)/p.f)),l=h/(2*c),f=2*l,d=Math.cos(l),v=Math.sin(l),y=c-1,g=y%1/y,m=0;m<=y;++m){var _=l+o+f*(m+g*m),b=Math.cos(_),w=-Math.sin(_);u.push((d*b+v*w)*i+n,(d*-w+v*b)*i+r)}},t}(),at=function(){function t(){}return t.curveLength=function(t,e,n,r,i,o,s,a){for(var u=0,h=0,c=0,l=0,f=0,p=0,d=0,v=0,y=0,g=0,m=0,_=t,b=e,w=1;w<=10;++w)g=_-(v=(d=(p=(f=1-(h=w/10))*f)*f)*t+3*p*h*n+3*f*(c=h*h)*i+(l=c*h)*s),m=b-(y=d*e+3*p*h*r+3*f*c*o+l*a),_=v,b=y,u+=Math.sqrt(g*g+m*m);return u},t.curveTo=function(e,n,r,i,o,s,a){var u=a[a.length-2],h=a[a.length-1];a.length-=2;var c=X._segmentsCount(t.curveLength(u,h,e,n,r,i,o,s)),l=0,f=0,p=0,d=0,v=0;a.push(u,h);for(var y=1,g=0;y<=c;++y)p=(f=(l=1-(g=y/c))*l)*l,v=(d=g*g)*g,a.push(p*u+3*f*g*e+3*l*d*r+v*o,p*h+3*f*g*n+3*l*d*i+v*s)},t}(),ut=function(){function t(){}return t.curveLength=function(t,e,n,r,i,o){var s=t-2*n+i,a=e-2*r+o,u=2*n-2*t,h=2*r-2*e,c=4*(s*s+a*a),l=4*(s*u+a*h),f=u*u+h*h,p=2*Math.sqrt(c+l+f),d=Math.sqrt(c),v=2*c*d,y=2*Math.sqrt(f),g=l/d;return(v*p+d*l*(p-y)+(4*f*c-l*l)*Math.log((2*d+g+p)/(g+y)))/(4*v)},t.curveTo=function(e,n,r,i,o){for(var s=o[o.length-2],a=o[o.length-1],u=X._segmentsCount(t.curveLength(s,a,e,n,r,i)),h=0,c=0,l=1;l<=u;++l){var f=l/u;h=s+(e-s)*f,c=a+(n-a)*f,o.push(h+(e+(r-e)*f-h)*f,c+(n+(i-n)*f-c)*f)}},t}(),ht=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),ct=((it={})[p.l.POLY]=K,it[p.l.CIRC]=Q,it[p.l.ELIP]=Q,it[p.l.RECT]=Z,it[p.l.RREC]=tt,it),lt=[],ft=[],pt=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),dt=new p.g,vt=new d,yt=function(t){function e(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new d,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return W(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ft.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),lt.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null);var i=new pt(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new pt(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var r=e[n];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,dt):dt.copyFrom(t),r.shape.contains(dt.x,dt.y)))){var i=!1;if(r.holes)for(var o=0;o<r.holes.length;o++){if(r.holes[o].shape.contains(dt.x,dt.y)){i=!0;break}}if(!i)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(var o=this.shapeIndex;o<n.length;o++){this.shapeIndex++;var s=n[o],a=s.fillStyle,u=s.lineStyle;ct[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var c=0===h?a:u;if(c.visible){var l=c.texture.baseTexture,f=this.indices.length,p=this.points.length/2;l.wrapMode=k.q.REPEAT,0===h?this.processFill(s):this.processLine(s);var d=this.points.length/2-p;0!==d&&(r&&!this._compareStyles(i,c)&&(r.end(f,p),r=null),r||((r=lt.pop()||new ht).begin(c,f,p),this.batches.push(r),i=c),this.addUvs(this.points,e,c.texture,p,d,c.matrix))}}}var v=this.indices.length,y=this.points.length/2;if(r&&r.end(v,y),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=y>65535&&t;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var r=t[e],i=0;i<r.size;i++){var o=r.start+i;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++D.c._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ft.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=ft.pop();i||((i=new D.d).texArray=new D.g),i.texArray.count=0,i.start=0,i.size=0,i.type=k.e.TRIANGLES;var o=0,s=null,a=0,u=!1,h=k.e.TRIANGLES,c=0;this.drawCalls.push(i);for(e=0;e<this.batches.length;e++){var l=this.batches[e],f=l.style,p=f.texture.baseTexture;u!==!!f.native&&(h=(u=!!f.native)?k.e.LINES:k.e.TRIANGLES,s=null,o=8,t++),s!==p&&(s=p,p._batchEnabled!==t&&(8===o&&(t++,o=0,i.size>0&&((i=ft.pop())||((i=new D.d).texArray=new D.g),this.drawCalls.push(i)),i.start=c,i.size=0,i.texArray.count=0,i.type=h),p.touched=1,p._batchEnabled=t,p._batchLocation=o,p.wrapMode=10497,i.texArray.elements[i.texArray.count++]=p,o++)),i.size+=l.size,c+=l.size,a=p._batchLocation,this.addColors(n,f.color,f.alpha,l.attribSize),this.addTextureIds(r,a,l.attribSize)}D.c._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),o=new Float32Array(i),s=new Uint32Array(i),a=0,u=0;u<t.length/2;u++)o[a++]=t[2*u],o[a++]=t[2*u+1],o[a++]=e[2*u],o[a++]=e[2*u+1],s[a++]=n[u],o[a++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),K.triangulate(t,this)):ct[t.type].triangulate(t,this)},e.prototype.processLine=function(t){rt(t,this);for(var e=0;e<t.holes.length;e++)rt(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];ct[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=vt,n=p.d.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var i=this.graphicsData[r],o=i.shape,s=i.type,a=i.lineStyle,u=i.matrix||p.d.IDENTITY,h=0;if(a&&a.visible){var c=a.alignment;h=a.width,s===p.l.POLY?h*=.5+Math.abs(.5-c):h*=Math.max(0,c)}if(n!==u&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=u),s===p.l.RECT||s===p.l.RREC){var l=o;e.addFramePad(l.x,l.y,l.x+l.width,l.y+l.height,h,h)}else if(s===p.l.CIRC){var f=o;e.addFramePad(f.x,f.y,f.x,f.y,f.radius+h,f.radius+h)}else if(s===p.l.ELIP){var d=o;e.addFramePad(d.x,d.y,d.x,d.y,d.width+h,d.height+h)}else{var v=o;t.addVerticesMatrix(n,v.points,0,v.points.length,h,h)}}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}},e.prototype.addColors=function(t,e,n,r){for(var i=(e>>16)+(65280&e)+((255&e)<<16),o=Object(l.u)(i,n);r-- >0;)t.push(o)},e.prototype.addTextureIds=function(t,e,n){for(;n-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,n,r,i,o){void 0===o&&(o=null);for(var s=0,a=e.length,u=n.frame;s<i;){var h=t[2*(r+s)],c=t[2*(r+s)+1];if(o){var l=o.a*h+o.c*c+o.tx;c=o.b*h+o.d*c+o.ty,h=l}s++,e.push(h/u.width,c/u.height)}var f=n.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(e,n,a,i)},e.prototype.adjustUvs=function(t,e,n,r){for(var i=e.baseTexture,o=1e-6,s=n+2*r,a=e.frame,u=a.width/i.width,h=a.height/i.height,c=a.x/a.width,l=a.y/a.height,f=Math.floor(t[n]+o),p=Math.floor(t[n+1]+o),d=n+2;d<s;d+=2)f=Math.min(f,Math.floor(t[d]+o)),p=Math.min(p,Math.floor(t[d+1]+o));c-=f,l-=p;for(d=n;d<s;d+=2)t[d]=(t[d]+c)*u,t[d+1]=(t[d+1]+l)*h},e.BATCHABLE_SIZE=100,e}(D.e),gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=V.BUTT,e.join=B.MITER,e.miterLimit=10,e}return W(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(q),mt=new Float32Array(3),_t={},bt=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n._geometry=e||new yt,n._geometry.refCount++,n.shader=null,n.state=D.q.for2d(),n._fillStyle=new q,n._lineStyle=new gt,n._matrix=null,n._holeMode=!1,n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n.pluginName="batch",n._transformID=-1,n.tint=16777215,n.blendMode=k.b.NORMAL,n}return W(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){Object(l.h)("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments,n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6];t={width:n,texture:r,color:i,alpha:o,matrix:s,alignment:a,native:u},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({width:0,texture:D.r.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:V.BUTT,join:B.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new p.h,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new p.h,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return r===t&&i===e||n.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),ut.curveTo(t,e,n,r,i),this},e.prototype.bezierCurveTo=function(t,e,n,r,i,o){return this._initCurve(),at.curveTo(t,e,n,r,i,o,this.currentPath.points),this},e.prototype.arcTo=function(t,e,n,r,i){this._initCurve(t,e);var o=this.currentPath.points,s=st.curveTo(t,e,n,r,i,o);if(s){var a=s.cx,u=s.cy,h=s.radius,c=s.startAngle,l=s.endAngle,f=s.anticlockwise;this.arc(a,u,h,c,l,f)}return this},e.prototype.arc=function(t,e,n,r,i,o){if(void 0===o&&(o=!1),r===i)return this;if(!o&&i<=r?i+=p.f:o&&r<=i&&(r+=p.f),0===i-r)return this;var s=t+Math.cos(r)*n,a=e+Math.sin(r)*n,u=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){var c=Math.abs(h[h.length-2]-s),l=Math.abs(h[h.length-1]-a);c<u&&l<u||h.push(s,a)}else this.moveTo(s,a),h=this.currentPath.points;return st.arc(s,a,t,e,n,r,i,o,h),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:D.r.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof D.r){Object(l.h)("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments,n=e[0],r=e[1],i=e[2],o=e[3];t={texture:n,color:r,alpha:i,matrix:o},Object.keys(t).forEach((function(e){return void 0===t[e]&&delete t[e]}))}t=Object.assign({texture:D.r.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,n,r){return this.drawShape(new p.j(t,e,n,r))},e.prototype.drawRoundedRect=function(t,e,n,r,i){return this.drawShape(new p.k(t,e,n,r,i))},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new p.a(t,e,n))},e.prototype.drawEllipse=function(t,e,n,r){return this.drawShape(new p.c(t,e,n,r))},e.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],r=0;r<arguments.length;r++)n[r]=e[r];var i=!0,o=n[0];o.points?(i=o.closeStroke,t=o.points):t=Array.isArray(n[0])?n[0]:n;var s=new p.h(t);return s.closeStroke=i,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,n,r,i,o){return void 0===o&&(o=0),this.drawPolygon(new ot(t,e,n,r,i,o))},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===p.l.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var r=0;r<n;r++){var i=t.batches[r],o=i.style.color,s=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),u={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:a,_batchRGB:Object(l.l)(o),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=u}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,r=this.tint,i=this.worldAlpha,o=e.uniforms,s=n.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(r>>16&255)/255*i,o.tint[1]=(r>>8&255)/255*i,o.tint[2]=(255&r)/255*i,o.tint[3]=i,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,u=s.length;a<u;a++)this._renderDrawCallDirect(t,n.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,r=e.type,i=e.size,o=e.start,s=n.count,a=0;a<s;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(r,i,o)},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!_t[n]){for(var r=new Int32Array(16),i=0;i<16;i++)r[i]=i;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new p.d,default:D.t.from({uSamplers:r},!0)},s=t.plugins[n]._shader.program;_t[n]=new D.p(s,o)}e=_t[n]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,r=e.minY,i=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,n,r,i,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Object(l.l)(this.tint,mt),e=0;e<this.batches.length;e++){var n=this.batches[e],r=n._batchRGB,i=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);n._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,u=this._geometry.points,h=this.vertexData,c=0,l=0;l<u.length;l+=2){var f=u[l],p=u[l+1];h[c++]=n*f+i*p+s,h[c++]=o*p+r*f+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new p.g,e}(b),wt=function(t,e){return(wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var xt,Et=new p.g,Tt=new Uint16Array([0,1,2,0,2,3]),It=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new p.e(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=k.b.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||D.r.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=Tt,n.pluginName="batch",n.isSprite=!0,n._roundPixels=f.b.ROUND_PIXELS,n}return function(t,e){function n(){this.constructor=t}wt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Object(l.z)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Object(l.z)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,u=this.vertexData,h=t.trim,c=t.orig,l=this._anchor,p=0,d=0,v=0,y=0;if(h?(p=(d=h.x-l._x*c.width)+h.width,v=(y=h.y-l._y*c.height)+h.height):(p=(d=-l._x*c.width)+c.width,v=(y=-l._y*c.height)+c.height),u[0]=n*d+i*y+s,u[1]=o*y+r*d+a,u[2]=n*p+i*y+s,u[3]=o*y+r*p+a,u[4]=n*p+i*v+s,u[5]=o*v+r*p+a,u[6]=n*d+i*v+s,u[7]=o*v+r*d+a,this._roundPixels)for(var g=f.b.RESOLUTION,m=0;m<u.length;++m)u[m]=Math.round((u[m]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,o=i.a,s=i.b,a=i.c,u=i.d,h=i.tx,c=i.ty,l=-r._x*n.width,f=l+n.width,p=-r._y*n.height,d=p+n.height;e[0]=o*l+a*p+h,e[1]=u*p+s*l+c,e[2]=o*f+a*p+h,e[3]=u*p+s*f+c,e[4]=o*f+a*d+h,e[5]=u*d+s*f+c,e[6]=o*l+a*d+h,e[7]=u*d+s*l+c},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new p.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Et);var e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x,i=0;return Et.x>=r&&Et.x<r+e&&(i=-n*this.anchor.y,Et.y>=i&&Et.y<i+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof D.r?t:D.r.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Object(l.z)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Object(l.z)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||D.r.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(b),At=function(t,e){return(At=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(xt||(xt={}));var St={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:xt.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Ot=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Pt=function(){function t(t){this.styleID=0,this.reset(),Nt(this,t,t)}return t.prototype.clone=function(){var e={};return Nt(e,this,St),new t(e)},t.prototype.reset=function(){Nt(this,St,St)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Dt(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Dt(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Dt(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Ot.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function Ct(t){return"number"==typeof t?Object(l.m)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Dt(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Ct(t[e]);return t}return Ct(t)}function Nt(t,e,n){for(var r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}var Rt=function(){function t(t,e,n,r,i,o,s,a,u){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=u}return t.measureText=function(e,n,r,i){void 0===i&&(i=t._canvas),r=null==r?n.wordWrap:r;var o=n.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=n.fontSize,s.ascent=n.fontSize);var a=i.getContext("2d");a.font=o;for(var u=(r?t.wordWrap(e,n,i):e).split(/(?:\r\n|\r|\n)/),h=new Array(u.length),c=0,l=0;l<u.length;l++){var f=a.measureText(u[l]).width+(u[l].length-1)*n.letterSpacing;h[l]=f,c=Math.max(c,f)}var p=c+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);var d=n.lineHeight||s.fontSize+n.strokeThickness,v=Math.max(d,s.fontSize+n.strokeThickness)+(u.length-1)*(d+n.leading);return n.dropShadow&&(v+=n.dropShadowDistance),new t(e,n,p,v,u,h,d+n.leading,c,s)},t.wordWrap=function(e,n,r){void 0===r&&(r=t._canvas);for(var i=r.getContext("2d"),o=0,s="",a="",u={},h=n.letterSpacing,c=n.whiteSpace,l=t.collapseSpaces(c),f=t.collapseNewlines(c),p=!l,d=n.wordWrapWidth+h,v=t.tokenize(e),y=0;y<v.length;y++){var g=v[y];if(t.isNewline(g)){if(!f){a+=t.addLine(s),p=!l,s="",o=0;continue}g=" "}if(l){var m=t.isBreakingSpace(g),_=t.isBreakingSpace(s[s.length-1]);if(m&&_)continue}var b=t.getFromCache(g,h,u,i);if(b>d)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(g,n.breakWords))for(var w=t.wordWrapSplit(g),x=0;x<w.length;x++){for(var E=w[x],T=1;w[x+T];){var I=w[x+T],A=E[E.length-1];if(t.canBreakChars(A,I,g,x,n.breakWords))break;E+=I,T++}x+=E.length-1;var S=t.getFromCache(E,h,u,i);S+o>d&&(a+=t.addLine(s),p=!1,s="",o=0),s+=E,o+=S}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var O=y===v.length-1;a+=t.addLine(g,!O),p=!1,s="",o=0}else b+o>d&&(p=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(g)||p)&&(s+=g,o+=b)}return a+=t.addLine(s,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),e=n?e+"\n":e},t.getFromCache=function(t,e,n,r){var i=n[t];if(void 0===i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var r=e[n];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],r="";if("string"!=typeof e)return n;for(var i=0;i<e.length;i++){var o=e[i];t.isBreakingSpace(o)||t.isNewline(o)?(""!==r&&(n.push(r),r=""),n.push(o)):r+=o}return""!==r&&n.push(r),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,r,i){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},r=t._canvas,i=t._context;i.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(i.measureText(o).width),a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),u=2*a;a=a*t.BASELINE_MULTIPLIER|0,r.width=s,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,s,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,a);var h=i.getImageData(0,0,s,u).data,c=h.length,l=4*s,f=0,p=0,d=!1;for(f=0;f<a;++f){for(var v=0;v<l;v+=4)if(255!==h[p+v]){d=!0;break}if(d)break;p+=l}for(n.ascent=a-f,p=c-l,d=!1,f=u;f>a;--f){for(v=0;v<l;v+=4)if(255!==h[p+v]){d=!0;break}if(d)break;p-=l}return n.descent=f-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),Mt=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();Mt.width=Mt.height=10,Rt._canvas=Mt,Rt._context=Mt.getContext("2d"),Rt._fonts={},Rt.METRICS_STRING="|ÉqÅ",Rt.BASELINE_SYMBOL="M",Rt.BASELINE_MULTIPLIER=1.4,Rt._newlines=[10,13],Rt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Lt={texture:!0,children:!1,baseTexture:!0},Ut=function(t){function e(e,n,r){var i=this,o=!1;r||(r=document.createElement("canvas"),o=!0),r.width=3,r.height=3;var s=D.r.from(r);return s.orig=new p.j,s.trim=new p.j,(i=t.call(this,s)||this)._ownCanvas=o,i.canvas=r,i.context=i.canvas.getContext("2d"),i._resolution=f.b.RESOLUTION,i._autoResolution=!0,i._text=null,i._style=null,i._styleListener=null,i._font="",i.text=e,i.style=n,i.localStyleID=-1,i}return function(t,e){function n(){this.constructor=t}At(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var n,r,i=this.context,o=Rt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,a=o.height,u=o.lines,h=o.lineHeight,c=o.lineWidths,f=o.maxLineWidth,p=o.fontProperties;this.canvas.width=Math.ceil((Math.max(1,s)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;for(var d=e.dropShadow?2:1,v=0;v<d;++v){var y=e.dropShadow&&0===v,g=y?2*a:0,m=g*this.resolution;if(y){i.fillStyle="black",i.strokeStyle="black";var _=e.dropShadowColor,b=Object(l.l)("number"==typeof _?_:Object(l.A)(_));i.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+e.dropShadowAlpha+")",i.shadowBlur=e.dropShadowBlur,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+m}else i.fillStyle=this._generateFillStyle(e,u,o),i.strokeStyle=e.stroke,i.shadowColor="0",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;for(var w=0;w<u.length;w++)n=e.strokeThickness/2,r=e.strokeThickness/2+w*h+p.ascent,"right"===e.align?n+=f-c[w]:"center"===e.align&&(n+=(f-c[w])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(u[w],n+e.padding,r+e.padding-g,!0),e.fill&&this.drawLetterSpacing(u[w],n+e.padding,r+e.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,n,r){void 0===r&&(r=!1);var i=this._style.letterSpacing;if(0!==i)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,u=0,h=0;h<s.length;++h){var c=s[h];r?this.context.strokeText(c,o,n):this.context.fillText(c,o,n),o+=a-(u=this.context.measureText(t.substring(h+1)).width)+i,a=u}else r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=Object(l.B)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,o=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(t.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(t.height/this._resolution),n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-2*i,n.orig.height=n._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,n){var r,i=t.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];var o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=Math.ceil(this.canvas.width/this._resolution)-o-2*s,u=Math.ceil(this.canvas.height/this._resolution)-o-2*s,h=i.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var l=h.length+1,f=1;f<l;++f)c.push(f/l);if(h.unshift(i[0]),c.unshift(0),h.push(i[i.length-1]),c.push(1),t.fillGradientType===xt.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,s,a/2,u+s);var p=0,d=(n.fontProperties.fontSize+t.strokeThickness)/u;for(f=0;f<e.length;f++)for(var v=n.lineHeight*f,y=0;y<h.length;y++){var g=v/u+("number"==typeof c[y]?c[y]:y/h.length)*d,m=Math.max(p,g);m=Math.min(m,1),r.addColorStop(m,h[y]),p=m}}else{r=this.context.createLinearGradient(s,u/2,a+s,u/2);var _=h.length+1,b=1;for(f=0;f<h.length;f++){var w=void 0;w="number"==typeof c[f]?c[f]:b/_,r.addColorStop(w,h[f]),b++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Lt,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Object(l.z)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Object(l.z)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Pt?t:new Pt(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e}(It);
/*!
 * @pixi/prepare - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
f.b.UPLOADS_PER_FRAME=4;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var kt=function(t,e){return(kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Ft=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function jt(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof D.r){var i=t._textures[r].baseTexture;-1===e.indexOf(i)&&(e.push(i),n=!0)}return n}function Bt(t,e){if(t.baseTexture instanceof D.c){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Vt(t,e){if(t._texture&&t._texture instanceof D.r){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Gt(t,e){return e instanceof Ut&&(e.updateText(!0),!0)}function zt(t,e){if(e instanceof Pt){var n=e.toFontString();return Rt.measureFont(n),!0}return!1}function Ht(t,e){if(t instanceof Ut){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Xt(t,e){return t instanceof Pt&&(-1===e.indexOf(t)&&e.push(t),!0)}var qt=function(){function t(t){var e=this;this.limiter=new Ft(f.b.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Ht),this.registerFindHook(Xt),this.registerFindHook(jt),this.registerFindHook(Bt),this.registerFindHook(Vt),this.registerUploadHook(Gt),this.registerUploadHook(zt)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,x.a.system.addOnce(this.tick,this,x.c.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)x.a.system.addOnce(this.tick,this,x.c.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(n=0,r=i.length;n<r;n++)i[n]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof b)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&x.a.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function Yt(t,e){return e instanceof D.c&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Wt(t,e){if(!(e instanceof bt))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var o=r[i].style.texture;o&&Yt(t,o.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Kt(t,e){return t instanceof bt&&(e.push(t),!0)}var Qt=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(Kt),n.registerUploadHook(Yt),n.registerUploadHook(Wt),n}return function(t,e){function n(){this.constructor=t}kt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(qt),Zt=(function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds}}(),function(){function t(t,e,n){void 0===n&&(n=null),this._texture=t instanceof D.r?t:null,this.baseTexture=t instanceof D.c?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=Object(l.k)(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var n=e,r=t.BATCH_SIZE;n-e<r&&n<this._frameKeys.length;){var i=this._frameKeys[n],o=this._frames[i],s=o.frame;if(s){var a=null,u=null,h=!1!==o.trimmed&&o.sourceSize?o.sourceSize:o.frame,c=new p.j(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a=o.rotated?new p.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new p.j(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==o.trimmed&&o.spriteSourceSize&&(u=new p.j(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[i]=new D.r(this.baseTexture,a,c,u,o.rotated?2:0,o.anchor),D.r.addToCache(this.textures[i],i)}n++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},t.BATCH_SIZE=1e3,t}()),Jt=function(){function t(){}return t.use=function(e,n){var r=e.name+"_image";if(e.data&&e.type===U.c.TYPE.JSON&&e.data.frames&&!this.resources[r]){var i={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},o=t.getResourcePath(e,this.baseUrl);this.add(r,o,i,(function(t){if(t.error)n(t.error);else{var r=new Zt(t.texture,e.data,e.url);r.parse((function(){e.spritesheet=r,e.textures=r.textures,n()}))}}))}else n()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:l.D.resolve(t.url.replace(e,""),t.data.meta.image)},t}(),$t=function(t,e){return($t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function te(t,e){function n(){this.constructor=t}$t(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ee=new p.g,ne=function(t){function e(e,n,r){void 0===n&&(n=100),void 0===r&&(r=100);var i=t.call(this,e)||this;return i.tileTransform=new p.m,i._width=n,i._height=r,i.uvMatrix=e.uvMatrix||new D.s(e),i.pluginName="tilingSprite",i.uvRespectAnchor=!1,i}return te(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new p.j),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,ee);var e=this._width,n=this._height,r=-e*this.anchor._x;if(ee.x>=r&&ee.x<r+e){var i=-n*this.anchor._y;if(ee.y>=i&&ee.y<i+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return"number"==typeof n&&(Object(l.h)("5.3.0","TilingSprite.from use options instead of width and height args"),n={width:n,height:arguments[2]}),new e(D.r.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),e}(It),re="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",ie=new p.d,oe=function(t){function e(e){var n=t.call(this,e)||this,r={globals:n.renderer.globalUniforms};return n.shader=D.p.from(re,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",r),n.simpleShader=D.p.from(re,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",r),n.quad=new D.m,n.state=D.q.for2d(),n}return te(e,t),e.prototype.render=function(t){var e=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=n.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),n.invalidate();var i=t._texture,o=i.baseTexture,s=t.tileTransform.localTransform,a=t.uvMatrix,u=o.isPowerOfTwo&&i.frame.width===o.width&&i.frame.height===o.height;u&&(o._glTextures[e.CONTEXT_UID]?u=o.wrapMode!==k.q.CLAMP:o.wrapMode===k.q.CLAMP&&(o.wrapMode=k.q.REPEAT));var h=u?this.simpleShader:this.shader,c=i.width,f=i.height,p=t._width,d=t._height;ie.set(s.a*c/p,s.b*c/d,s.c*f/p,s.d*f/d,s.tx/p,s.ty/d),ie.invert(),u?ie.prepend(a.mapCoord):(h.uniforms.uMapCoord=a.mapCoord.toArray(!0),h.uniforms.uClampFrame=a.uClampFrame,h.uniforms.uClampOffset=a.uClampOffset),h.uniforms.uTransform=ie.toArray(!0),h.uniforms.uColor=Object(l.v)(t.tint,t.worldAlpha,h.uniforms.uColor,o.alphaMode),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.uSampler=i,e.shader.bind(h),e.geometry.bind(n),this.state.blendMode=Object(l.f)(t.blendMode,o.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(D.k),se=function(t,e){return(se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function ae(t,e){function n(){this.constructor=t}se(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ue=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),he=new p.g,ce=new p.h,le=function(t){function e(e,n,r,i){void 0===i&&(i=k.e.TRIANGLES);var o=t.call(this)||this;return o.geometry=e,e.refCount++,o.shader=n,o.state=r||D.q.for2d(),o.drawMode=i,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=0,o._transformID=-1,o.tint=16777215,o.blendMode=k.b.NORMAL,o._roundPixels=f.b.ROUND_PIXELS,o.batchUvs=null,o}return ae(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===k.e.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var n=this.transform.worldTransform,r=n.a,i=n.b,o=n.c,s=n.d,a=n.tx,u=n.ty,h=this.vertexData,c=0;c<h.length/2;c++){var l=e[2*c],p=e[2*c+1];h[2*c]=r*l+o*p+a,h[2*c+1]=i*l+s*p+u}if(this._roundPixels){var d=f.b.RESOLUTION;for(c=0;c<h.length;++c)h[c]=Math.round((h[c]*d|0)/d)}this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new ue(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,he);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=ce.points,r=this.geometry.getIndex().data,i=r.length,o=4===this.drawMode?3:1,s=0;s+2<i;s+=o){var a=2*r[s],u=2*r[s+1],h=2*r[s+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[u],n[3]=e[u+1],n[4]=e[h],n[5]=e[h+1],ce.contains(he.x,he.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(b),fe=function(t){function e(e,n){var r=this,i={uSampler:e,alpha:1,uTextureMatrix:p.d.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(i,n.uniforms),(r=t.call(this,n.program||D.l.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i)||this)._colorDirty=!1,r.uvMatrix=new D.s(e),r.batchable=void 0===n.program,r.pluginName=n.pluginName,r.tint=n.tint,r.alpha=n.alpha,r}return ae(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;Object(l.v)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(D.p),pe=function(t){function e(e,n,r){var i=t.call(this)||this,o=new D.h(e),s=new D.h(n,!0),a=new D.h(r,!0,!0);return i.addAttribute("aVertexPosition",o,2,!1,k.p.FLOAT).addAttribute("aTextureCoord",s,2,!1,k.p.FLOAT).addIndex(a),i._updateId=-1,i}return ae(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(D.j),de=function(t,e){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var ve=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},ye=[function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[]};for(var r in e){var i=e[r].match(/^[a-z]+/gm)[0],o=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(var a in o){var u=o[a].split("="),h=u[0],c=u[1].replace(/"/gm,""),l=parseFloat(c),f=isNaN(l)?c:l;s[h]=f}n[i].push(s)}var p=new ve;return n.info.forEach((function(t){return p.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return p.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return p.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return p.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return p.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),p},t}(),function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new ve,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),s=t.getElementsByTagName("kerning"),a=0;a<n.length;a++)e.info.push({face:n[a].getAttribute("face"),size:parseInt(n[a].getAttribute("size"),10)});for(a=0;a<r.length;a++)e.common.push({lineHeight:parseInt(r[a].getAttribute("lineHeight"),10)});for(a=0;a<i.length;a++)e.page.push({id:parseInt(i[a].getAttribute("id"),10)||0,file:i[a].getAttribute("file")});for(a=0;a<o.length;a++){var u=o[a];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(a=0;a<s.length;a++)e.kerning.push({first:parseInt(s[a].getAttribute("first"),10),second:parseInt(s[a].getAttribute("second"),10),amount:parseInt(s[a].getAttribute("amount"),10)});return e},t}()];function ge(t){for(var e=0;e<ye.length;e++)if(ye[e].test(t))return ye[e];return null}function me(t,e,n,r,i,o){var s,a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var u=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,c=Math.ceil(t.width/r)-u-2*h,l=Math.ceil(t.height/r)-u-2*h,f=a.slice(),p=n.fillGradientStops.slice();if(!p.length)for(var d=f.length+1,v=1;v<d;++v)p.push(v/d);if(f.unshift(a[0]),p.unshift(0),f.push(a[a.length-1]),p.push(1),n.fillGradientType===xt.LINEAR_VERTICAL){s=e.createLinearGradient(c/2,h,c/2,l+h);var y=0,g=(o.fontProperties.fontSize+n.strokeThickness)/l;for(v=0;v<i.length;v++)for(var m=o.lineHeight*v,_=0;_<f.length;_++){var b=m/l+("number"==typeof p[_]?p[_]:_/f.length)*g,w=Math.max(y,b);w=Math.min(w,1),s.addColorStop(w,f[_]),y=w}}else{s=e.createLinearGradient(h,l/2,c+h,l/2);var x=f.length+1,E=1;for(v=0;v<f.length;v++){var T=void 0;T="number"==typeof p[v]?p[v]:E/x,s.addColorStop(T,f[v]),E++}}return s}function _e(t,e,n,r,i,o,s){var a=n.text,u=n.fontProperties;e.translate(r,i),e.scale(o,o);var h=s.strokeThickness/2,c=-s.strokeThickness/2;e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=me(t,e,s,o,[a],n),e.strokeStyle=s.stroke,e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=me(t,e,s,o,[a],n),e.strokeStyle=s.stroke;var f=s.dropShadowColor,p=Object(l.l)("number"==typeof f?f:Object(l.A)(f));s.dropShadow?(e.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+s.dropShadowAlpha+")",e.shadowBlur=s.dropShadowBlur,e.shadowOffsetX=Math.cos(s.dropShadowAngle)*s.dropShadowDistance,e.shadowOffsetY=Math.sin(s.dropShadowAngle)*s.dropShadowDistance):(e.shadowColor="0",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),s.stroke&&s.strokeThickness&&e.strokeText(a,h,c+n.lineHeight-u.descent),s.fill&&e.fillText(a,h,c+n.lineHeight-u.descent),e.setTransform(),e.fillStyle="rgba(0, 0, 0, 0)"}var be=function(){function t(t,e){var n=t.info[0],r=t.common[0],i=t.page[0],o=Object(l.k)(i.file),s={};this.font=n.face,this.size=n.size,this.lineHeight=r.lineHeight/o,this.chars={},this.pageTextures=s;for(var a=0;a<t.page.length;a++){var u=t.page[a],h=u.id,c=u.file;s[h]=e instanceof Array?e[a]:e[c]}for(a=0;a<t.char.length;a++){var f=t.char[a],d=(h=f.id,f.page),v=t.char[a],y=v.x,g=v.y,m=v.width,_=v.height,b=v.xoffset,w=v.yoffset,x=v.xadvance;y/=o,g/=o,m/=o,_/=o,b/=o,w/=o,x/=o;var E=new p.j(y+s[d].frame.x/o,g+s[d].frame.y/o,m,_);this.chars[h]={xOffset:b,yOffset:w,xAdvance:x,kerning:{},texture:new D.r(s[d].baseTexture,E),page:d}}for(a=0;a<t.kerning.length;a++){var T=t.kerning[a],I=T.first,A=T.second,S=T.amount;I/=o,A/=o,S/=o,this.chars[A]&&(this.chars[A].kerning[I]=S)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,n){var r;if(e instanceof ve)r=e;else{var i=ge(e);if(!i)throw new Error("Unrecognized data format for font.");r=i.parse(e)}n instanceof D.r&&(n=[n]);var o=new t(r,n);return t.available[o.font]=o,o},t.uninstall=function(e){var n=t.available[e];if(!n)throw new Error("No font found named '"+e+"'");n.destroy(),delete t.available[e]},t.from=function(e,n,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},t.defaultOptions,r),o=i.chars,s=i.padding,a=i.resolution,u=i.textureWidth,h=i.textureHeight,c=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var o=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<o)throw new Error("[BitmapFont]: Invalid character range.");for(var a=o,u=s;a<=u;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,i.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(o),l=n instanceof Pt?n:new Pt(n),f=u,p=new ve;p.info[0]={face:l.fontFamily,size:l.fontSize},p.common[0]={lineHeight:l.fontSize};for(var d,v,y,g=0,m=0,_=0,b=[],w=0;w<c.length;w++){d||((d=document.createElement("canvas")).width=u,d.height=h,v=d.getContext("2d"),y=new D.c(d,{resolution:a}),b.push(new D.r(y)),p.page.push({id:b.length-1,file:""}));var x=Rt.measureText(c[w],l,!1,d),E=x.width,T=Math.ceil(x.height),I=Math.ceil(("italic"===l.fontStyle?2:1)*E);if(m>=h-T*a){if(0===m)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+l.fontSize+"px fonts");--w,d=null,v=null,y=null,m=0,g=0,_=0}else if(_=Math.max(T+x.fontProperties.descent,_),I*a+g>=f)--w,m+=_*a,m=Math.ceil(m),g=0,_=0;else{_e(d,v,x,g,m,a,l);var A=x.text.charCodeAt(0);p.char.push({id:A,page:b.length-1,x:g/a,y:m/a,width:I,height:T,xoffset:0,yoffset:0,xadvance:Math.ceil(E-(l.dropShadow?l.dropShadowDistance:0)-(l.stroke?l.strokeThickness:0))}),g+=(I+2*s)*a,g=Math.ceil(g)}}var S=new t(p,b);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=S,S},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),we=[],xe=[],Ee=(function(t){function e(n,r){void 0===r&&(r={});var i=t.call(this)||this;i._tint=16777215,r.font&&(Object(l.h)("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),i._upgradeStyle(r));var o=Object.assign({},e.styleDefaults,r),s=o.align,a=o.tint,u=o.maxWidth,h=o.letterSpacing,c=o.fontName,d=o.fontSize;if(!be.available[c])throw new Error('Missing BitmapFont "'+c+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=s,i._tint=a,i._fontName=c,i._fontSize=d||be.available[c].size,i._text=n,i._maxWidth=u,i._maxLineHeight=0,i._letterSpacing=h,i._anchor=new p.e((function(){i.dirty=!0}),i,0,0),i.roundPixels=f.b.ROUND_PIXELS,i.dirty=!0,i}(function(t,e){function n(){this.constructor=t}de(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.updateText=function(){for(var t,e=be.available[this._fontName],n=this._fontSize/e.size,r=new p.g,i=[],o=[],s=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",a=s.length,u=this._maxWidth*e.size/this._fontSize,h=null,c=0,f=0,d=0,v=-1,y=0,g=0,m=0,_=0;_<a;_++){var b=s.charCodeAt(_),w=s.charAt(_);if(/(?:\s)/.test(w)&&(v=_,y=c),"\r"!==w&&"\n"!==w){var x=e.chars[b];if(x){h&&x.kerning[h]&&(r.x+=x.kerning[h]);var E=xe.pop()||{texture:D.r.EMPTY,line:0,charCode:0,position:new p.g};E.texture=x.texture,E.line=d,E.charCode=b,E.position.x=r.x+x.xOffset+this._letterSpacing/2,E.position.y=r.y+x.yOffset,i.push(E),r.x+=x.xAdvance+this._letterSpacing,c=r.x,m=Math.max(m,x.yOffset+x.texture.height),h=b,-1!==v&&u>0&&r.x>u&&(++g,Object(l.w)(i,1+v-g,1+_-v),_=v,v=-1,o.push(y),f=Math.max(f,y),d++,r.x=0,r.y+=e.lineHeight,h=null)}}else o.push(c),f=Math.max(f,c),++d,++g,r.x=0,r.y+=e.lineHeight,h=null}var T=s.charAt(s.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(c=y),o.push(c),f=Math.max(f,c));var I=[];for(_=0;_<=d;_++){var A=0;"right"===this._align?A=f-o[_]:"center"===this._align&&(A=(f-o[_])/2),I.push(A)}var S=i.length,O={},P=[],C=this._activePagesMeshData;for(_=0;_<C.length;_++)we.push(C[_]);for(_=0;_<S;_++){var N=(U=i[_].texture).baseTexture.uid;if(!O[N]){if(!(z=we.pop())){var R=new pe,M=new fe(D.r.EMPTY);z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new le(R,M),vertices:null,uvs:null,indices:null}}z.index=0,z.indexCount=0,z.vertexCount=0,z.uvsCount=0,z.total=0,z.mesh.texture=new D.r(U.baseTexture),z.mesh.tint=this._tint,P.push(z),O[N]=z}O[N].total++}for(_=0;_<C.length;_++)-1===P.indexOf(C[_])&&this.removeChild(C[_].mesh);for(_=0;_<P.length;_++)P[_].mesh.parent!==this&&this.addChild(P[_].mesh);for(var _ in this._activePagesMeshData=P,O){var L=(z=O[_]).total;(null===(t=z.indices)||void 0===t?void 0:t.length)>6*L&&!(z.vertices.length<2*le.BATCHABLE_SIZE)||(z.vertices=new Float32Array(8*L),z.uvs=new Float32Array(8*L),z.indices=new Uint16Array(6*L)),z.mesh.size=6*L}for(_=0;_<S;_++){var U,k=((w=i[_]).position.x+I[w.line])*n,F=w.position.y*n,j=O[(U=w.texture).baseTexture.uid],B=U.frame,V=U._uvs,G=j.index++;j.indices[6*G+0]=0+4*G,j.indices[6*G+1]=1+4*G,j.indices[6*G+2]=2+4*G,j.indices[6*G+3]=0+4*G,j.indices[6*G+4]=2+4*G,j.indices[6*G+5]=3+4*G,j.vertices[8*G+0]=k,j.vertices[8*G+1]=F,j.vertices[8*G+2]=k+B.width*n,j.vertices[8*G+3]=F,j.vertices[8*G+4]=k+B.width*n,j.vertices[8*G+5]=F+B.height*n,j.vertices[8*G+6]=k,j.vertices[8*G+7]=F+B.height*n,j.uvs[8*G+0]=V.x0,j.uvs[8*G+1]=V.y0,j.uvs[8*G+2]=V.x1,j.uvs[8*G+3]=V.y1,j.uvs[8*G+4]=V.x2,j.uvs[8*G+5]=V.y2,j.uvs[8*G+6]=V.x3,j.uvs[8*G+7]=V.y3}for(var _ in this._textWidth=f*n,this._textHeight=(r.y+e.lineHeight)*n,O){var z=O[_];if(0!==this.anchor.x||0!==this.anchor.y)for(var H=0,X=this._textWidth*this.anchor.x,q=this._textHeight*this.anchor.y,Y=0;Y<z.total;Y++)z.vertices[H++]-=X,z.vertices[H++]-=q,z.vertices[H++]-=X,z.vertices[H++]-=q,z.vertices[H++]-=X,z.vertices[H++]-=q,z.vertices[H++]-=X,z.vertices[H++]-=q;this._maxLineHeight=m*n;var W=z.mesh.geometry.getBuffer("aVertexPosition"),K=z.mesh.geometry.getBuffer("aTextureCoord"),Q=z.mesh.geometry.getIndex();W.data=z.vertices,K.data=z.uvs,Q.data=z.indices,W.update(),K.update(),Q.update()}for(_=0;_<i.length;_++)xe.push(i[_])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!be.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype._upgradeStyle=function(t){if("string"==typeof t.font){var e=t.font.split(" ");t.fontName=1===e.length?e[0]:e.slice(1).join(" "),e.length>=2&&(t.fontSize=parseInt(e[0],10))}else t.fontName=t.font.name,t.fontSize="number"==typeof t.font.size?t.font.size:parseInt(t.font.size,10)},e.registerFont=function(t,e){return Object(l.h)("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),be.install(t,e)},Object.defineProperty(e,"fonts",{get:function(){return Object(l.h)("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),be.available},enumerable:!1,configurable:!0}),e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(b),function(){function t(){}return t.add=function(){U.c.setExtensionXhrType("fnt",U.c.XHR_RESPONSE_TYPE.DOCUMENT)},t.use=function(e,n){var r=ge(e.data);if(r)for(var i=t.getBaseUrl(this,e),o=r.parse(e.data),s={},a=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===o.page.length&&(e.bitmapFont=be.install(o,s),n())},u=0;u<o.page.length;++u){var h=o.page[u].file,c=i+h,l=!1;for(var f in this.resources){var p=this.resources[f];if(p.url===c){p.metadata.pageFile=h,p.texture?a(p):p.onAfterMiddleware.add(a),l=!0;break}}if(!l){var d={crossOrigin:e.crossOrigin,loadType:U.c.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},e.metadata.imageMetadata),parentResource:e};this.add(c,d,a)}}else n()},t.getBaseUrl=function(e,n){var r=n.isDataUrl?"":t.dirname(n.url);return n.isDataUrl&&("."===r&&(r=""),e.baseUrl&&r&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(r+="/")),(r=r.replace(e.baseUrl,""))&&"/"!==r.charAt(r.length-1)&&(r+="/"),r},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}()),Te=function(t,e){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,D.w,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n}(function(t,e){function n(){this.constructor=t}Te(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0})}(D.i);var Ie=function(t,e){return(Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Ae(t,e){function n(){this.constructor=t}Ie(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Se,Oe,Pe,Ce,De,Ne,Re,Me,Le,Ue,ke,Fe,je,Be,Ve,Ge,ze,He={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Xe=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Se||(Se={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Oe||(Oe={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Pe||(Pe={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Ce||(Ce={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(De||(De={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Ne||(Ne={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Re||(Re={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Me||(Me={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Le||(Le={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Ue||(Ue={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(ke||(ke={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Fe||(Fe={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(je||(je={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Be||(Be={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Ve||(Ve={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Ge||(Ge={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(ze||(ze={}));var qe=function(t){function e(e,n,r,i,o){void 0===n&&(n=8),void 0===r&&(r=4),void 0===i&&(i=f.b.RESOLUTION),void 0===o&&(o=5);var s=this,a=function(t,e){var n,r=Math.ceil(t/2),i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",o="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var a=n.replace("%index%",s.toString());o+=a=a.replace("%sampleIndex%",s-(r-1)+".0"),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",t.toString())}(o,e),u=function(t){for(var e,n=He[t],r=n.length,i=Xe,o="",s=0;s<t;s++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s.toString());e=s,s>=r&&(e=t-s-1),o+=a=a.replace("%value%",n[e].toString()),o+="\n"}return i=(i=i.replace("%blur%",o)).replace("%size%",t.toString())}(o);return(s=t.call(this,a,u)||this).horizontal=e,s.resolution=i,s._quality=0,s.quality=r,s.blur=n,s}return Ae(e,t),e.prototype.apply=function(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{var i=t.getFilterTexture(),o=t.renderer,s=e,a=i;this.state.blend=!1,t.applyFilter(this,s,a,je.CLEAR);for(var u=1;u<this.passes-1;u++){t.bindAndClear(s,je.BLIT),this.uniforms.uSampler=a;var h=a;a=s,s=h,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,r),t.returnFilterTexture(i)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(D.i),Ye=(function(t){function e(e,n,r,i){void 0===e&&(e=8),void 0===n&&(n=4),void 0===r&&(r=f.b.RESOLUTION),void 0===i&&(i=5);var o=t.call(this)||this;return o.blurXFilter=new qe(!0,e,n,r,i),o.blurYFilter=new qe(!1,e,n,r,i),o.resolution=r,o.quality=n,o.blur=e,o.repeatEdgePixels=!1,o}Ae(e,t),e.prototype.apply=function(t,e,n,r){var i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(i&&o){var s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,je.CLEAR),this.blurYFilter.apply(t,s,n,r),t.returnFilterTexture(s)}else o?this.blurYFilter.apply(t,e,n,r):this.blurXFilter.apply(t,e,n,r)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0})}(D.i),function(t,e){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)});var We=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,D.v,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}Ye(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),r=Math.sin(t),i=1/3,o=(0,Math.sqrt)(i),s=[n+(1-n)*i,i*(1-n)-o*r,i*(1-n)+o*r,0,0,i*(1-n)+o*r,n+i*(1-n),i*(1-n)-o*r,0,0,i*(1-n)-o*r,i*(1-n)+o*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,r,i){var o=((n=n||16770432)>>16&255)/255,s=(n>>8&255)/255,a=(255&n)/255,u=((r=r||3375104)>>16&255)/255,h=(r>>8&255)/255,c=(255&r)/255,l=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,u,h,c,e=e||.15,0,o-u,s-h,a-c,0,0];this._loadMatrix(l,i)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(D.i);We.prototype.grayscale=We.prototype.greyscale;
/*!
 * @pixi/filter-displacement - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/filter-displacement is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Ke=function(t,e){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){function e(e,n){var r=this,i=new p.d;return e.renderable=!1,(r=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,r.maskMatrix=i,null==n&&(n=20),r.scale=new p.g(n,n),r}(function(t,e){function n(){this.constructor=t}Ke(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.apply=function(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),s=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==s&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/s,this.uniforms.rotation[3]=i.d/s),t.applyFilter(this,e,n,r)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0})}(D.i);var Qe=function(t,e){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}(function(t,e){function n(){this.constructor=t}Qe(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t)}(D.i);var Ze=function(t,e){return(Ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var r=t.call(this,D.v,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return r.noise=e,r.seed=n,r}(function(t,e){function n(){this.constructor=t}Ze(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0})}(D.i);var Je=new p.d;g.prototype._cacheAsBitmap=!1,g.prototype._cacheData=null;var $e=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(g.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new $e),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),g.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},g.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var n=this.getLocalBounds(null,!0).clone();if(this.filters){var r=this.filters[0].padding;n.pad(r)}n.ceil(f.b.RESOLUTION);var i=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),s=t.projection.transform,a=D.n.create({width:n.width,height:n.height}),u="cacheAsBitmap_"+Object(l.C)();this._cacheData.textureCacheId=u,D.c.addToCache(a.baseTexture,u),D.r.addToCache(a,u);var h=this.transform.localTransform.copyTo(Je).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,a,!0,h,!1),t.projection.transform=s,t.renderTexture.bind(i,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var c=new It(a);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-n.x/n.width,c.anchor.y=-n.y/n.height,c.alpha=e,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)}},g.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},g.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var r=t.context,i=t._projTransform;e.ceil(f.b.RESOLUTION);var o=D.n.create({width:e.width,height:e.height}),s="cacheAsBitmap_"+Object(l.C)();this._cacheData.textureCacheId=s,D.c.addToCache(o.baseTexture,s),D.r.addToCache(o,s);var a=Je;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,o,!0,a,!1),t.context=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new It(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-e.x/e.width,u.anchor.y=-e.y/e.height,u.alpha=n,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}},g.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},g.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},g.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,D.c.removeFromCache(this._cacheData.textureCacheId),D.r.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},g.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},
/*!
 * @pixi/mixin-get-child-by-name - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
g.prototype.name=null,b.prototype.getChildByName=function(t,e){for(var n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,r=this.children.length;n<r;n++){if(this.children[n].getChildByName){var i=this.children[n].getChildByName(t,!0);if(i)return i}}return null},
/*!
 * @pixi/mixin-get-global-position - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
g.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new p.g),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};
/*!
 * @pixi/mesh-extras - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/mesh-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var tn=function(t,e){return(tn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function en(t,e){function n(){this.constructor=t}tn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var nn=function(t){function e(e,n,r,i){void 0===e&&(e=100),void 0===n&&(n=100),void 0===r&&(r=10),void 0===i&&(i=10);var o=t.call(this)||this;return o.segWidth=r,o.segHeight=i,o.width=e,o.height=n,o.build(),o}return en(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,o=this.segHeight-1,s=this.width/i,a=this.height/o,u=0;u<t;u++){var h=u%this.segWidth,c=u/this.segWidth|0;e.push(h*s,c*a),n.push(h/i,c/o)}var l=i*o;for(u=0;u<l;u++){var f=u%i,p=u/i|0,d=p*this.segWidth+f,v=p*this.segWidth+f+1,y=(p+1)*this.segWidth+f,g=(p+1)*this.segWidth+f+1;r.push(d,v,y,v,g,y)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(pe),rn=function(t){function e(e,n,r){void 0===e&&(e=200),void 0===r&&(r=0);var i=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return i.points=n,i._width=e,i.textureScale=r,i.build(),i}return en(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var i=n.data,o=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var s=0,a=t[0],u=this._width*this.textureScale,h=t.length,c=0;c<h;c++){var l=4*c;if(this.textureScale>0){var f=a.x-t[c].x,p=a.y-t[c].y,d=Math.sqrt(f*f+p*p);a=t[c],s+=d/u}else s=c/(h-1);i[l]=s,i[l+1]=0,i[l+2]=s,i[l+3]=1}var v=0;for(c=0;c<h-1;c++){l=2*c;o[v++]=l,o[v++]=l+1,o[v++]=l+2,o[v++]=l+2,o[v++]=l+1,o[v++]=l+3}n.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],r=0,i=0,o=this.buffers[0].data,s=t.length,a=0;a<s;a++){var u=t[a],h=4*a;i=-((e=a<t.length-1?t[a+1]:u).x-n.x),r=e.y-n.y;var c=Math.sqrt(r*r+i*i),l=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=c,i/=c,r*=l,i*=l,o[h]=u.x+r,o[h+1]=u.y+i,o[h+2]=u.x-r,o[h+3]=u.y-i,n=u}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(pe),on=function(t){function e(e,n,r){void 0===r&&(r=0);var i=this,o=new rn(e.height,n,r),s=new fe(e);return r>0&&(e.baseTexture.wrapMode=k.q.REPEAT),(i=t.call(this,o,s)||this).autoUpdate=!0,i}return en(e,t),e.prototype._render=function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),t.prototype._render.call(this,e)},e}(le),sn=function(t){function e(e,n,r){var i=this,o=new nn(e.width,e.height,n,r),s=new fe(D.r.WHITE);return(i=t.call(this,o,s)||this).texture=e,i}return en(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e}(le),an=function(t){function e(e,n,r,i,o){void 0===e&&(e=D.r.EMPTY);var s=this,a=new pe(n,r,i);a.getBuffer("aVertexPosition").static=!1;var u=new fe(e);return(s=t.call(this,a,u,null,o)||this).autoUpdate=!0,s}return en(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)},e}(le),un=function(t){function e(e,n,r,i,o){void 0===n&&(n=10),void 0===r&&(r=10),void 0===i&&(i=10),void 0===o&&(o=10);var s=t.call(this,D.r.WHITE,4,4)||this;return s._origWidth=e.orig.width,s._origHeight=e.orig.height,s._width=s._origWidth,s._height=s._origHeight,s._leftWidth=n,s._rightWidth=i,s._topHeight=r,s._bottomHeight=o,s.texture=e,s}return en(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(e,r)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(sn),hn=(n(14),function(t,e){return(hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)});var cn=function(t){function e(e,n){void 0===n&&(n=!0);var r=t.call(this,e[0]instanceof D.r?e[0]:e[0].texture)||this;return r._textures=null,r._durations=null,r._autoUpdate=n,r._isConnectedToTicker=!1,r.animationSpeed=1,r.loop=!0,r.updateAnchor=!1,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r._playing=!1,r._previousFrame=null,r.textures=e,r}return function(t,e){function n(){this.constructor=t}hn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(x.a.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(x.a.shared.add(this.update,this,x.c.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],r=0;r<t.length;++r)n.push(D.r.from(t[r]));return new e(n)},e.fromImages=function(t){for(var n=[],r=0;r<t.length;++r)n.push(D.r.from(t[r]));return new e(n)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof D.r)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(x.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(x.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),e}(It);
/*!
 * pixi.js - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */D.o.registerPlugin("accessibility",w),D.o.registerPlugin("extract",L),D.o.registerPlugin("interaction",C),D.o.registerPlugin("particle",H),D.o.registerPlugin("prepare",Qt),D.o.registerPlugin("batch",D.f),D.o.registerPlugin("tilingSprite",oe),U.b.registerPlugin(Ee),U.b.registerPlugin(Jt),N.registerPlugin(x.b),N.registerPlugin(U.a);var ln=function(t,e){return(ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var fn=function(){function t(t){this.renderer=t,this._foundShapes=[]}return t.prototype.pushMask=function(t){var e=this.renderer,n=t.maskObject||t;e.context.save();var r=this._foundShapes;if(this.recursiveFindShapes(n,r),r.length>0){var i=e.context;i.beginPath();for(var o=0;o<r.length;o++){var s=r[o],a=s.transform.worldTransform;this.renderer.setContextTransform(a),this.renderGraphicsShape(s)}r.length=0,i.clip()}},t.prototype.recursiveFindShapes=function(t,e){t.geometry&&t.geometry.graphicsData&&e.push(t);var n=t.children;if(n)for(var r=0;r<n.length;r++)this.recursiveFindShapes(n[r],e)},t.prototype.renderGraphicsShape=function(t){t.finishPoly();var e=this.renderer.context,n=t.geometry.graphicsData,r=n.length;if(0!==r)for(var i=0;i<r;i++){var o=n[i].shape;if(o.type===p.l.POLY){var s=o.points;e.moveTo(s[0],s[1]);for(var a=1;a<s.length/2;a++)e.lineTo(s[2*a],s[2*a+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&e.closePath()}else if(o.type===p.l.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(o.type===p.l.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(o.type===p.l.ELIP){var u=2*o.width,h=2*o.height,c=o.x-u/2,l=o.y-h/2,f=u/2*.5522848,d=h/2*.5522848,v=c+u,y=l+h,g=c+u/2,m=l+h/2;e.moveTo(c,m),e.bezierCurveTo(c,m-d,g-f,l,g,l),e.bezierCurveTo(g+f,l,v,m-d,v,m),e.bezierCurveTo(v,m+d,g+f,y,g,y),e.bezierCurveTo(g-f,y,c,m+d,c,m),e.closePath()}else if(o.type===p.l.RREC){var _=o.x,b=o.y,w=o.width,x=o.height,E=o.radius,T=Math.min(w,x)/2|0;E=E>T?T:E,e.moveTo(_,b+E),e.lineTo(_,b+x-E),e.quadraticCurveTo(_,b+x,_+E,b+x),e.lineTo(_+w-E,b+x),e.quadraticCurveTo(_+w,b+x,_+w,b+x-E),e.lineTo(_+w,b+E),e.quadraticCurveTo(_+w,b,_+w-E,b),e.lineTo(_+E,b),e.quadraticCurveTo(_,b,_,b+E),e.closePath()}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();function pn(t){var e=document.createElement("canvas");e.width=6,e.height=1;var n=e.getContext("2d");return n.fillStyle=t,n.fillRect(0,0,6,1),e}function dn(){if("undefined"==typeof document)return!1;var t=pn("#ff00ff"),e=pn("#ffff00"),n=document.createElement("canvas");n.width=6,n.height=1;var r=n.getContext("2d");r.globalCompositeOperation="multiply",r.drawImage(t,0,0),r.drawImage(e,2,0);var i=r.getImageData(2,0,1,1);if(!i)return!1;var o=i.data;return 255===o[0]&&0===o[1]&&0===o[2]}var vn=new p.d,yn=function(t){function e(n){var r,i=t.call(this,k.m.CANVAS,n)||this;if(i.rootContext=i.view.getContext("2d",{alpha:i.transparent}),i.context=i.rootContext,i.refresh=!0,i.maskManager=new fn(i),i.smoothProperty="imageSmoothingEnabled",!i.rootContext.imageSmoothingEnabled){var o=i.rootContext;o.webkitImageSmoothingEnabled?i.smoothProperty="webkitImageSmoothingEnabled":o.mozImageSmoothingEnabled?i.smoothProperty="mozImageSmoothingEnabled":o.oImageSmoothingEnabled?i.smoothProperty="oImageSmoothingEnabled":o.msImageSmoothingEnabled&&(i.smoothProperty="msImageSmoothingEnabled")}return i.initPlugins(e.__plugins),i.blendModes=(void 0===r&&(r=[]),dn()?(r[k.b.NORMAL]="source-over",r[k.b.ADD]="lighter",r[k.b.MULTIPLY]="multiply",r[k.b.SCREEN]="screen",r[k.b.OVERLAY]="overlay",r[k.b.DARKEN]="darken",r[k.b.LIGHTEN]="lighten",r[k.b.COLOR_DODGE]="color-dodge",r[k.b.COLOR_BURN]="color-burn",r[k.b.HARD_LIGHT]="hard-light",r[k.b.SOFT_LIGHT]="soft-light",r[k.b.DIFFERENCE]="difference",r[k.b.EXCLUSION]="exclusion",r[k.b.HUE]="hue",r[k.b.SATURATION]="saturate",r[k.b.COLOR]="color",r[k.b.LUMINOSITY]="luminosity"):(r[k.b.NORMAL]="source-over",r[k.b.ADD]="lighter",r[k.b.MULTIPLY]="source-over",r[k.b.SCREEN]="source-over",r[k.b.OVERLAY]="source-over",r[k.b.DARKEN]="source-over",r[k.b.LIGHTEN]="source-over",r[k.b.COLOR_DODGE]="source-over",r[k.b.COLOR_BURN]="source-over",r[k.b.HARD_LIGHT]="source-over",r[k.b.SOFT_LIGHT]="source-over",r[k.b.DIFFERENCE]="source-over",r[k.b.EXCLUSION]="source-over",r[k.b.HUE]="source-over",r[k.b.SATURATION]="source-over",r[k.b.COLOR]="source-over",r[k.b.LUMINOSITY]="source-over"),r[k.b.NORMAL_NPM]=r[k.b.NORMAL],r[k.b.ADD_NPM]=r[k.b.ADD],r[k.b.SCREEN_NPM]=r[k.b.SCREEN],r[k.b.SRC_IN]="source-in",r[k.b.SRC_OUT]="source-out",r[k.b.SRC_ATOP]="source-atop",r[k.b.DST_OVER]="destination-over",r[k.b.DST_IN]="destination-in",r[k.b.DST_OUT]="destination-out",r[k.b.DST_ATOP]="destination-atop",r[k.b.XOR]="xor",r[k.b.SUBTRACT]="source-over",r),i._activeBlendMode=null,i._outerBlend=!1,i._projTransform=null,i.renderingToScreen=!1,Object(l.y)("Canvas"),i.resize(i.options.width,i.options.height),i}return function(t,e){function n(){this.constructor=t}ln(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.render=function(t,e,n,r,i){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var o=this.resolution;e?((e=e.castToBaseTexture())._canvasRenderTarget||(e._canvasRenderTarget=new l.b(e.width,e.height,e.resolution),e.resource=new D.x.CanvasResource(e._canvasRenderTarget.canvas),e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var s=this.context;if(this._projTransform=r||null,e||(this._lastObjectRendered=t),!i){var a=t.enableTempParent();t.updateTransform(),t.disableTempParent(a)}if(s.save(),s.setTransform(1,0,0,1,0,0),s.globalAlpha=1,this._activeBlendMode=k.b.NORMAL,this._outerBlend=!1,s.globalCompositeOperation=this.blendModes[k.b.NORMAL],void 0!==n?n:this.clearBeforeRender)if(this.renderingToScreen)this.transparent?s.clearRect(0,0,this.width,this.height):(s.fillStyle=this._backgroundColorString,s.fillRect(0,0,this.width,this.height));else{(e=e)._canvasRenderTarget.clear();var u=e.clearColor;u[3]>0&&(s.fillStyle=Object(l.m)(Object(l.x)(u)),s.fillRect(0,0,e.realWidth,e.realHeight))}var h=this.context;this.context=s,t.renderCanvas(this),this.context=h,s.restore(),this.resolution=o,this._projTransform=null,this.emit("postrender")}},e.prototype.setContextTransform=function(t,e,n){var r=t,i=this._projTransform,o=this.resolution;n=n||o,i&&((r=vn).copyFrom(t),r.prepend(i)),e?this.context.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*o|0,r.ty*o|0):this.context.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*o,r.ty*o)},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t,e){var n=t===k.b.SRC_IN||t===k.b.SRC_OUT||t===k.b.DST_IN||t===k.b.DST_ATOP;!e&&n&&(t=k.b.NORMAL),this._activeBlendMode!==t&&(this._activeBlendMode=t,this._outerBlend=n,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.smoothProperty&&(this.rootContext[this.smoothProperty]=f.b.SCALE_MODE===k.n.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(D.a),gn={canvas:null,getTintedCanvas:function(t,e){var n=t.texture,r="#"+("00000"+(0|(e=gn.roundColor(e))).toString(16)).substr(-6);n.tintCache=n.tintCache||{};var i,o=n.tintCache[r];if(o){if(o.tintId===n._updateID)return n.tintCache[r];i=n.tintCache[r]}else i=document.createElement("canvas");if(gn.tintMethod(n,e,i),i.tintId=n._updateID,gn.convertTintToImage){var s=new Image;s.src=i.toDataURL(),n.tintCache[r]=s}else n.tintCache[r]=i;return i},getTintedPattern:function(t,e){var n="#"+("00000"+(0|(e=gn.roundColor(e))).toString(16)).substr(-6);t.patternCache=t.patternCache||{};var r=t.patternCache[n];return r&&r.tintId===t._updateID||(gn.canvas||(gn.canvas=document.createElement("canvas")),gn.tintMethod(t,e,gn.canvas),(r=gn.canvas.getContext("2d").createPattern(gn.canvas,"repeat")).tintId=t._updateID,t.patternCache[n]=r),r},tintWithMultiply:function(t,e,n){var r=n.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply";var s=t.baseTexture.getDrawableSource();r.drawImage(s,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(s,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore()},tintWithOverlay:function(t,e,n){var r=n.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.globalCompositeOperation="copy",r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore()},tintWithPerPixel:function(t,e,n){var r=n.getContext("2d"),i=t._frame.clone(),o=t.baseTexture.resolution;i.x*=o,i.y*=o,i.width*=o,i.height*=o,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore();for(var s=Object(l.l)(e),a=s[0],u=s[1],h=s[2],c=r.getImageData(0,0,i.width,i.height),f=c.data,p=0;p<f.length;p+=4)f[p+0]*=a,f[p+1]*=u,f[p+2]*=h;r.putImageData(c,0,0)},roundColor:function(t){var e=gn.cacheStepsPerColorChannel,n=Object(l.l)(t);return n[0]=Math.min(255,n[0]/e*e),n[1]=Math.min(255,n[1]/e*e),n[2]=Math.min(255,n[2]/e*e),Object(l.x)(n)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:dn(),tintMethod:null};gn.tintMethod=gn.canUseMultiply?gn.tintWithMultiply:gn.tintWithPerPixel;var mn=D.o.create;D.o.create=function(t){if(!(t&&t.forceCanvas))try{return mn(t)}catch(t){}return new yn(t)},D.c.prototype.getDrawableSource=function(){var t=this.resource;return t?t.bitmap||t.source:null},D.b.prototype._canvasRenderTarget=null,D.r.prototype.patternCache=null,D.r.prototype.tintCache=null;
/*!
 * @pixi/canvas-mesh - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var _n=function(){function t(t){this.renderer=t}return t.prototype.render=function(t){var e=this.renderer,n=t.worldTransform;e.context.globalAlpha=t.worldAlpha,e.setBlendMode(t.blendMode),e.setContextTransform(n,t.roundPixels),t.drawMode!==k.e.TRIANGLES?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.geometry.buffers[0].data.length,n=0;n<e-2;n++){var r=2*n;this._renderDrawTriangle(t,r,r+2,r+4)}},t.prototype._renderTriangles=function(t){for(var e=t.geometry.getIndex().data,n=e.length,r=0;r<n;r+=3){var i=2*e[r],o=2*e[r+1],s=2*e[r+2];this._renderDrawTriangle(t,i,o,s)}},t.prototype._renderDrawTriangle=function(t,e,n,r){var i=this.renderer.context,o=t.geometry.buffers[0].data,s=t.uvs,a=t.texture;if(a.valid){var u=16777215!==t.tint,h=a.baseTexture,c=h.width,l=h.height;u&&t._cachedTint!==t.tint&&(t._cachedTint=t.tint,t._tintedCanvas=gn.getTintedCanvas(t,t.tint));var f=u?t._tintedCanvas:h.getDrawableSource(),p=s[e]*h.width,d=s[n]*h.width,v=s[r]*h.width,y=s[e+1]*h.height,g=s[n+1]*h.height,m=s[r+1]*h.height,_=o[e],b=o[n],w=o[r],x=o[e+1],E=o[n+1],T=o[r+1],I=t.canvasPadding/this.renderer.resolution;if(I>0){var A=I/Math.abs(t.worldTransform.a),S=I/Math.abs(t.worldTransform.d),O=(_+b+w)/3,P=(x+E+T)/3,C=_-O,D=x-P,N=Math.sqrt(C*C+D*D);_=O+C/N*(N+A),x=P+D/N*(N+S),D=E-P,b=O+(C=b-O)/(N=Math.sqrt(C*C+D*D))*(N+A),E=P+D/N*(N+S),D=T-P,w=O+(C=w-O)/(N=Math.sqrt(C*C+D*D))*(N+A),T=P+D/N*(N+S)}i.save(),i.beginPath(),i.moveTo(_,x),i.lineTo(b,E),i.lineTo(w,T),i.closePath(),i.clip();var R=p*g+y*v+d*m-g*v-y*d-p*m,M=_*g+y*w+b*m-g*w-y*b-_*m,L=p*b+_*v+d*w-b*v-_*d-p*w,U=p*g*w+y*b*v+_*d*m-_*g*v-y*d*w-p*b*m,k=x*g+y*T+E*m-g*T-y*E-x*m,F=p*E+x*v+d*T-E*v-x*d-p*T,j=p*g*T+y*E*v+x*d*m-x*g*v-y*d*T-p*E*m;i.transform(M/R,k/R,L/R,F/R,U/R,j/R),i.drawImage(f,0,0,c*h.resolution,l*h.resolution,0,0,c,l),i.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,n=t.geometry.getBuffer("aVertexPosition").data,r=n.length/2;e.beginPath();for(var i=1;i<r-2;++i){var o=2*i,s=n[o],a=n[o+1],u=n[o+2],h=n[o+3],c=n[o+4],l=n[o+5];e.moveTo(s,a),e.lineTo(u,h),e.lineTo(c,l)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();f.b.MESH_CANVAS_PADDING=0,fe.prototype._renderCanvas=function(t,e){t.plugins.mesh.render(e)},un.prototype._cachedTint=16777215,un.prototype._tintedCanvas=null,un.prototype._canvasUvs=null,un.prototype._renderCanvas=function(t){var e=t.context,n=this.worldTransform,r=16777215!==this.tint,i=this.texture;if(i.valid){r&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=gn.getTintedCanvas(this,this.tint));var o=r?this._tintedCanvas:i.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var s=this.vertices,a=this._canvasUvs,u=r?0:i.frame.x,h=r?0:i.frame.y,c=u+i.frame.width,l=h+i.frame.height;a[0]=u,a[1]=u+this._leftWidth,a[2]=c-this._rightWidth,a[3]=c,a[4]=h,a[5]=h+this._topHeight,a[6]=l-this._bottomHeight,a[7]=l;for(var f=0;f<8;f++)a[f]*=i.baseTexture.resolution;e.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.setContextTransform(n,this.roundPixels);for(var p=0;p<3;p++)for(var d=0;d<3;d++){var v=2*d+8*p,y=Math.max(1,a[d+1]-a[d]),g=Math.max(1,a[p+5]-a[p+4]),m=Math.max(1,s[v+10]-s[v]),_=Math.max(1,s[v+11]-s[v+1]);e.drawImage(o,a[d],a[p+4],y,g,s[v],s[v+1],m,_)}}};var bn=!1;le.prototype._cachedTint=16777215,le.prototype._tintedCanvas=null,le.prototype._renderCanvas=function(t){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(t,this):bn||(bn=!0,window.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},le.prototype._canvasPadding=null,Object.defineProperty(le.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:f.b.MESH_CANVAS_PADDING},set:function(t){this._canvasPadding=t}}),an.prototype._renderCanvas=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)},on.prototype._renderCanvas=function(t){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)};
/*!
 * @pixi/canvas-graphics - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var wn,xn=function(){function t(t){this.renderer=t,this._svgMatrix=null,this._tempMatrix=new p.d}return t.prototype._calcCanvasStyle=function(t,e){var n;return t.texture?t.texture.valid?(n=gn.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||p.d.IDENTITY)):n="#808080":n="#"+("00000"+(0|e).toString(16)).substr(-6),n},t.prototype.render=function(t){var e=this.renderer,n=e.context,r=t.worldAlpha,i=t.transform.worldTransform;e.setContextTransform(i),e.setBlendMode(t.blendMode);for(var o,s,a=t.geometry.graphicsData,u=(t.tint>>16&255)/255,h=(t.tint>>8&255)/255,c=(255&t.tint)/255,l=0;l<a.length;l++){var f=a[l],d=f.shape,v=f.fillStyle,y=f.lineStyle,g=0|f.fillStyle.color,m=0|f.lineStyle.color;if(f.matrix&&e.setContextTransform(i.copyTo(this._tempMatrix).append(f.matrix)),v.visible){var _=((g>>16&255)/255*u*255<<16)+((g>>8&255)/255*h*255<<8)+(255&g)/255*c*255;o=this._calcCanvasStyle(v,_)}if(y.visible){var b=((m>>16&255)/255*u*255<<16)+((m>>8&255)/255*h*255<<8)+(255&m)/255*c*255;s=this._calcCanvasStyle(y,b)}if(n.lineWidth=y.width,n.lineCap=y.cap,n.lineJoin=y.join,n.miterLimit=y.miterLimit,f.type===p.l.POLY){n.beginPath();var w=(P=d).points,x=f.holes,E=void 0,T=void 0,I=void 0,A=void 0;n.moveTo(w[0],w[1]);for(var S=2;S<w.length;S+=2)n.lineTo(w[S],w[S+1]);if(P.closeStroke&&n.closePath(),x.length>0){E=0,I=w[0],A=w[1];for(S=2;S+2<w.length;S+=2)E+=(w[S]-I)*(w[S+3]-A)-(w[S+2]-I)*(w[S+1]-A);for(var O=0;O<x.length;O++)if(w=x[O].shape.points){T=0,I=w[0],A=w[1];for(S=2;S+2<w.length;S+=2)T+=(w[S]-I)*(w[S+3]-A)-(w[S+2]-I)*(w[S+1]-A);if(T*E<0){n.moveTo(w[0],w[1]);for(S=2;S<w.length;S+=2)n.lineTo(w[S],w[S+1])}else{n.moveTo(w[w.length-2],w[w.length-1]);for(S=w.length-4;S>=0;S-=2)n.lineTo(w[S],w[S+1])}x[O].shape.closeStroke&&n.closePath()}}v.visible&&(n.globalAlpha=v.alpha*r,n.fillStyle=o,n.fill()),y.visible&&(n.globalAlpha=y.alpha*r,n.strokeStyle=s,n.stroke())}else if(f.type===p.l.RECT){var P=d;v.visible&&(n.globalAlpha=v.alpha*r,n.fillStyle=o,n.fillRect(P.x,P.y,P.width,P.height)),y.visible&&(n.globalAlpha=y.alpha*r,n.strokeStyle=s,n.strokeRect(P.x,P.y,P.width,P.height))}else if(f.type===p.l.CIRC){P=d;n.beginPath(),n.arc(P.x,P.y,P.radius,0,2*Math.PI),n.closePath(),v.visible&&(n.globalAlpha=v.alpha*r,n.fillStyle=o,n.fill()),y.visible&&(n.globalAlpha=y.alpha*r,n.strokeStyle=s,n.stroke())}else if(f.type===p.l.ELIP){var C=2*(P=d).width,D=2*P.height,N=P.x-C/2,R=P.y-D/2;n.beginPath();var M=C/2*.5522848,L=D/2*.5522848,U=N+C,k=R+D,F=N+C/2,j=R+D/2;n.moveTo(N,j),n.bezierCurveTo(N,j-L,F-M,R,F,R),n.bezierCurveTo(F+M,R,U,j-L,U,j),n.bezierCurveTo(U,j+L,F+M,k,F,k),n.bezierCurveTo(F-M,k,N,j+L,N,j),n.closePath(),v.visible&&(n.globalAlpha=v.alpha*r,n.fillStyle=o,n.fill()),y.visible&&(n.globalAlpha=y.alpha*r,n.strokeStyle=s,n.stroke())}else if(f.type===p.l.RREC){var B=(P=d).x,V=P.y,G=P.width,z=P.height,H=P.radius,X=Math.min(G,z)/2|0;H=H>X?X:H,n.beginPath(),n.moveTo(B,V+H),n.lineTo(B,V+z-H),n.quadraticCurveTo(B,V+z,B+H,V+z),n.lineTo(B+G-H,V+z),n.quadraticCurveTo(B+G,V+z,B+G,V+z-H),n.lineTo(B+G,V+H),n.quadraticCurveTo(B+G,V,B+G-H,V),n.lineTo(B+H,V),n.quadraticCurveTo(B,V,B,V+H),n.closePath(),v.visible&&(n.globalAlpha=v.alpha*r,n.fillStyle=o,n.fill()),y.visible&&(n.globalAlpha=y.alpha*r,n.strokeStyle=s,n.stroke())}}},t.prototype.setPatternTransform=function(t,e){if(!1!==this._svgMatrix){if(!this._svgMatrix){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n&&n.createSVGMatrix&&(this._svgMatrix=n.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},t.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},t}(),En=new p.d;bt.prototype.generateCanvasTexture=function(t,e){void 0===e&&(e=1);var n=this.getLocalBounds(),r=D.n.create({width:n.width,height:n.height,scaleMode:t,resolution:e});wn||(wn=new yn),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(En),En.invert(),En.tx-=n.x,En.ty-=n.y,wn.render(this,r,!0,En);var i=D.r.from(r.baseTexture._canvasRenderTarget.canvas,{scaleMode:t});return i.baseTexture.setResolution(e),i},bt.prototype.cachedGraphicsData=[],bt.prototype._renderCanvas=function(t){!0!==this.isMask&&(this.finishPoly(),t.plugins.graphics.render(this))};
/*!
 * @pixi/canvas-sprite - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Tn=new p.d,In=function(){function t(t){this.renderer=t}return t.prototype.render=function(t){var e=t._texture,n=this.renderer,r=n.context,i=e._frame.width,o=e._frame.height,s=t.transform.worldTransform,a=0,u=0,h=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&h&&e.valid){n.setBlendMode(t.blendMode,!0),n.context.globalAlpha=t.worldAlpha;var c=e.baseTexture.scaleMode===k.n.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==c&&(r[n.smoothProperty]=c),e.trim?(a=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,u=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(a=(.5-t.anchor.x)*e.orig.width,u=(.5-t.anchor.y)*e.orig.height),e.rotate&&(s.copyTo(Tn),s=Tn,p.n.matrixAppendRotationInv(s,e.rotate,a,u),a=0,u=0),a-=i/2,u-=o/2,n.setContextTransform(s,t.roundPixels,1),t.roundPixels&&(a|=0,u|=0);var l=e.baseTexture.resolution,f=n._outerBlend;f&&(r.save(),r.beginPath(),r.rect(a*n.resolution,u*n.resolution,i*n.resolution,o*n.resolution),r.clip()),16777215!==t.tint?(t._cachedTint===t.tint&&t._tintedCanvas.tintId===t._texture._updateID||(t._cachedTint=t.tint,t._tintedCanvas=gn.getTintedCanvas(t,t.tint)),r.drawImage(t._tintedCanvas,0,0,Math.floor(i*l),Math.floor(o*l),Math.floor(a*n.resolution),Math.floor(u*n.resolution),Math.floor(i*n.resolution),Math.floor(o*n.resolution))):r.drawImage(h,e._frame.x*l,e._frame.y*l,Math.floor(i*l),Math.floor(o*l),Math.floor(a*n.resolution),Math.floor(u*n.resolution),Math.floor(i*n.resolution),Math.floor(o*n.resolution)),f&&r.restore(),n.setBlendMode(k.b.NORMAL)}},t.prototype.destroy=function(){this.renderer=null},t}();It.prototype._tintedCanvas=null,It.prototype._renderCanvas=function(t){t.plugins.sprite.render(this)};
/*!
 * @pixi/canvas-extract - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var An=new p.j,Sn=function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(t){var e,n,r,i,o=this.renderer;t&&(i=t instanceof D.n?t:o.generateTexture(t)),i?(e=i.baseTexture._canvasRenderTarget.context,n=i.baseTexture._canvasRenderTarget.resolution,r=i.frame):(e=o.rootContext,n=o.resolution,(r=An).width=this.renderer.width,r.height=this.renderer.height);var s=Math.floor(r.width*n+1e-4),a=Math.floor(r.height*n+1e-4),u=new l.b(s,a,1),h=e.getImageData(r.x*n,r.y*n,s,a);return u.context.putImageData(h,0,0),u.canvas},t.prototype.pixels=function(t){var e,n,r,i,o=this.renderer;return t&&(i=t instanceof D.n?t:o.generateTexture(t)),i?(e=i.baseTexture._canvasRenderTarget.context,n=i.baseTexture._canvasRenderTarget.resolution,r=i.frame):(e=o.rootContext,(r=An).width=o.width,r.height=o.height),e.getImageData(0,0,r.width*n,r.height*n).data},t.prototype.destroy=function(){this.renderer=null},t}();Object.defineProperty(yn.prototype,"extract",{get:function(){return Object(l.h)("v5.3.0","CanvasRenderer#extract is deprecated, use CanvasRenderer#plugins.extract"),this.plugins.extract}});
/*!
 * @pixi/canvas-prepare - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-prepare is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var On=function(t,e){return(On=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Pn(t,e){var n=t;if(e instanceof D.c){var r=e.source,i=0===r.width?n.canvas.width:Math.min(n.canvas.width,r.width),o=0===r.height?n.canvas.height:Math.min(n.canvas.height,r.height);return n.ctx.drawImage(r,0,0,i,o,0,0,n.canvas.width,n.canvas.height),!0}return!1}var Cn=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=16,n.canvas.height=16,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(Pn),n}return function(t,e){function n(){this.constructor=t}On(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(qt);
/*!
 * @pixi/canvas-sprite-tiling - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ne.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.valid){var n=t.context,r=this.worldTransform,i=e.baseTexture,o=i.getDrawableSource(),s=i.resolution,a=this.tilePosition.x/this.tileScale.x%e._frame.width*s,u=this.tilePosition.y/this.tileScale.y%e._frame.height*s;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var h=new l.b(e._frame.width,e._frame.height,s);16777215!==this.tint?(this._tintedCanvas=gn.getTintedCanvas(this,this.tint),h.context.drawImage(this._tintedCanvas,0,0)):h.context.drawImage(o,-e._frame.x*s,-e._frame.y*s),this._cachedTint=this.tint,this._canvasPattern=h.context.createPattern(h.canvas,"repeat")}n.globalAlpha=this.worldAlpha,t.setBlendMode(this.blendMode),t.setContextTransform(r),n.fillStyle=this._canvasPattern,n.scale(this.tileScale.x/s,this.tileScale.y/s);var c=this.anchor.x*-this._width,f=this.anchor.y*-this._height;this.uvRespectAnchor?(n.translate(a,u),n.fillRect(-a+c,-u+f,this._width/this.tileScale.x*s,this._height/this.tileScale.y*s)):(n.translate(a+c,u+f),n.fillRect(-a,-u,this._width/this.tileScale.x*s,this._height/this.tileScale.y*s))}},
/*!
 * @pixi/canvas-particles - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
G.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,n=this.worldTransform,r=!0,i=0,o=0,s=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var u=0;u<this.children.length;++u){var h=this.children[u];if(h.visible&&h._texture.valid){var c=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)r&&(t.setContextTransform(n,!1,1),r=!1),i=h.anchor.x*(-c.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-c.height*h.scale.y)+h.position.y+.5,s=c.width*h.scale.x,a=c.height*h.scale.y;else{r||(r=!0),h.displayObjectUpdateTransform();var l=h.worldTransform;t.setContextTransform(l,this.roundPixels,1),i=h.anchor.x*-c.width+.5,o=h.anchor.y*-c.height+.5,s=c.width,a=c.height}var f=h._texture.baseTexture.resolution;e.drawImage(h._texture.baseTexture.getDrawableSource(),c.x*f,c.y*f,c.width*f,c.height*f,i*t.resolution,o*t.resolution,s*t.resolution,a*t.resolution)}}}},
/*!
 * @pixi/canvas-display - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
b.prototype._renderCanvas=function(t){},b.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},g.prototype.renderCanvas=function(t){},
/*!
 * @pixi/canvas-text - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/canvas-text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Ut.prototype._renderCanvas=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),It.prototype._renderCanvas.call(this,t)},
/*!
 * pixi.js-legacy - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * pixi.js-legacy is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
yn.registerPlugin("accessibility",w),yn.registerPlugin("extract",Sn),yn.registerPlugin("graphics",xn),yn.registerPlugin("interaction",C),yn.registerPlugin("mesh",_n),yn.registerPlugin("prepare",Cn),yn.registerPlugin("sprite",In)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r}));var r,i=n(4);
/*!
 * @pixi/ticker - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */i.b.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(r||(r={}));var o=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=n,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),s=function(){function t(){var t=this;this._head=new o(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/i.b.TARGET_FPMS,this.elapsedMS=1/i.b.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=r.NORMAL),this._addListener(new o(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=r.NORMAL),this._addListener(new o(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*i.b.TARGET_FPMS;for(var r=this._head,o=r.next;o;)o=o.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,i.b.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),a=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,r.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?s.shared:new s,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}()},,function(t,e,n){"use strict";n.d(e,"a",(function(){return P})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return I}));var r=n(41),i=n.n(r),o=n(20),s=n.n(o);
/*!
 * resource-loader - v3.0.1
 * https://github.com/pixijs/pixi-sound
 * Compiled Tue, 02 Jul 2019 14:06:18 UTC
 *
 * resource-loader is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
function a(){}function u(t,e,n,r){var i=0,o=t.length;!function s(a){a||i===o?n&&n(a):r?setTimeout((function(){e(t[i++],s)}),1):e(t[i++],s)}()}function h(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function c(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var n=0,r={_tasks:[],concurrency:e,saturated:a,unsaturated:a,buffer:e/4,empty:a,drain:a,error:a,started:!1,paused:!1,push:function(t,e){i(t,!1,e)},kill:function(){n=0,r.drain=a,r.started=!1,r._tasks=[]},unshift:function(t,e){i(t,!0,e)},process:function(){for(;!r.paused&&n<r.concurrency&&r._tasks.length;){var e=r._tasks.shift();0===r._tasks.length&&r.empty(),(n+=1)===r.concurrency&&r.saturated(),t(e.data,h(o(e)))}},length:function(){return r._tasks.length},running:function(){return n},idle:function(){return r._tasks.length+n===0},pause:function(){!0!==r.paused&&(r.paused=!0)},resume:function(){if(!1!==r.paused){r.paused=!1;for(var t=1;t<=r.concurrency;t++)r.process()}}};function i(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout((function(){return r.drain()}),1);else{var i={data:t,callback:"function"==typeof n?n:a};e?r._tasks.unshift(i):r._tasks.push(i),setTimeout((function(){return r.process()}),1)}}function o(t){return function(){n-=1,t.callback.apply(t,arguments),null!=arguments[0]&&r.error(arguments[0],t.data),n<=r.concurrency-r.buffer&&r.unsaturated(),r.idle()&&r.drain(),r.process()}}return r}var l={};function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}var d=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),v=null;function y(){}var g=function(){function t(e,n,r){if("string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=y,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new s.a,this.onProgress=new s.a,this.onComplete=new s.a,this.onAfterMiddleware=new s.a}t.setExtensionLoadType=function(e,n){m(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){m(t._xhrTypeMap,e,n)};var e=t.prototype;return e.complete=function(){this._clearEvents(),this._finish()},e.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},e.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:d&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e._hasFlag=function(t){return 0!=(this._flags&t)},e._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},e._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},e._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},e._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},e._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},e._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},e._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=n,r},e._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e._onTimeout=function(){this.abort("Load timed out.")},e._xhrOnError=function(){var t=this.xhr;this.abort(_(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e._xhrOnTimeout=function(){var t=this.xhr;this.abort(_(t)+" Request timed out.")},e._xhrOnAbort=function(){var t=this.xhr;this.abort(_(t)+" Request was aborted by the user.")},e._xhrOnLoad=function(){var e=this.xhr,n="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===r&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(n,"text/xml")}else{var o=document.createElement("div");o.innerHTML=n,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},e._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,v||(v=document.createElement("a")),v.href=t;var n=!(t=i()(v.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&n&&r===e.protocol?"":"anonymous"},e._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},e._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},e._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var r=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(r>-1?r:t.length,i>-1?i:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},e._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},p(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function m(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function _(t){return t.toString().replace("object ","")}g.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},g.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},g.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},g.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},g._loadTypeMap={gif:g.LOAD_TYPE.IMAGE,png:g.LOAD_TYPE.IMAGE,bmp:g.LOAD_TYPE.IMAGE,jpg:g.LOAD_TYPE.IMAGE,jpeg:g.LOAD_TYPE.IMAGE,tif:g.LOAD_TYPE.IMAGE,tiff:g.LOAD_TYPE.IMAGE,webp:g.LOAD_TYPE.IMAGE,tga:g.LOAD_TYPE.IMAGE,svg:g.LOAD_TYPE.IMAGE,"svg+xml":g.LOAD_TYPE.IMAGE,mp3:g.LOAD_TYPE.AUDIO,ogg:g.LOAD_TYPE.AUDIO,wav:g.LOAD_TYPE.AUDIO,mp4:g.LOAD_TYPE.VIDEO,webm:g.LOAD_TYPE.VIDEO},g._xhrTypeMap={xhtml:g.XHR_RESPONSE_TYPE.DOCUMENT,html:g.XHR_RESPONSE_TYPE.DOCUMENT,htm:g.XHR_RESPONSE_TYPE.DOCUMENT,xml:g.XHR_RESPONSE_TYPE.DOCUMENT,tmx:g.XHR_RESPONSE_TYPE.DOCUMENT,svg:g.XHR_RESPONSE_TYPE.DOCUMENT,tsx:g.XHR_RESPONSE_TYPE.DOCUMENT,gif:g.XHR_RESPONSE_TYPE.BLOB,png:g.XHR_RESPONSE_TYPE.BLOB,bmp:g.XHR_RESPONSE_TYPE.BLOB,jpg:g.XHR_RESPONSE_TYPE.BLOB,jpeg:g.XHR_RESPONSE_TYPE.BLOB,tif:g.XHR_RESPONSE_TYPE.BLOB,tiff:g.XHR_RESPONSE_TYPE.BLOB,webp:g.XHR_RESPONSE_TYPE.BLOB,tga:g.XHR_RESPONSE_TYPE.BLOB,json:g.XHR_RESPONSE_TYPE.JSON,text:g.XHR_RESPONSE_TYPE.TEXT,txt:g.XHR_RESPONSE_TYPE.TEXT,ttf:g.XHR_RESPONSE_TYPE.BUFFER,otf:g.XHR_RESPONSE_TYPE.BUFFER},g.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var b=window.URL||window.webkitURL;var w={caching:function(t,e){var n=this;l[t.url]?(t.data=l[t.url],t.complete()):t.onComplete.once((function(){return l[n.url]=n.data})),e()},parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===g.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=b.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=n,t.type=g.TYPE.IMAGE,void(t.data.onload=function(){b.revokeObjectURL(n),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var r=[0,0,0],i=[0,0,0,0],o=0;o<r.length;++o)n<t.length?r[o]=255&t.charCodeAt(n++):r[o]=0;switch(i[0]=r[0]>>2,i[1]=(3&r[0])<<4|r[1]>>4,i[2]=(15&r[1])<<2|r[2]>>6,i[3]=63&r[2],n-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(var s=0;s<i.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i[s])}return e}(t.xhr.responseText),t.type=g.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},x=/(#[\w-]+)?$/,E=function(){function t(e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n=10),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return r._loadResource(t,e)},this._queue=c(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new s.a,this.onError=new s.a,this.onLoad=new s.a,this.onStart=new s.a,this.onComplete=new s.a;for(var i=0;i<t._defaultBeforeMiddleware.length;++i)this.pre(t._defaultBeforeMiddleware[i]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}var e=t.prototype;return e.add=function(t,e,n,r){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"==typeof t&&(r=e||t.callback||t.onComplete,n=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof n&&(r=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new g(t,e,n),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var o=n.parentResource,s=[],a=0;a<o.children.length;++a)o.children[a].isComplete||s.push(o.children[a]);var u=o.progressChunk*(s.length+1)/(s.length+2);o.children.push(this.resources[t]),o.progressChunk=u;for(var h=0;h<s.length;++h)s[h].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},e.pre=function(t){return this._beforeMiddleware.push(t),this},e.use=function(t){return this._afterMiddleware.push(t),this},e.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},e.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},e._prepareUrl=function(t){var e,n=i()(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=x.exec(e)[0];-1!==(e=e.substr(0,e.length-r.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},e._loadResource=function(t,e){var n=this;t._dequeue=e,u(this._beforeMiddleware,(function(e,r){e.call(n,t,(function(){r(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},e._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},e._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},e._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),u(this._afterMiddleware,(function(n,r){n.call(e,t,r)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},p(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();E._defaultBeforeMiddleware=[],E._defaultAfterMiddleware=[],E.pre=function(t){return E._defaultBeforeMiddleware.push(t),E},E.use=function(t){return E._defaultAfterMiddleware.push(t),E};var T=n(3),I=g,A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*!
 * @pixi/loaders - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var S=function(){function t(){}return t.use=function(t,e){t.data&&t.type===g.TYPE.IMAGE&&(t.texture=T.r.fromLoader(t.data,t.url,t.name)),e()},t}(),O=function(t){function e(n,r){for(var i=t.call(this,n,r)||this,o=0;o<e._plugins.length;++o){var s=e._plugins[o],a=s.pre,u=s.use;a&&i.pre(a),u&&i.use(u)}return i._protected=!1,i}return function(t,e){function n(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(e,"shared",{get:function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},enumerable:!1,configurable:!0}),e.registerPlugin=function(t){return e._plugins.push(t),t.add&&t.add(),e},e._plugins=[],e}(E);O.registerPlugin({use:w.parsing}),O.registerPlugin(S);var P=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?O.shared:new O},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}()},,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/*!
 * @pixi/runner - v5.3.3
 * Compiled Tue, 04 Aug 2020 16:23:09 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var r=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,r,i,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var u=this,h=u.name,c=u.items;this._aliasCount++;for(var l=0,f=c.length;l<f;l++)c[l][h](t,e,n,r,i,o,s,a);return c===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(r.prototype,{dispatch:{value:r.prototype.emit},run:{value:r.prototype.emit}})},,,,function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,n,r){void 0===n&&(n=!1),i(this,t),this._fn=e,this._once=n,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function s(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){i(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=o,e.default=a,t.exports=e.default},,,function(t,e,n){"use strict";var r=n(10),i=n(8),o=n(0),s=n(3),a=function(){function t(t,e){this._output=e,this._input=t}return Object.defineProperty(t.prototype,"destination",{get:function(){return this._input},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;if(this._filters&&(this._filters.forEach((function(t){t&&t.disconnect()})),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();var n=null;t.forEach((function(t){null===n?e._input.connect(t.destination):n.connect(t.destination),n=t})),n.connect(this._output)}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},t}(),u=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){this.destination=t,this.source=e||t},t.prototype.connect=function(t){this.source.connect(t)},t.prototype.disconnect=function(){this.source.disconnect()},t.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},t}(),h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function c(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var l,f=function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function p(){return l}var d,v,y,g,m=function(){function t(){}return t.setParamValue=function(t,e){if(t.setValueAtTime){var n=p().context;t.setValueAtTime(e,n.audioContext.currentTime)}else t.value=e;return e},t}(),_=0,b=function(t){function e(e){var n=t.call(this)||this;return n.id=_++,n._media=null,n._paused=!1,n._muted=!1,n._elapsed=0,n.init(e),n}return c(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},e.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){if(this._source){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var n=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);m.setParamValue(this._gain.gain,i*r*n),m.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed)}},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",n))},e.prototype.play=function(t){var e=t.start,n=t.end,r=t.speed,i=t.loop,o=t.volume,s=t.muted;this._paused=!1;var a=this._media.nodes.cloneBufferSource(),u=a.source,h=a.gain;this._source=u,this._gain=h,this._speed=r,this._volume=o,this._loop=!!i,this._muted=s,this.refresh();var c=this._source.buffer.duration;this._duration=c,this._end=n,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=n,this._source.loopStart=e,this._source.start(0,e)):n?this._source.start(0,e,n-e):this._source.start(0,e),this.emit("start"),this._update(!0),this._enabled=!0},e.prototype._toSec=function(t){return t>10&&(t/=1e3),t||0},Object.defineProperty(e.prototype,"_enabled",{set:function(t){i.a.shared.remove(this._updateListener,this),t&&i.a.shared.add(this._updateListener,this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},e.prototype.toString=function(){return"[WebAudioInstance id="+this.id+"]"},e.prototype._now=function(){return this._media.context.audioContext.currentTime},e.prototype._updateListener=function(){this._update()},e.prototype._update=function(t){if(void 0===t&&(t=!1),this._source){var e=this._now(),n=e-this._lastUpdate;if(n>0||t){var r=this._source.playbackRate.value;this._elapsed+=n*r,this._lastUpdate=e;var i=this._duration,o=void 0;if(this._source.loopStart){var s=this._source.loopEnd-this._source.loopStart;o=(this._source.loopStart+this._elapsed%s)/i}else o=this._elapsed%i/i;this._progress=o,this.emit("progress",this._progress,i)}}},e.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},e.prototype._internalStop=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.stop(0),this._source.disconnect(),this._source=null)},e.prototype._onComplete=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.disconnect()),this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},e}(o.c),w=function(t){function e(e){var n=this,r=e.audioContext,i=r.createBufferSource(),o=r.createGain(),s=r.createAnalyser();return i.connect(s),s.connect(o),o.connect(e.destination),(n=t.call(this,s,o)||this).context=e,n.bufferSource=i,n.gain=o,n.analyser=s,n}return c(e,t),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,m.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;var n=this.context.audioContext.createGain();return e.connect(n),n.connect(this.destination),{source:e,gain:n}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!0,configurable:!0}),e.BUFFER_SIZE=0,e}(a),x=function(){function t(){}return t.prototype.init=function(t){this.parent=t,this._nodes=new w(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source},t.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null,this._source=null,this.source=null},t.prototype.create=function(){return new b(this)},Object.defineProperty(t.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._nodes.filters},set:function(t){this._nodes.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),t.prototype.load=function(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t&&t(new Error("sound.url or sound.source must be set"))},t.prototype._loadUrl=function(t){var e=this,n=new XMLHttpRequest,r=this.parent.url;n.open("GET",r,!0),n.responseType="arraybuffer",n.onload=function(){e.source=n.response,e._decode(n.response,t)},n.send()},t.prototype._decode=function(t,e){var n=this;this.parent.context.decode(t,(function(t,r){if(t)e&&e(t);else{n.parent.isLoaded=!0,n.buffer=r;var i=n.parent.autoPlayStart();e&&e(null,n.parent,i)}}))},t}(),E=function(t){function e(){var n=this,r=window,i=new e.AudioContext,s=i.createDynamicsCompressor(),a=i.createAnalyser();return a.connect(s),s.connect(i.destination),(n=t.call(this,a,s)||this)._ctx=i,n._offlineCtx=new e.OfflineAudioContext(1,2,r.OfflineAudioContext?i.sampleRate:44100),n._unlocked=!1,n.compressor=s,n.analyser=a,n.events=new o.c,n.volume=1,n.speed=1,n.muted=!1,n.paused=!1,"running"!==i.state&&(n._unlock(),n._unlock=n._unlock.bind(n),document.addEventListener("mousedown",n._unlock,!0),document.addEventListener("touchstart",n._unlock,!0),document.addEventListener("touchend",n._unlock,!0)),n}return c(e,t),e.prototype._unlock=function(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this._ctx;void 0!==e.close&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,e){this._offlineCtx.decodeAudioData(t,(function(t){e(null,t)}),(function(t){e(new Error(t.message||"Unable to decode file"))}))},e}(a),T={WebAudioMedia:x,WebAudioInstance:b,WebAudioNodes:w,WebAudioContext:E,WebAudioUtils:m},I={Filter:u,EqualizerFilter:function(t){function e(n,r,i,o,s,a,u,h,c,l){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===c&&(c=0),void 0===l&&(l=0);var f=this;if(!p().useLegacy){var d=[{f:e.F32,type:"lowshelf",gain:n},{f:e.F64,type:"peaking",gain:r},{f:e.F125,type:"peaking",gain:i},{f:e.F250,type:"peaking",gain:o},{f:e.F500,type:"peaking",gain:s},{f:e.F1K,type:"peaking",gain:a},{f:e.F2K,type:"peaking",gain:u},{f:e.F4K,type:"peaking",gain:h},{f:e.F8K,type:"peaking",gain:c},{f:e.F16K,type:"highshelf",gain:l}].map((function(t){var e=p().context.audioContext.createBiquadFilter();return e.type=t.type,m.setParamValue(e.Q,1),e.frequency.value=t.f,m.setParamValue(e.gain,t.gain),e}));(f=t.call(this,d[0],d[d.length-1])||this).bands=d,f.bandsMap={};for(var v=0;v<f.bands.length;v++){var y=f.bands[v];v>0&&f.bands[v-1].connect(y),f.bandsMap[y.frequency.value]=y}return f}f=t.call(this,null)||this}return c(e,t),e.prototype.setGain=function(t,e){if(void 0===e&&(e=0),!this.bandsMap[t])throw new Error("No band found for frequency "+t);m.setParamValue(this.bandsMap[t].gain,e)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency "+t);return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.bands.forEach((function(t){m.setParamValue(t.gain,0)}))},e.prototype.destroy=function(){this.bands.forEach((function(t){t.disconnect()})),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e}(u),DistortionFilter:function(t){function e(e){void 0===e&&(e=0);var n=this;if(!p().useLegacy){var r=p().context.audioContext.createWaveShaper();return(n=t.call(this,r)||this)._distortion=r,n.amount=e,n}n=t.call(this,null)||this}return c(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){t*=1e3,this._amount=t;for(var e,n=new Float32Array(44100),r=Math.PI/180,i=0;i<44100;++i)e=2*i/44100-1,n[i]=(3+t)*e*20*r/(Math.PI+t*Math.abs(e));this._distortion.curve=n,this._distortion.oversample="4x"},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,t.prototype.destroy.call(this)},e}(u),StereoFilter:function(t){function e(e){void 0===e&&(e=0);var n=this;if(!p().useLegacy){var r,i,o,s=p().context.audioContext;return s.createStereoPanner?o=r=s.createStereoPanner():((i=s.createPanner()).panningModel="equalpower",o=i),(n=t.call(this,o)||this)._stereo=r,n._panner=i,n.pan=e,n}n=t.call(this,null)||this}return c(e,t),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?m.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(u),ReverbFilter:function(t){function e(e,n,r){void 0===e&&(e=3),void 0===n&&(n=2),void 0===r&&(r=!1);var i=this;if(!p().useLegacy)return(i=t.call(this,null)||this)._seconds=i._clamp(e,1,50),i._decay=i._clamp(n,0,100),i._reverse=r,i._rebuild(),i;i=t.call(this,null)||this}return c(e,t),e.prototype._clamp=function(t,e,n){return Math.min(n,Math.max(e,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){for(var t,e=p().context.audioContext,n=e.sampleRate,r=n*this._seconds,i=e.createBuffer(2,r,n),o=i.getChannelData(0),s=i.getChannelData(1),a=0;a<r;a++)t=this._reverse?r-a:a,o[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay),s[a]=(2*Math.random()-1)*Math.pow(1-t/r,this._decay);var u=p().context.audioContext.createConvolver();u.buffer=i,this.init(u)},e}(u),MonoFilter:function(t){function e(){var e=this;if(!p().useLegacy){var n=p().context.audioContext,r=n.createChannelSplitter(),i=n.createChannelMerger();return i.connect(r),(e=t.call(this,i,r)||this)._merger=i,e}e=t.call(this,null)||this}return c(e,t),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,t.prototype.destroy.call(this)},e}(u),TelephoneFilter:function(t){function e(){if(!p().useLegacy){var e=p().context.audioContext,n=e.createBiquadFilter(),r=e.createBiquadFilter(),i=e.createBiquadFilter(),o=e.createBiquadFilter();return n.type="lowpass",m.setParamValue(n.frequency,2e3),r.type="lowpass",m.setParamValue(r.frequency,2e3),i.type="highpass",m.setParamValue(i.frequency,500),o.type="highpass",m.setParamValue(o.frequency,500),n.connect(r),r.connect(i),i.connect(o),t.call(this,n,o)||this}t.call(this,null)}return c(e,t),e}(u)},A=0,S=function(t){function e(e){var n=t.call(this)||this;return n.id=A++,n.init(e),n}return c(e,t),e.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},Object.defineProperty(e.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),e.prototype._onPlay=function(){this._playing=!0},e.prototype._onPause=function(){this._playing=!1},e.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},e.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},e.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var n=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);this._source.volume=i*n*r,this._source.playbackRate=this._speed*t.speed*e.speed},e.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",n))},e.prototype.play=function(t){var n=this,r=t.start,o=t.end,s=t.speed,a=t.loop,u=t.volume,h=t.muted;this._speed=s,this._volume=u,this._loop=!!a,this._muted=h,this.refresh(),this.loop&&null!==o&&(this.loop=!1),this._start=r,this._end=o||this._duration,this._start=Math.max(0,this._start-e.PADDING),this._end=Math.min(this._end+e.PADDING,this._duration),this._source.onloadedmetadata=function(){n._source&&(n._source.currentTime=r,n._source.onloadedmetadata=null,n.emit("progress",r,n._duration),i.a.shared.add(n._onUpdate,n))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},e.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},e.prototype._onComplete=function(){i.a.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},e.prototype.destroy=function(){i.a.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},e.prototype.toString=function(){return"[HTMLAudioInstance id="+this.id+"]"},e.PADDING=.1,e}(o.c),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new S(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&4===this._source.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.load=function(t){var e=this._source,n=this.parent;if(4!==e.readyState){if(!n.url)return t(new Error("sound.url or sound.source must be set"));e.src=n.url;var r=function(){e.removeEventListener("canplaythrough",i),e.removeEventListener("load",i),e.removeEventListener("abort",o),e.removeEventListener("error",s)},i=function(){r(),n.isLoaded=!0;var e=n.autoPlayStart();t&&t(null,n,e)},o=function(){r(),t&&t(new Error("Sound loading has been aborted"))},s=function(){r();var n="Failed to load audio element (code: "+e.error.code+")";t&&t(new Error(n))};e.addEventListener("canplaythrough",i,!1),e.addEventListener("load",i,!1),e.addEventListener("abort",o,!1),e.addEventListener("error",s,!1),e.load()}else{n.isLoaded=!0;var a=n.autoPlayStart();t&&setTimeout((function(){t(null,n,a)}),0)}},e}(o.c),P=function(t){function e(){var e=t.call(this)||this;return e.speed=1,e.volume=1,e.muted=!1,e.paused=!1,e}return c(e,t),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(o.c),C={HTMLAudioMedia:O,HTMLAudioInstance:S,HTMLAudioContext:P},D=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid"],N=(d={m4a:"mp4",oga:"ogg"},v=document.createElement("audio"),y={},g=/^no$/,D.forEach((function(t){var e=d[t]||t,n=v.canPlayType("audio/"+t).replace(g,""),r=v.canPlayType("audio/"+e).replace(g,"");y[t]=!!n||!!r})),Object.freeze(y)),R=/\.(\{([^\}]+)\})(\?.*)?$/;function M(t){var e=R,n="string"==typeof t?t:t.url;if(e.test(n)){for(var r=e.exec(n),i=r[2].split(","),o=i[i.length-1],s=0,a=i.length;s<a;s++){var u=i[s];if(N[u]){o=u;break}}var h=n.replace(r[1],o);return"string"!=typeof t&&(t.extension=o,t.url=h),h}return n}var L,U=function(){function t(){}return t.add=function(){t.legacy=p().useLegacy},Object.defineProperty(t,"legacy",{set:function(t){var e=D;t?e.forEach((function(t){r.c.setExtensionXhrType(t,r.c.XHR_RESPONSE_TYPE.DEFAULT),r.c.setExtensionLoadType(t,r.c.LOAD_TYPE.AUDIO)})):e.forEach((function(t){r.c.setExtensionXhrType(t,r.c.XHR_RESPONSE_TYPE.BUFFER),r.c.setExtensionLoadType(t,r.c.LOAD_TYPE.XHR)}))},enumerable:!0,configurable:!0}),t.pre=function(t,e){M(t),e()},t.use=function(t,e){t.data&&D.indexOf(t.extension)>-1?t.sound=p().add(t.name,{loaded:e,preload:!0,url:t.url,source:t.data}):e()},t}(),k=function(){function t(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start}return t.prototype.play=function(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},t.prototype.destroy=function(){this.parent=null},t}(),F=function(){function t(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);var n=e.complete;this._autoPlayOptions=n?{complete:n}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}return t.from=function(e){var n={};return"string"==typeof e?n.url=e:e instanceof ArrayBuffer||e instanceof HTMLAudioElement?n.source=e:n=e,(n=f({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},n)).url&&(n.url=M(n.url)),Object.freeze(n),new t(p().useLegacy?new O:new x,n)},Object.defineProperty(t.prototype,"context",{get:function(){return p().context},enumerable:!0,configurable:!0}),t.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},t.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this.media.filters},set:function(t){this.media.filters=t},enumerable:!0,configurable:!0}),t.prototype.addSprites=function(t,e){if("object"==typeof t){var n={};for(var r in t)n[r]=this.addSprites(r,t[r]);return n}if("string"==typeof t){var i=new k(this,e);return this._sprites[t]=i,i}},t.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},t.prototype.removeSprites=function(t){if(t){var e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(var n in this._sprites)this.removeSprites(n);return this},Object.defineProperty(t.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!0,configurable:!0}),t.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this},t.prototype.play=function(t,e){var n,r=this;if("string"==typeof t?n={sprite:o=t,loop:this.loop,complete:e}:"function"==typeof t?(n={}).complete=t:n=t,(n=f({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},n||{})).sprite){var i=n.sprite,o=this._sprites[i];n.start=o.start,n.end=o.end,n.speed=o.speed||1,n.loop=o.loop||n.loop,delete n.sprite}if(n.offset&&(n.start=n.offset),!this.isLoaded)return new Promise((function(t,e){r.autoPlay=!0,r._autoPlayOptions=n,r._preload((function(r,i,o){r?e(r):(n.loaded&&n.loaded(r,i,o),t(o))}))}));this.singleInstance&&this._removeInstances();var s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",(function(){n.complete&&n.complete(r),r._onComplete(s)})),s.once("stop",(function(){r._onComplete(s)})),s.play(n),s},t.prototype.refresh=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refresh()},t.prototype.refreshPaused=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refreshPaused()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),t.prototype._preload=function(t){this.media.load(t)},Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprites",{get:function(){return this._sprites},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.media.duration},enumerable:!0,configurable:!0}),t.prototype.autoPlayStart=function(){var t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t},t.prototype._removeInstances=function(){for(var t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0},t.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)},t.prototype._createInstance=function(){if(t._pool.length>0){var e=t._pool.pop();return e.init(this.media),e}return this.media.create()},t.prototype._poolInstance=function(e){e.destroy(),t._pool.indexOf(e)<0&&t._pool.push(e)},t._pool=[],t}(),j=function(){function t(){this.init()}return t.prototype.init=function(){return this.supported&&(this._webAudioContext=new E),this._htmlAudioContext=new P,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(t){this.useLegacy||(this._context.filters=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supported",{get:function(){return null!==E.AudioContext},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){if("object"==typeof t){var n={};for(var r in t){var i=this._getOptions(t[r],e);n[r]=this.add(r,i)}return n}if("string"==typeof t){if(e instanceof F)return this._sounds[t]=e,e;i=this._getOptions(e);var o=F.from(i);return this._sounds[t]=o,o}},t.prototype._getOptions=function(t,e){var n;return n="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof HTMLAudioElement?{source:t}:t,f({},n,e||{})},Object.defineProperty(t.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(t){U.legacy=t,this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},Object.defineProperty(t.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(t){this._context.volume=t,this._context.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedAll",{get:function(){return this._context.speed},set:function(t){this._context.speed=t,this._context.refresh()},enumerable:!0,configurable:!0}),t.prototype.togglePauseAll=function(){return this._context.togglePause()},t.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},t.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},t.prototype.toggleMuteAll=function(){return this._context.toggleMute()},t.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){return void 0===e&&(e=!1),!!this._sounds[t]},t.prototype.find=function(t){return this.exists(t,!0),this._sounds[t]},t.prototype.play=function(t,e){return this.find(t).play(e)},t.prototype.stop=function(t){return this.find(t).stop()},t.prototype.pause=function(t){return this.find(t).pause()},t.prototype.resume=function(t){return this.find(t).resume()},t.prototype.volume=function(t,e){var n=this.find(t);return void 0!==e&&(n.volume=e),n.volume},t.prototype.speed=function(t,e){var n=this.find(t);return void 0!==e&&(n.speed=e),n.speed},t.prototype.duration=function(t){return this.find(t).duration},t.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},t}(),B=0,V={get PLAY_ID(){return B},playOnce:function(t,e){var n="alias"+B++;return p().add(n,{url:t,preload:!0,autoPlay:!0,loaded:function(t){t&&(p().remove(n),e&&e(t))},complete:function(){p().remove(n),e&&e(null)}}),n},render:function(t,e){var n=document.createElement("canvas");e=f({width:512,height:128,fill:"black"},e||{}),n.width=e.width,n.height=e.height;var r=s.c.from(n);if(!(t.media instanceof x))return r;var i=t.media,o=n.getContext("2d");o.fillStyle=e.fill;for(var a=i.buffer.getChannelData(0),u=Math.ceil(a.length/e.width),h=e.height/2,c=0;c<e.width;c++){for(var l=1,p=-1,d=0;d<u;d++){var v=a[c*u+d];v<l&&(l=v),v>p&&(p=v)}o.fillRect(c,(1+l)*h,1,Math.max(1,(p-l)*h))}return r},resolveUrl:M,sineTone:function(t,e){void 0===t&&(t=200),void 0===e&&(e=1);var n=F.from({singleInstance:!0});if(!(n.media instanceof x))return n;for(var r=n.media,i=n.context.audioContext.createBuffer(1,48e3*e,48e3),o=i.getChannelData(0),s=0;s<o.length;s++){var a=t*(s/i.sampleRate)*Math.PI;o[s]=2*Math.sin(a)}return r.buffer=i,n.isLoaded=!0,n},extensions:D,supported:N},G=(L=new j,l=L,L);r.b.registerPlugin(U),Object.defineProperties(G,{Filterable:{get:function(){return a}},filters:{get:function(){return I}},htmlaudio:{get:function(){return C}},Sound:{get:function(){return F}},SoundLibrary:{get:function(){return j}},SoundSprite:{get:function(){return k}},utils:{get:function(){return V}},webaudio:{get:function(){return T}},sound:{get:function(){return G}}}),e.a=G},function(t,e,n){var r=n(61),i=n(62),o=n(63),s=n(64),a=n(65),u=n(66),h=n(67);h.alea=r,h.xor128=i,h.xorwow=o,h.xorshift7=s,h.xor4096=a,h.tychei=u,t.exports=h},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,,,function(t,e){(function(e){t.exports=e}).call(this,{})},,function(t,e,n){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=r(n(45));
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
i.default.registerVersion("firebase","7.21.0","app"),t.exports=i.default},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return s})),n.d(e,"__decorate",(function(){return a})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return h})),n.d(e,"__awaiter",(function(){return c})),n.d(e,"__generator",(function(){return l})),n.d(e,"__createBinding",(function(){return f})),n.d(e,"__exportStar",(function(){return p})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return v})),n.d(e,"__spread",(function(){return y})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return _})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return w})),n.d(e,"__makeTemplateObject",(function(){return x})),n.d(e,"__importStar",(function(){return E})),n.d(e,"__importDefault",(function(){return T})),n.d(e,"__classPrivateFieldGet",(function(){return I})),n.d(e,"__classPrivateFieldSet",(function(){return A}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function a(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function u(t,e){return function(n,r){e(n,r,t)}}function h(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function f(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}function p(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function _(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{(n=i[t](e)).value instanceof m?Promise.resolve(n.value.v).then(u,h):c(o[0][2],n)}catch(t){c(o[0][3],t)}var n}function u(t){a("next",t)}function h(t){a("throw",t)}function c(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}}function x(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function T(t){return t&&t.__esModule?t:{default:t}}function I(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function A(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},,function(t,e,n){"use strict";var r=n(53),i=n(54);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=_,e.resolve=function(t,e){return _(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?_(t,!1,!0).resolveObject(e):e},e.format=function(t){i.isString(t)&&(t=_(t));return t instanceof o?t.format():o.prototype.format.call(t)},e.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(h),l=["%","/","?",";","#"].concat(c),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=n(55);function _(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",h=t.split(a);h[0]=h[0].replace(/\\/g,"/");var _=t=h.join(a);if(_=_.trim(),!n&&1===t.split("#").length){var b=u.exec(_);if(b)return this.path=_,this.href=_,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?m.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(_);if(w){var x=(w=w[0]).toLowerCase();this.protocol=x,_=_.substr(w.length)}if(n||w||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===_.substr(0,2);!E||w&&y[w]||(_=_.substr(2),this.slashes=!0)}if(!y[w]&&(E||w&&!g[w])){for(var T,I,A=-1,S=0;S<f.length;S++){-1!==(O=_.indexOf(f[S]))&&(-1===A||O<A)&&(A=O)}-1!==(I=-1===A?_.lastIndexOf("@"):_.lastIndexOf("@",A))&&(T=_.slice(0,I),_=_.slice(I+1),this.auth=decodeURIComponent(T)),A=-1;for(S=0;S<l.length;S++){var O;-1!==(O=_.indexOf(l[S]))&&(-1===A||O<A)&&(A=O)}-1===A&&(A=_.length),this.host=_.slice(0,A),_=_.slice(A),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var C=this.hostname.split(/\./),D=(S=0,C.length);S<D;S++){var N=C[S];if(N&&!N.match(p)){for(var R="",M=0,L=N.length;M<L;M++)N.charCodeAt(M)>127?R+="x":R+=N[M];if(!R.match(p)){var U=C.slice(0,S),k=C.slice(S+1),F=N.match(d);F&&(U.push(F[1]),k.unshift(F[2])),k.length&&(_="/"+k.join(".")+_),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var j=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+j,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!v[x])for(S=0,D=c.length;S<D;S++){var V=c[S];if(-1!==_.indexOf(V)){var G=encodeURIComponent(V);G===V&&(G=escape(V)),_=_.split(V).join(G)}}var z=_.indexOf("#");-1!==z&&(this.hash=_.substr(z),_=_.slice(0,z));var H=_.indexOf("?");if(-1!==H?(this.search=_.substr(H),this.query=_.substr(H+1),e&&(this.query=m.parse(this.query)),_=_.slice(0,H)):e&&(this.search="",this.query={}),_&&(this.pathname=_),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var X=this.search||"";this.path=j+X}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=m.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(_(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),h=0;h<u.length;h++){var c=u[h];"protocol"!==c&&(n[c]=t[c])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var l=Object.keys(t),f=0;f<l.length;f++){var p=l[f];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var _=n.pathname&&"/"===n.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=b||_||n.host&&t.pathname,x=w,E=n.pathname&&n.pathname.split("/")||[],T=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(T&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),w=w&&(""===d[0]||""===E[0])),b)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,E=d;else if(d.length)E||(E=[]),E.pop(),E=E.concat(d),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(T)n.hostname=n.host=E.shift(),(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=E.slice(-1)[0],A=(n.host||t.host||E.length>1)&&("."===I||".."===I)||""===I,S=0,O=E.length;O>=0;O--)"."===(I=E[O])?E.splice(O,1):".."===I?(E.splice(O,1),S++):S&&(E.splice(O,1),S--);if(!w&&!x)for(;S--;S)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),A&&"/"!==E.join("/").substr(-1)&&E.push("");var P,C=""===E[0]||E[0]&&"/"===E[0].charAt(0);T&&(n.hostname=n.host=C?"":E.length?E.shift():"",(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift()));return(w=w||n.host&&E.length)&&!C&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},,,,,function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,c=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|h>>6,p=63&h;u||(p=64,s||(f=64)),r.push(n[c],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var h=o<<2|s>>4;if(r.push(h),64!==a){var c=s<<4&240|a>>2;if(r.push(c),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=c(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var l=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(t){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,v.prototype.create),i}return r.__extends(e,t),e}(Error),v=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?y(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new d(i,a),h=0,c=Object.keys(r);h<c.length;h++){var l=c[h];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();function y(t,e){return t.replace(g,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var g=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m(t){return JSON.parse(t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=m(h(o[0])||""),n=m(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],h=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=c^u&(h^c),s=1518500249):(o=u^h^c,s=1859775393):r<60?(o=u&h|c&(u|h),s=2400959708):(o=u^h^c,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=c,c=h,h=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=x),void 0===r.error&&(r.error=x),void 0===r.complete&&(r.complete=x);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function x(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}e.CONSTANTS=i,e.Deferred=l,e.ErrorFactory=v,e.FirebaseError=d,e.MAX_VALUE_MILLIS=144e5,e.RANDOM_FACTOR=.5,e.Sha1=b,e.areCookiesEnabled=function(){return!(!navigator||!navigator.cookieEnabled)},e.assert=o,e.assertionError=s,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=u,e.base64Decode=h,e.base64Encode=function(t){var e=a(t);return u.encodeByteArray(e,!0)},e.calculateBackoffMillis=function(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)},e.contains=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=_,e.deepCopy=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t){return c(void 0,t)},e.deepExtend=c,e.errorPrefix=E,e.getUA=f,e.isAdmin=function(t){var e=_(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},e.isElectron=function(){return f().indexOf("Electron/")>=0},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},e.isIndexedDBAvailable=function(){return"indexedDB"in self&&null!=indexedDB},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=p,e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isSafari=function(){return!p()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},e.isUWP=function(){return f().indexOf("MSAppHost/")>=0},e.isValidFormat=function(t){var e=_(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=_(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=_(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=m,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(E(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(E(t,e,r)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,e.validateIndexedDBOpenable=function(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(E(t,e,r)+"must be a valid firebase namespace.")}}).call(this,n(25))},function(t,e,n){"use strict";t.exports=function(t,e){if(t){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[n.key[o]]=r[o]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,(function(t,e,r){e&&(i[n.q.name][e]=r)})),i}}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,h=[],c=!1,l=-1;function f(){c&&u&&(c=!1,u.length?h=u.concat(h):l=-1,h.length&&p())}function p(){if(!c){var t=a(f);c=!0;for(var e=h.length;e;){for(u=h,h=[];++l<e;)u&&u[l].run();l=-1,e=h.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new d(t,e)),1!==h.length||c||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function s(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function h(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),h.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},h.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,s=new Array(o);r<o;r++)s[r]=n[r].fn;return s},h.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},h.prototype.emit=function(t,e,n,r,o,s){var a=i?i+t:t;if(!this._events[a])return!1;var u,h,c=this._events[a],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,o),!0;case 6:return c.fn.call(c.context,e,n,r,o,s),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var f,p=c.length;for(h=0;h<p;h++)switch(c[h].once&&this.removeListener(t,c[h].fn,void 0,!0),l){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,e);break;case 3:c[h].fn.call(c[h].context,e,n);break;case 4:c[h].fn.call(c[h].context,e,n,r);break;default:if(!u)for(f=1,u=new Array(l-1);f<l;f++)u[f-1]=arguments[f];c[h].fn.apply(c[h].context,u)}}return!0},h.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},h.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},h.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||r&&!s.once||n&&s.context!==n||u(this,o);else{for(var a=0,h=[],c=s.length;a<c;a++)(s[a].fn!==e||r&&!s[a].once||n&&s[a].context!==n)&&h.push(s[a]);h.length?this._events[o]=1===h.length?h[0]:h:u(this,o)}return this},h.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=i,h.EventEmitter=h,t.exports=h},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,a,u,h,c,p,d,y=e&&e.length,g=y?e[0]*n:t.length,m=i(t,0,g,n,!0),_=[];if(!m||m.next===m.prev)return _;if(y&&(m=function(t,e,n,r){var s,a,u,h,c,p=[];for(s=0,a=e.length;s<a;s++)u=e[s]*r,h=s<a-1?e[s+1]*r:t.length,(c=i(t,u,h,r,!1))===c.next&&(c.steiner=!0),p.push(v(c));for(p.sort(l),s=0;s<p.length;s++)f(p[s],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=u=t[0],a=h=t[1];for(var b=n;b<g;b+=n)(c=t[b])<r&&(r=c),(p=t[b+1])<a&&(a=p),c>u&&(u=c),p>h&&(h=p);d=0!==(d=Math.max(u-r,h-a))?1/d:0}return s(m,_,n,r,a,d),_}function i(t,e,n,r,i){var o,s;if(i===O(t,e,n,r)>0)for(o=e;o<n;o+=r)s=I(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=I(o,t[o],t[o+1],s);return s&&_(s,s.next)&&(A(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!_(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(A(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function s(t,e,n,r,i,l,f){if(t){!f&&l&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,u,h=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ);e++);for(u=h;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(s>1)}(i)}(t,r,i,l);for(var p,v,y=t;t.prev!==t.next;)if(p=t.prev,v=t.next,l?u(t,r,i,l):a(t))e.push(p.i/n),e.push(t.i/n),e.push(v.i/n),A(t),t=v.next,y=v.next;else if((t=v)===y){f?1===f?s(t=h(o(t),e,n),e,n,r,i,l,2):2===f&&c(t,e,n,r,i,l):s(o(t),e,n,r,i,l,1);break}}}function a(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(y(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,s=t.next;if(m(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,h=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,l=d(a,u,e,n,r),f=d(h,c,e,n,r),p=t.prevZ,v=t.nextZ;p&&p.z>=l&&v&&v.z<=f;){if(p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==t.prev&&v!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=l;){if(p!==t.prev&&p!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=f;){if(v!==t.prev&&v!==t.next&&y(i.x,i.y,o.x,o.y,s.x,s.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function h(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!_(i,s)&&b(i,r,r.next,s)&&E(i,s)&&E(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),A(r),A(r.next),r=t=s),r=r.next}while(r!==t);return o(r)}function c(t,e,n,r,i,a){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&g(u,h)){var c=T(u,h);return u=o(u,u.next),c=o(c,c.next),s(u,e,n,r,i,a),void s(c,e,n,r,i,a)}h=h.next}u=u.next}while(u!==t)}function l(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var u,h=n,c=n.x,l=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&y(o<l?i:s,o,c,l,o<l?s:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),E(r,t)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&p(n,r)))&&(n=r,f=u)),r=r.next}while(r!==h);return n}(t,e)){var n=T(e,t);o(e,e.next),o(n,n.next)}}function p(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||_(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){var i=x(m(t,e,n)),o=x(m(t,e,r)),s=x(m(n,r,t)),a=x(m(n,r,e));return i!==o&&s!==a||(!(0!==i||!w(t,n,e))||(!(0!==o||!w(t,r,e))||(!(0!==s||!w(n,t,r))||!(0!==a||!w(n,e,r)))))}function w(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x(t){return t>0?1:t<0?-1:0}function E(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function T(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function I(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(O(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var h=e[a]*n,c=a<u-1?e[a+1]*n:t.length;s-=Math.abs(O(t,h,c,n))}var l=0;for(a=0;a<r.length;a+=3){var f=r[a]*n,p=r[a+1]*n,d=r[a+2]*n;l+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===s&&0===l?0:Math.abs((l-s)/s)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=n(33),s=n(40),a=n(46),u=n(47),h=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),c=new s.ErrorFactory("app","Firebase",h),l=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),f=new u.Logger("@firebase/app"),p=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=s.deepCopy(t),this.container=new a.ComponentContainer(e.name),this._addComponent(new a.Component("app",(function(){return u}),"PUBLIC"));try{for(var h=o.__values(this.firebase_.INTERNAL.components.values()),c=h.next();!c.done;c=h.next()){var l=c.value;this._addComponent(l)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){f.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},t}();p.prototype.name&&p.prototype.options||p.prototype.delete||console.log("dc");var d=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function t(){var e=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;if("string"!=typeof a||!a)throw c.create("bad-app-name",{appName:String(a)});if(s.contains(e,a))throw c.create("duplicate-app",{appName:a});var u=new t(n,o,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=l[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void f.warn(u.join(" "))}h(new a.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw c.create("invalid-log-argument",{appName:name});u.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.20.0",INTERNAL:{registerComponent:h,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(t=t||"[DEFAULT]",!s.contains(e,t))throw c.create("no-app",{appName:t});return e[t]}function h(a){var u,h,l=a.name;if(n.has(l))return f.debug("There were multiple attempts to register component "+l+"."),"PUBLIC"===a.type?r[l]:null;if(n.set(l,a),"PUBLIC"===a.type){var p=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[l])throw c.create("invalid-app-argument",{appName:l});return t[l]()};void 0!==a.serviceProps&&s.deepExtend(p,a.serviceProps),r[l]=p,t.prototype[l]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,l);return n.apply(this,a.multipleInstances?t:[])}}try{for(var d=o.__values(Object.keys(e)),v=d.next();!v.done;v=d.next()){var y=v.value;e[y]._addComponent(a)}}catch(t){u={error:t}}finally{try{v&&!v.done&&(h=d.return)&&h.call(d)}finally{if(u)throw u.error}}return"PUBLIC"===a.type?r[l]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(p);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){s.deepExtend(e,t)},createSubscribe:s.createSubscribe,ErrorFactory:s.ErrorFactory,deepExtend:s.deepExtend}),e}(),v=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if(s.isBrowser()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var g=d.initializeApp;d.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.isNode()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),g.apply(void 0,t)};var m=d;!function(t,e){t.INTERNAL.registerComponent(new a.Component("platform-logger",(function(t){return new v(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.11",e),t.registerVersion("fire-js","")}(m),e.default=m,e.firebase=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),i=n(40),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:"[DEFAULT]",optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService("[DEFAULT]")}catch(t){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),a=s[0],u=s[1],h=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService(h);u.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(r.__spread(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}();var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=o,e.ComponentContainer=a,e.Provider=s},function(t,e,n){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i;n.r(e),n.d(e,"LogLevel",(function(){return o})),n.d(e,"Logger",(function(){return l})),n.d(e,"setLogLevel",(function(){return f})),n.d(e,"setUserLogHandler",(function(){return p}));var o,s=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,h=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),c=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=h[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},l=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=c,this._userLogHandler=null,s.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){s.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=s;r<i.length;r++){n(i[r])}}},function(t,e,n){(function(r,i){var o;!function(r){var s=r.Promise,a=s&&"resolve"in s&&"reject"in s&&"all"in s&&"race"in s&&function(){var t;return new s((function(e){t=e})),"function"==typeof t}();e?(e.Promise=a?s:E,e.Polyfill=E):void 0===(o=function(){return a?s:E}.call(e,n,e,t))||(t.exports=o);var u=function(){};function h(t){return"[object Array]"===Object.prototype.toString.call(t)}var c,l=void 0!==i?i:setTimeout,f=[];function p(){for(var t=0;t<f.length;t++)f[t][0](f[t][1]);f=[],c=!1}function d(t,e){f.push([t,e]),c||(c=!0,l(p,0))}function v(t){var e=t.owner,n=e.state_,r=e.data_,i=t[n],o=t.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(t){_(o,t)}}y(o,r)||("fulfilled"===n&&g(o,r),"rejected"===n&&_(o,r))}function y(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,(function(r){n||(n=!0,e!==r?g(t,r):m(t,r))}),(function(e){n||(n=!0,_(t,e))})),!0}}catch(e){return n||_(t,e),!0}return!1}function g(t,e){t!==e&&y(t,e)||m(t,e)}function m(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,d(w,t))}function _(t,e){"pending"===t.state_&&(t.state_="sealed",t.data_=e,d(x,t))}function b(t){var e=t.then_;t.then_=void 0;for(var n=0;n<e.length;n++)v(e[n])}function w(t){t.state_="fulfilled",b(t)}function x(t){t.state_="rejected",b(t)}function E(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof E==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function n(t){_(e,t)}try{t((function(t){g(e,t)}),n)}catch(t){n(t)}}(t,this)}E.prototype={constructor:E,state_:"pending",then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(u),fulfilled:t,rejected:e};return"fulfilled"===this.state_||"rejected"===this.state_?d(v,n):this.then_.push(n),n.then},catch:function(t){return this.then(null,t)}},E.all=function(t){if(!h(t))throw new TypeError("You must pass an array to Promise.all().");return new this((function(e,n){var r=[],i=0;function o(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var s,a=0;a<t.length;a++)(s=t[a])&&"function"==typeof s.then?s.then(o(a),n):r[a]=s;i||e(r)}))},E.race=function(t){if(!h(t))throw new TypeError("You must pass an array to Promise.race().");return new this((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"==typeof r.then?r.then(e,n):e(r)}))},E.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this((function(e){e(t)}))},E.reject=function(t){return new this((function(e,n){n(t)}))}}("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this)}).call(this,n(25),n(51).setImmediate)},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,u=s(t),h=1;h<arguments.length;h++){for(var c in n=Object(arguments[h]))i.call(n,c)&&(u[c]=n[c]);if(r){a=r(n);for(var l=0;l<a.length;l++)o.call(n,a[l])&&(u[a[l]]=n[a[l]])}}return u}},function(t,e,n){(function(n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){"use strict";function e(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){s(r.response,e,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,s){var a=o.URL||o.webkitURL,u=document.createElement("a");n=n||t.name||"download",u.download=n,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?i(u):r(u.href)?e(t,n,s):i(u,u.target="_blank")):(u.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(u.href)}),4e4),setTimeout((function(){i(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,o){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),n);else if(r(t))e(t,n,o);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){i(s)}))}}:function(t,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,r);var s="application/octet-stream"===t.type,a=/constructor/i.test(o.HTMLElement)||o.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||s&&a)&&"object"==typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},h.readAsDataURL(t)}else{var c=o.URL||o.webkitURL,l=c.createObjectURL(t);i?i.location=l:location.href=l,i=null,setTimeout((function(){c.revokeObjectURL(l)}),4e4)}});o.saveAs=s.saveAs=s,t.exports=s})?r.apply(e,i):r)||(t.exports=o)}).call(this,n(25))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(52),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(25))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,s,a,u=1,h={},c=!1,l=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(i=l.documentElement,r=function(t){var e=l.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&d(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return h[u]=i,r(u),u++},f.clearImmediate=p}function p(t){delete h[t]}function d(t){if(c)setTimeout(d,0,t);else{var e=h[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{p(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(25),n(42))},function(t,e,n){(function(t,r){var i;/*! https://mths.be/punycode v1.3.2 by @mathias */!function(o){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,u=2147483647,h=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,d=String.fromCharCode;function v(t){throw RangeError(f[t])}function y(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function g(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+y((t=t.replace(l,".")).split("."),e).join(".")}function m(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function _(t){return y(t,(function(t){var e="";return t>65535&&(e+=d((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=d(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,n){var r=0;for(t=n?p(t/700):t>>1,t+=p(t/e);t>455;r+=36)t=p(t/35);return p(r+36*t/(t+38))}function x(t){var e,n,r,i,o,s,a,h,c,l,f,d=[],y=t.length,g=0,m=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&v("not-basic"),d.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<y;){for(o=g,s=1,a=36;i>=y&&v("invalid-input"),((h=(f=t.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||h>p((u-g)/s))&&v("overflow"),g+=h*s,!(h<(c=a<=b?1:a>=b+26?26:a-b));a+=36)s>p(u/(l=36-c))&&v("overflow"),s*=l;b=w(g-o,e=d.length+1,0==o),p(g/e)>u-m&&v("overflow"),m+=p(g/e),g%=e,d.splice(g++,0,m)}return _(d)}function E(t){var e,n,r,i,o,s,a,h,c,l,f,y,g,_,x,E=[];for(y=(t=m(t)).length,e=128,n=0,o=72,s=0;s<y;++s)(f=t[s])<128&&E.push(d(f));for(r=i=E.length,i&&E.push("-");r<y;){for(a=u,s=0;s<y;++s)(f=t[s])>=e&&f<a&&(a=f);for(a-e>p((u-n)/(g=r+1))&&v("overflow"),n+=(a-e)*g,e=a,s=0;s<y;++s)if((f=t[s])<e&&++n>u&&v("overflow"),f==e){for(h=n,c=36;!(h<(l=c<=o?1:c>=o+26?26:c-o));c+=36)x=h-l,_=36-l,E.push(d(b(l+x%_,0))),h=p(x/_);E.push(d(b(h,0))),o=w(n,g,r==i),n=0,++r}++n,++e}return E.join("")}a={version:"1.3.2",ucs2:{decode:m,encode:_},decode:x,encode:E,toASCII:function(t){return g(t,(function(t){return c.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return g(t,(function(t){return h.test(t)?x(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return a}.call(e,n,e,t))||(t.exports=i)}()}).call(this,n(26)(t),n(25))},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(56),e.encode=e.stringify=n(57)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var h=t.length;u>0&&h>u&&(h=u);for(var c=0;c<h;++c){var l,f,p,d,v=t[c].replace(a,"%20"),y=v.indexOf(n);y>=0?(l=v.substr(0,y),f=v.substr(y+1)):(l=v,f=""),p=decodeURIComponent(l),d=decodeURIComponent(f),r(s,p)?i(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){"use strict";n(59)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(33),i=n(45),o=n(47),s=n(40),a=n(60),u=n(46);var h=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(i),c={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},l=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return r.__extends(e,t),e}(Error),f=new o.Logger("@firebase/firestore");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p(){return f.logLevel}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.DEBUG){var i=e.map(g);f.debug.apply(f,r.__spreadArrays(["Firestore (7.21.0): "+t],i))}}function v(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.ERROR){var i=e.map(g);f.error.apply(f,r.__spreadArrays(["Firestore (7.21.0): "+t],i))}}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(f.logLevel<=o.LogLevel.WARN){var i=e.map(g);f.warn.apply(f,r.__spreadArrays(["Firestore (7.21.0): "+t],i))}}function g(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.21.0) INTERNAL ASSERTION FAILED: "+t;throw v(e),new Error(e)}function _(t,e){t||m()}function b(t,e){return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function x(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function E(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var T=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&m(),void 0===n?n=t.length-e:n>t.length-e&&m(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.prototype.R=function(){return this.A().join("/")},e.prototype.toString=function(){return this.R()},e.P=function(t){if(t.indexOf("//")>=0)throw new l(c.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.g=function(){return new e([])},e}(T),A=/^[_a-zA-Z][_a-zA-Z0-9]*$/,S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.V=function(t){return A.test(t)},e.prototype.R=function(){return this.A().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.V(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.R()},e.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},e.v=function(){return new e(["__name__"])},e.S=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new l(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new l(c.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new l(c.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new l(c.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.g=function(){return new e([])},e}(T),O=function(){function t(t){this.path=t}return t.D=function(e){return new t(I.P(e))},t.C=function(e){return new t(I.P(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===I.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return I.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new I(e.slice()))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P(t,e){if(0!==e.length)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Y(e.length,"argument")+".")}function C(t,e,n){if(e.length!==n)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires "+Y(n,"argument")+", but was called with "+Y(e.length,"argument")+".")}function D(t,e,n){if(e.length<n)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Y(n,"argument")+", but was called with "+Y(e.length,"argument")+".")}function N(t,e,n,r){if(e.length<n||e.length>r)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Y(e.length,"argument")+".")}function R(t,e,n,r){j(t,e,q(n)+" argument",r)}function M(t,e,n,r){void 0!==r&&R(t,e,n,r)}function L(t,e,n,r){j(t,e,n+" option",r)}function U(t,e,n,r){void 0!==r&&L(t,e,n,r)}function k(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s];if(u===r)return;o.push(V(u))}var h=V(r);throw new l(c.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function F(t,e,n,r){if(!e.some((function(t){return t===r})))throw new l(c.INVALID_ARGUMENT,"Invalid value "+V(r)+" provided to function "+t+"() for its "+q(n)+" argument. Acceptable values: "+e.join(", "));return r}function j(t,e,n,r){if(!("object"===e?B(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=V(r);throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function B(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function V(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":m()}function G(t,e,n){if(void 0===n)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+q(e)+" argument, but it was undefined.")}function z(t,e,n){x(e,(function(e,r){if(n.indexOf(e)<0)throw new l(c.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function H(t,e,n,r){var i=V(r);return new l(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+q(n)+" argument to be a "+e+", but it was: "+i)}function X(t,e,n){if(n<=0)throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+q(e)+" argument to be a positive number, but it was: "+n+".")}function q(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Y(t,e){return t+" "+e+(1===t?"":"s")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K=function(){function t(){}return t.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=W(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Q(t,e){return t<e?-1:t>e?1:0}function Z(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function J(t){return t+"\0"}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.M,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return Q(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();$.B=new $("");var tt=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t($.fromBase64String(e))}catch(e){throw new l(c.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t($.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(){if("undefined"==typeof Uint8Array)throw new l(c.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function nt(){if("undefined"==typeof atob)throw new l(c.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.fromBase64String=function(t){C("Blob.fromBase64String",arguments,1),R("Blob.fromBase64String","string",1,t),nt();try{return new e($.fromBase64String(t))}catch(t){throw new l(c.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){if(C("Blob.fromUint8Array",arguments,1),et(),!(t instanceof Uint8Array))throw H("Blob.fromUint8Array","Uint8Array",1,t);return new e($.fromUint8Array(t))},e.prototype.toBase64=function(){return C("Blob.toBase64",arguments,0),nt(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return C("Blob.toUint8Array",arguments,0),et(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(tt),it=function(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},ot=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return Q(this.projectId,t.projectId)||Q(this.database,t.database)},t}(),st=function(){function t(t,e){this.j=t,this.K=e,this.G={}}return t.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.K(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){x(this.G,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.m=function(){return E(this.G)},t}(),at=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new l(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new l(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new l(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new l(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.H=function(t){return this.seconds===t.seconds?Q(this.nanoseconds,t.nanoseconds):Q(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ut=function(){function t(t){this.timestamp=t}return t.Y=function(e){return new t(e)},t.min=function(){return new t(new at(0,0))},t.prototype.L=function(t){return this.timestamp.H(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.X=function(){return this.timestamp},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(t){return null==t}function ct(t){return-0===t&&1/t==-1/0}function lt(t){return"number"==typeof t&&Number.isInteger(t)&&!ct(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function pt(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ft(t,e,n,r,i,o,s)}function dt(t){var e=b(t);if(null===e.Z){var n=e.path.R();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.R()+t.op.toString()+ie(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.R()+e.dir;var e})).join(","),ht(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=sr(e.startAt)),e.endAt&&(n+="|ub:",n+=sr(e.endAt)),e.Z=n}return e.Z}function vt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!lr(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!te(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ur(t.startAt,e.startAt)&&ur(t.endAt,e.endAt)}function yt(t){return O.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt,mt,_t=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ut.min()),void 0===o&&(o=ut.min()),void 0===s&&(s=$.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}(),bt=function(t){this.count=t};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(t){switch(t){case c.OK:return m();case c.CANCELLED:case c.UNKNOWN:case c.DEADLINE_EXCEEDED:case c.RESOURCE_EXHAUSTED:case c.INTERNAL:case c.UNAVAILABLE:case c.UNAUTHENTICATED:return!1;case c.INVALID_ARGUMENT:case c.NOT_FOUND:case c.ALREADY_EXISTS:case c.PERMISSION_DENIED:case c.FAILED_PRECONDITION:case c.ABORTED:case c.OUT_OF_RANGE:case c.UNIMPLEMENTED:case c.DATA_LOSS:return!0;default:return m()}}function xt(t){if(void 0===t)return v("GRPC error has no .code"),c.UNKNOWN;switch(t){case gt.OK:return c.OK;case gt.CANCELLED:return c.CANCELLED;case gt.UNKNOWN:return c.UNKNOWN;case gt.DEADLINE_EXCEEDED:return c.DEADLINE_EXCEEDED;case gt.RESOURCE_EXHAUSTED:return c.RESOURCE_EXHAUSTED;case gt.INTERNAL:return c.INTERNAL;case gt.UNAVAILABLE:return c.UNAVAILABLE;case gt.UNAUTHENTICATED:return c.UNAUTHENTICATED;case gt.INVALID_ARGUMENT:return c.INVALID_ARGUMENT;case gt.NOT_FOUND:return c.NOT_FOUND;case gt.ALREADY_EXISTS:return c.ALREADY_EXISTS;case gt.PERMISSION_DENIED:return c.PERMISSION_DENIED;case gt.FAILED_PRECONDITION:return c.FAILED_PRECONDITION;case gt.ABORTED:return c.ABORTED;case gt.OUT_OF_RANGE:return c.OUT_OF_RANGE;case gt.UNIMPLEMENTED:return c.UNIMPLEMENTED;case gt.DATA_LOSS:return c.DATA_LOSS;default:return m()}}(mt=gt||(gt={}))[mt.OK=0]="OK",mt[mt.CANCELLED=1]="CANCELLED",mt[mt.UNKNOWN=2]="UNKNOWN",mt[mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mt[mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mt[mt.NOT_FOUND=5]="NOT_FOUND",mt[mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",mt[mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",mt[mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",mt[mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mt[mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mt[mt.ABORTED=10]="ABORTED",mt[mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",mt[mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",mt[mt.INTERNAL=13]="INTERNAL",mt[mt.UNAVAILABLE=14]="UNAVAILABLE",mt[mt.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Et=function(){function t(t,e){this.i=t,this.root=e||It.EMPTY}return t.prototype.rt=function(e,n){return new t(this.i,this.root.rt(e,n,this.i).copy(null,null,It.ot,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,It.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ut((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new Tt(this.root,null,this.i,!1)},t.prototype._t=function(t){return new Tt(this.root,t,this.i,!1)},t.prototype.ft=function(){return new Tt(this.root,null,this.i,!0)},t.prototype.dt=function(t){return new Tt(this.root,t,this.i,!0)},t}(),Tt=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),It=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.gt()||i.left.left.gt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.Vt()),i.right.m()||i.right.gt()||i.right.left.gt()||(i=i.bt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},t.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},t.prototype.vt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Vt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw m();if(this.right.gt())throw m();var t=this.left.Ct();if(t!==this.right.Ct())throw m();return t+(this.gt()?0:1)},t}();It.EMPTY=null,It.RED=!0,It.ot=!1,It.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw m()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new It(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var At=function(){function t(t){this.i=t,this.data=new Et(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut((function(e,n){return t(e),!1}))},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.xt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new St(this.data.lt())},t.prototype._t=function(t){return new St(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.$t=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),St=function(){function t(t){this.kt=t}return t.prototype.Et=function(){return this.kt.Et().key},t.prototype.It=function(){return this.kt.It()},t}(),Ot=new Et(O.i);function Pt(){return Ot}function Ct(){return Pt()}var Dt=new Et(O.i);function Nt(){return Dt}var Rt=new Et(O.i),Mt=new At(O.i);function Lt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Mt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ut=new At(Q);function kt(){return Ut}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ft=function(){function t(t){this.i=t?function(e,n){return t(e,n)||O.i(e.key,n.key)}:function(t,e){return O.i(t.key,e.key)},this.Mt=Nt(),this.Ot=new Et(this.i)}return t.Lt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Mt.get(t)},t.prototype.get=function(t){return this.Mt.get(t)},t.prototype.first=function(){return this.Ot.at()},t.prototype.last=function(){return this.Ot.ct()},t.prototype.m=function(){return this.Ot.m()},t.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ot.ut((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ot.lt(),r=e.Ot.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Mt=e,r.Ot=n,r},t}(),jt=function(){function t(){this.Bt=new Et(O.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):m():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut((function(e,n){t.push(n)})),t},t}(),Bt=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=a}return t.Kt=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ft.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Xn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Vt=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}return t.Jt=function(e,n){var r=new Map;return r.set(e,Gt.Xt(e,n)),new t(ut.min(),r,kt(),Pt(),Lt())},t}(),Gt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t($.B,n,Lt(),Lt(),Lt())},t}(),zt=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Ht=function(t,e){this.targetId=t,this.re=e},Xt=function(t,e,n,r){void 0===n&&(n=$.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},qt=function(){function t(){this.oe=0,this.ae=Kt(),this.ce=$.B,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.O()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=Lt(),e=Lt(),n=Lt();return this.ae.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:m()}})),new Gt(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=Kt()},t.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ee=function(){this.oe+=1},t.prototype.Ie=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),Yt=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=Pt(),this.ye=Wt(),this.Ve=new At(Q)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Pn?this.be(r,t.ie):t.ie instanceof Cn&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},t.prototype.Se=function(t){var e=this;this.De(t,(function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.Ie(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.Ie(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.Fe(n),r.fe(t.resumeToken));break;default:m()}}))},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach((function(t,r){n.Ne(r)&&e(r)}))},t.prototype.xe=function(t){var e=t.targetId,n=t.re.count,r=this.$e(e);if(r){var i=r.target;if(yt(i))if(0===n){var o=new O(i.path);this.ve(e,o,new Cn(o,ut.min()))}else _(1===n);else this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e))}},t.prototype.Me=function(t){var e=this,n=new Map;this.Pe.forEach((function(r,i){var o=e.$e(i);if(o){if(r.Zt&&yt(o.target)){var s=new O(o.target.path);null!==e.ge.get(s)||e.Oe(i,s)||e.ve(i,s,new Cn(s,t))}r._e&&(n.set(i,r.de()),r.we())}}));var r=Lt();this.ye.forEach((function(t,n){var i=!0;n.Ft((function(t){var n=e.$e(t);return!n||2===n.tt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Vt(t,n,this.Ve,this.ge,r);return this.ge=Pt(),this.ye=Wt(),this.Ve=new At(Q),i},t.prototype.be=function(t,e){if(this.Ne(t)){var n=this.Oe(t,e.key)?2:0;this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t))}},t.prototype.ve=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ee=function(t){this.Ce(t).Ee()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new qt,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new At(Q),this.ye=this.ye.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.$e(t);return e||d("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.$e=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.Fe=function(t){var e=this;this.Pe.set(t,new qt),this.Re.Be(t).forEach((function(n){e.ve(t,n,null)}))},t.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return new Et(O.i)}function Kt(){return new Et(O.i)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zt(t){var e=oe(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $t(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qt(t)?4:10:m()}function te(t,e){var n=$t(t);if(n!==$t(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zt(t).isEqual(Zt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=oe(t.timestampValue),r=oe(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ae(t.bytesValue).isEqual(ae(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return se(t.geoPointValue.latitude)===se(e.geoPointValue.latitude)&&se(t.geoPointValue.longitude)===se(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return se(t.integerValue)===se(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=se(t.doubleValue),r=se(e.doubleValue);return n===r?ct(n)===ct(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Z(t.arrayValue.values||[],e.arrayValue.values||[],te);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(w(n)!==w(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!te(n[i],r[i])))return!1;return!0}(t,e);default:return m()}}function ee(t,e){return void 0!==(t.values||[]).find((function(t){return te(t,e)}))}function ne(t,e){var n=$t(t),r=$t(e);if(n!==r)return Q(n,r);switch(n){case 0:return 0;case 1:return Q(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=se(t.integerValue||t.doubleValue),r=se(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return re(t.timestampValue,e.timestampValue);case 4:return re(Zt(t),Zt(e));case 5:return Q(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ae(t),r=ae(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Q(n[i],r[i]);if(0!==o)return o}return Q(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Q(se(t.latitude),se(e.latitude));return 0!==n?n:Q(se(t.longitude),se(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ne(n[i],r[i]);if(o)return o}return Q(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Q(r[s],o[s]);if(0!==a)return a;var u=ne(n[r[s]],i[o[s]]);if(0!==u)return u}return Q(r.length,o.length)}(t.mapValue,e.mapValue);default:throw m()}}function re(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Q(t,e);var n=oe(t),r=oe(e),i=Q(n.seconds,r.seconds);return 0!==i?i:Q(n.nanos,r.nanos)}function ie(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=oe(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ae(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,O.C(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):m();var n,r}(t)}function oe(t){if(_(!!t),"string"==typeof t){var e=0,n=Jt.exec(t);if(_(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:se(t.seconds),nanos:se(t.nanos)}}function se(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ae(t){return"string"==typeof t?$.fromBase64String(t):$.fromUint8Array(t)}function ue(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function he(t){return!!t&&"integerValue"in t}function ce(t){return!!t&&"arrayValue"in t}function le(t){return!!t&&"nullValue"in t}function fe(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function pe(t){return!!t&&"mapValue"in t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var de={asc:"ASCENDING",desc:"DESCENDING"},ve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ye=function(t,e){this.U=t,this.Ue=e};function ge(t){return{integerValue:""+t}}function me(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ct(e)?"-0":e}}function _e(t,e){return lt(e)?ge(e):me(t,e)}function be(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function we(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function xe(t,e){return be(t,e.X())}function Ee(t){return _(!!t),ut.Y(function(t){var e=oe(t);return new at(e.seconds,e.nanos)}(t))}function Te(t,e){return function(t){return new I(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).R()}function Ie(t){var e=I.P(t);return _(qe(e)),e}function Ae(t,e){return Te(t.U,e.path)}function Se(t,e){var n=Ie(e);return _(n.get(1)===t.U.projectId),_(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new O(De(n))}function Oe(t,e){return Te(t.U,e)}function Pe(t){var e=Ie(t);return 4===e.length?I.g():De(e)}function Ce(t){return new I(["projects",t.U.projectId,"databases",t.U.database]).R()}function De(t){return _(t.length>4&&"documents"===t.get(4)),t.u(5)}function Ne(t,e,n){return{name:Ae(t,e),fields:n.proto.mapValue.fields}}function Re(t,e){var n;if(e instanceof gn)n={update:Ne(t,e.key,e.value)};else if(e instanceof En)n={delete:Ae(t,e.key)};else if(e instanceof mn)n={update:Ne(t,e.key,e.data),updateMask:Xe(e.Qe)};else if(e instanceof bn)n={transform:{document:Ae(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ze)return{fieldPath:e.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof Je)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof tn)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof nn)return{fieldPath:e.field.R(),increment:n.We};throw m()}(0,t)}))}};else{if(!(e instanceof Tn))return m();n={verify:Ae(t,e.key)}}return e.Ke.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:xe(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m()}(t,e.Ke)),n}function Me(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?hn.updateTime(Ee(t.updateTime)):void 0!==t.exists?hn.exists(t.exists):hn.Ge()}(e.currentDocument):hn.Ge();if(e.update){e.update.name;var r=Se(t,e.update.name),i=new In({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new sn(e.map((function(t){return S.S(t)})))}(e.updateMask);return new mn(r,i,o,n)}return new gn(r,i,n)}if(e.delete){var s=Se(t,e.delete);return new En(s,n)}if(e.transform){var a=Se(t,e.transform.document),u=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)_("REQUEST_TIME"===e.setToServerValue),n=new Ze;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Je(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new tn(i)}else"increment"in e?n=new nn(t,e.increment):m();var o=S.S(e.fieldPath);return new an(o,n)}(t,e)}));return _(!0===n.exists),new bn(a,u)}if(e.verify){var h=Se(t,e.verify);return new Tn(h,n)}return m()}function Le(t,e){return{documents:[Oe(t,e.path)]}}function Ue(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Oe(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Oe(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(fe(t.value))return{unaryFilter:{field:Ve(t.field),op:"IS_NAN"}};if(le(t.value))return{unaryFilter:{field:Ve(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(fe(t.value))return{unaryFilter:{field:Ve(t.field),op:"IS_NOT_NAN"}};if(le(t.value))return{unaryFilter:{field:Ve(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ve(t.field),op:Be(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ve(t.field),direction:je(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||ht(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ke(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ke(e.endAt)),n}function ke(t){return{before:t.before,values:t.position}}function Fe(t){var e=!!t.before,n=t.values||[];return new or(n,e)}function je(t){return de[t]}function Be(t){return ve[t]}function Ve(t){return{fieldPath:t.R()}}function Ge(t){return S.S(t.fieldPath)}function ze(t){return Qn.create(Ge(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return m()}}(t.fieldFilter.op),t.fieldFilter.value)}function He(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ge(t.unaryFilter.field);return Qn.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ge(t.unaryFilter.field);return Qn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ge(t.unaryFilter.field);return Qn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ge(t.unaryFilter.field);return Qn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return m()}}function Xe(t){var e=[];return t.fields.forEach((function(t){return e.push(t.R())})),{fieldPaths:e}}function qe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye=function(){this.ze=void 0};function We(t,e,n){return t instanceof Ze?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Je?$e(t,e):t instanceof tn?en(t,e):function(t,e){var n=Qe(t,e),r=rn(n)+rn(t.We);return he(n)&&he(t.We)?ge(r):me(t.serializer,r)}(t,e)}function Ke(t,e,n){return t instanceof Je?$e(t,e):t instanceof tn?en(t,e):n}function Qe(t,e){return t instanceof nn?he(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(Ye),Je=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(Ye);function $e(t,e){for(var n=on(e),r=function(t){n.some((function(e){return te(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var tn=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return r.__extends(e,t),e}(Ye);function en(t,e){for(var n=on(e),r=function(t){n=n.filter((function(e){return!te(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var nn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return r.__extends(e,t),e}(Ye);function rn(t){return se(t.integerValue||t.doubleValue)}function on(t){return ce(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn=function(){function t(t){this.fields=t,t.sort(S.i)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return Z(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),an=function(t,e){this.field=t,this.transform=e},un=function(t,e){this.version=t,this.transformResults=e},hn=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function cn(t,e){return void 0!==t.updateTime?e instanceof Pn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Pn}var ln=function(){};function fn(t,e,n){return t instanceof gn?function(t,e,n){return new Pn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof mn?function(t,e,n){if(!cn(t.Ke,e))return new Dn(t.key,n.version);var r=_n(t,e);return new Pn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof bn?function(t,e,n){if(_(null!=n.transformResults),!cn(t.Ke,e))return new Dn(t.key,n.version);var r=wn(t,e),i=function(t,e,n){var r=[];_(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof Pn&&(a=e.field(o.field)),r.push(Ke(s,a,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=xn(t,r.data(),i);return new Pn(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Cn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function pn(t,e,n,r){return t instanceof gn?function(t,e){if(!cn(t.Ke,e))return e;var n=yn(e);return new Pn(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof mn?function(t,e){if(!cn(t.Ke,e))return e;var n=yn(e),r=_n(t,e);return new Pn(t.key,n,r,{Ye:!0})}(t,e):t instanceof bn?function(t,e,n,r){if(!cn(t.Ke,e))return e;var i=wn(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,h=null;n instanceof Pn&&(h=n.field(a.field)),null===h&&r instanceof Pn&&(h=r.field(a.field)),i.push(We(u,h,e))}return i}(t.fieldTransforms,n,e,r),s=xn(t,i.data(),o);return new Pn(t.key,i.version,s,{Ye:!0})}(t,e,r,n):function(t,e){return cn(t.Ke,e)?new Cn(t.key,ut.min()):e}(t,e)}function dn(t,e){return t instanceof bn?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Pn?e.field(o.field):void 0,a=Qe(o.transform,s||null);null!=a&&(n=null==n?(new An).set(o.field,a):n.set(o.field,a))}return n?n.Je():null}(t,e):null}function vn(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Z(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Je&&e instanceof Je||t instanceof tn&&e instanceof tn?Z(t.elements,e.elements,te):t instanceof nn&&e instanceof nn?te(t.We,e.We):t instanceof Ze&&e instanceof Ze}(t.transform,e.transform)}(t,e)})))}function yn(t){return t instanceof Pn?t.version:ut.min()}var gn=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ke=r,i.type=0,i}return r.__extends(e,t),e}(ln),mn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ke=i,o.type=1,o}return r.__extends(e,t),e}(ln);function _n(t,e){return function(t,e){var n=new An(e);return t.Qe.fields.forEach((function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Je()}(t,e instanceof Pn?e.data():In.empty())}var bn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ke=hn.exists(!0),r}return r.__extends(e,t),e}(ln);function wn(t,e){return e}function xn(t,e,n){for(var r=new An(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var En=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=3,r}return r.__extends(e,t),e}(ln),Tn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=4,r}return r.__extends(e,t),e}(ln),In=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!pe(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return te(this.proto,t.proto)},t}(),An=function(){function t(t){void 0===t&&(t=In.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===$t(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Je=function(){var t=this.en(S.g(),this.Ze);return null!=t?new In(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=pe(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Sn(t){var e=[];return x(t.fields||{},(function(t,n){var r=new S([t]);if(pe(n)){var i=Sn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new sn(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var On=function(t,e){this.key=t,this.version=e},Pn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).nn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return r.__extends(e,t),e.prototype.field=function(t){return this.nn.field(t)},e.prototype.data=function(){return this.nn},e.prototype.sn=function(){return this.nn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(On),Cn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return r.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(On),Dn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(On),Nn=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=a,this.an=null,this.cn=null,this.startAt,this.endAt};function Rn(t,e,n,r,i,o,s,a){return new Nn(t,e,n,r,i,o,s,a)}function Mn(t){return new Nn(t)}function Ln(t){return!ht(t.limit)&&"F"===t.on}function Un(t){return!ht(t.limit)&&"L"===t.on}function kn(t){return t.rn.length>0?t.rn[0].field:null}function Fn(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function jn(t){return null!==t.collectionGroup}function Bn(t){var e=b(t);if(null===e.an){e.an=[];var n=Fn(e),r=kn(e);if(null!==n&&null===r)n.p()||e.an.push(new hr(n)),e.an.push(new hr(S.v(),"asc"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var a=s[o];e.an.push(a),a.field.p()&&(i=!0)}if(!i){var u=e.rn.length>0?e.rn[e.rn.length-1].dir:"asc";e.an.push(new hr(S.v(),u))}}}return e.an}function Vn(t){var e=b(t);if(!e.cn)if("F"===e.on)e.cn=pt(e.path,e.collectionGroup,Bn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Bn(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new hr(o.field,s))}var a=e.endAt?new or(e.endAt.position,!e.endAt.before):null,u=e.startAt?new or(e.startAt.position,!e.startAt.before):null;e.cn=pt(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.cn}function Gn(t,e,n){return new Nn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zn(t,e){return new Nn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Hn(t,e){return new Nn(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Xn(t,e){return vt(Vn(t),Vn(e))&&t.on===e.on}function qn(t){return dt(Vn(t))+"|lt:"+t.on}function Yn(t){return"Query(target="+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.R()+" "+e.op+" "+ie(e.value);var e})).join(", ")+"]"),ht(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.R()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+sr(t.startAt)),t.endAt&&(e+=", endAt: "+sr(t.endAt)),"Target("+e+")"}(Vn(t))+"; limitType="+t.on+")"}function Wn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):O.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ar(t.startAt,Bn(t),e)||t.endAt&&ar(t.endAt,Bn(t),e))}(t,e)}function Kn(t){return function(e,n){for(var r=!1,i=0,o=Bn(t);i<o.length;i++){var s=o[i],a=cr(s,e,n);if(0!==a)return a;r=r||s.field.p()}return 0}}var Qn=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return r.__extends(e,t),e.create=function(t,n,r){if(t.p())return"in"===n||"not-in"===n?this.hn(t,n,r):new Zn(t,n,r);if(le(r)){if("=="!==n&&"!="!==n)throw new l(c.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new e(t,n,r)}if(fe(r)){if("=="!==n&&"!="!==n)throw new l(c.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new e(t,n,r)}return"array-contains"===n?new er(t,r):"in"===n?new nr(t,r):"not-in"===n?new rr(t,r):"array-contains-any"===n?new ir(t,r):new e(t,n,r)},e.hn=function(t,e,n){return"in"===e?new Jn(t,n):new $n(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(ne(e,this.value)):null!==e&&$t(this.value)===$t(e)&&this.ln(ne(e,this.value))},e.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return m()}},e.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Zn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=O.C(r.referenceValue),i}return r.__extends(e,t),e.prototype.matches=function(t){var e=O.i(t.key,this.key);return this.ln(e)},e}(Qn),Jn=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=tr("in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Qn),$n=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=tr("not-in",n),r}return r.__extends(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Qn);function tr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return O.C(t.referenceValue)}))}var er=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return ce(e)&&ee(e.arrayValue,this.value)},e}(Qn),nr=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ee(this.value.arrayValue,e)},e}(Qn),rr=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){if(ee(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ee(this.value.arrayValue,e)},e}(Qn),ir=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return r.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ce(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ee(e.value.arrayValue,t)}))},e}(Qn),or=function(t,e){this.position=t,this.before=e};function sr(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ie(t)})).join(",")}function ar(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.p()?O.i(O.C(s.referenceValue),n.key):ne(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ur(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!te(t.position[n],e.position[n]))return!1;return!0}var hr=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function cr(t,e,n){var r=t.field.p()?O.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ne(r,i):m()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return m()}}function lr(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},pr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.An=function(){this.Tn=this.mn},t.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&d("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,(function(){return e.In=Date.now(),t()})),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},t.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},t}(),dr=function(){function t(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t((function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)}),(function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Sn&&m(),this.Sn=!0,this.vn?this.error?this.Dn(n,this.error):this.Cn(e,this.result):new t((function(t,i){r.pn=function(n){r.Cn(e,n).next(t,i)},r.bn=function(e){r.Dn(n,e).next(t,i)}}))},t.prototype.Nn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Cn=function(e,n){return e?this.Fn((function(){return e(n)})):t.resolve(n)},t.prototype.Dn=function(e,n){return e?this.Fn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.xn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.$n=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.xn(r)},t}(),vr=function(){function e(t,n,r){this.name=t,this.version=n,this.kn=r,12.2===e.Mn(s.getUA())&&v("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return d("SimpleDb","Removing database:",t),wr(window.indexedDB.deleteDatabase(t)).Nn()},e.On=function(){if("undefined"==typeof indexedDB)return!1;if(e.Ln())return!0;var t=s.getUA(),n=e.Mn(t),r=0<n&&n<10,i=e.Bn(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.Ln=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.qn)},e.Un=function(t,e){return t.store(e)},e.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Bn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Qn=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:return this.db?[3,2]:(d("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,n){var r=indexedDB.open(e.name,e.version);r.onsuccess=function(e){var n=e.target.result;t(n)},r.onblocked=function(){n(new gr("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){var e=t.target.error;"VersionError"===e.name?n(new l(c.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new gr(e))},r.onupgradeneeded=function(t){d("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;e.kn.createOrUpgrade(n,r.transaction,t.oldVersion,e.version).next((function(){d("SimpleDb","Database upgrade to version "+e.version+" complete")}))}}))]);case 1:t.db=n.sent(),n.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return e.Wn(t)}),this.db)]}}))}))},e.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a,u;return r.__generator(this,(function(h){switch(h.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,u,h,c;return r.__generator(this,(function(r){switch(r.label){case 0:++o,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,a.Qn()];case 2:return a.db=r.sent(),t=_r.open(a.db,i?"readonly":"readwrite",e),s=n(t).catch((function(e){return t.abort(e),dr.reject(e)})).Nn(),u={},s.catch((function(){})),[4,t.Kn];case 3:return[2,(u.value=(r.sent(),s),u)];case 4:return h=r.sent(),c="FirebaseError"!==h.name&&o<3,d("SimpleDb","Transaction failed with error:",h.message,"Retrying:",c),a.close(),c?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=h.sent()))return[2,u.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),yr=function(){function t(t){this.Gn=t,this.zn=!1,this.Hn=null}return Object.defineProperty(t.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.zn=!0},t.prototype.Jn=function(t){this.Hn=t},t.prototype.delete=function(){return wr(this.Gn.delete())},t}(),gr=function(t){function e(e){var n=this;return(n=t.call(this,c.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return r.__extends(e,t),e}(l);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t){return"IndexedDbTransactionError"===t.name}var _r=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.Xn=new fr,this.transaction.oncomplete=function(){e.Xn.resolve()},this.transaction.onabort=function(){t.error?e.Xn.reject(new gr(t.error)):e.Xn.resolve()},this.transaction.onerror=function(t){var n=Er(t.target.error);e.Xn.reject(new gr(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new gr(e)}},Object.defineProperty(t.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(d("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new br(e)},t}(),br=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(d("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(d("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),wr(n)},t.prototype.add=function(t){return d("SimpleDb","ADD",this.store.name,t,t),wr(this.store.add(t))},t.prototype.get=function(t){var e=this;return wr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),d("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return d("SimpleDb","DELETE",this.store.name,t),wr(this.store.delete(t))},t.prototype.count=function(){return d("SimpleDb","COUNT",this.store.name),wr(this.store.count())},t.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.es=function(t,e){d("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,(function(t,e,n){return n.delete()}))},t.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},t.prototype.rs=function(t){var e=this.cursor({});return new dr((function(n,r){e.onerror=function(t){var e=Er(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.ts=function(t,e){var n=[];return new dr((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new yr(i),s=e(i.primaryKey,i.value,o);if(s instanceof dr){var a=s.catch((function(t){return o.done(),dr.reject(t)}));n.push(a)}o.vn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}})).next((function(){return dr.xn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function wr(t){return new dr((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Er(t.target.error);n(e)}}))}var xr=!1;function Er(t){var e=vr.Mn(s.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new l("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return xr||(xr=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(){return"undefined"!=typeof window?window:null}function Ir(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar=function(){function t(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new fr,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch((function(t){}))}return t.ls=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this._s=setTimeout((function(){return e.fs()}),t)},t.prototype.Vn=function(){return this.fs()},t.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new l(c.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.fs=function(){var t=this;this.os.ds((function(){return null!==t._s?(t.clearTimeout(),t.op().then((function(e){return t.hs.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},t}(),Sr=function(){function t(){var t=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new pr(this,"async_queue_retry"),this.ys=function(){var e=Ir();e&&d("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.gs.yn()};var e=Ir();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),t.prototype.ds=function(t){this.enqueue(t)},t.prototype.ps=function(t){this.bs(),this.vs(t)},t.prototype.Ss=function(){if(!this.Es){this.Es=!0;var t=Ir();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise((function(t){})):this.vs(t)},t.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds((function(){return e.Cs()}))},t.prototype.Cs=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!mr(t=n.sent()))throw t;return d("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.gs.Rn((function(){return e.Cs()})),n.label=5;case 5:return[2]}}))}))},t.prototype.vs=function(t){var e=this,n=this.ws.then((function(){return e.Rs=!0,t().catch((function(t){throw e.As=t,e.Rs=!1,v("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Rs=!1,t}))}));return this.ws=n,n},t.prototype.gn=function(t,e,n){var r=this;this.bs(),this.Ps.indexOf(t)>-1&&(e=0);var i=Ar.ls(this,t,e,n,(function(t){return r.Ns(t)}));return this.Is.push(i),i},t.prototype.bs=function(){this.As&&m()},t.prototype.Fs=function(){},t.prototype.xs=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.ws];case 1:e.sent(),e.label=2;case 2:if(t!==this.ws)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$s=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},t.prototype.ks=function(t){var e=this;return this.xs().then((function(){e.Is.sort((function(t,e){return t.cs-e.cs}));for(var n=0,r=e.Is;n<r.length;n++){var i=r[n];if(i.Vn(),"all"!==t&&i.fn===t)break}return e.xs()}))},t.prototype.Ms=function(t){this.Ps.push(t)},t.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},t}();function Or(t,e){if(v("AsyncQueue",e+": "+t),mr(t))return new l(c.UNAVAILABLE,e+": "+t);throw t}var Pr=function(){this.Os=void 0,this.listeners=[]},Cr=function(){this.Ls=new st((function(t){return qn(t)}),Xn),this.onlineState="Unknown",this.Bs=new Set};function Dr(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:if(n=b(t),i=e.query,o=!1,(s=n.Ls.get(i))||(o=!0,s=new Pr),!o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),a=s,[4,n.qs(i)];case 2:return a.Os=r.sent(),[3,4];case 3:return u=r.sent(),h=Or(u,"Initialization of query '"+Yn(e.query)+"' failed"),[2,void e.onError(h)];case 4:return n.Ls.set(i,s),s.listeners.push(e),e.Us(n.onlineState),s.Os&&e.Qs(s.Os)&&Lr(n),[2]}}))}))}function Nr(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a;return r.__generator(this,(function(r){return n=b(t),i=e.query,o=!1,(s=n.Ls.get(i))&&(a=s.listeners.indexOf(e))>=0&&(s.listeners.splice(a,1),o=0===s.listeners.length),o?[2,(n.Ls.delete(i),n.Ws(i))]:[2]}))}))}function Rr(t,e){for(var n=b(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.Ls.get(a);if(u){for(var h=0,c=u.listeners;h<c.length;h++)c[h].Qs(s)&&(r=!0);u.Os=s}}r&&Lr(n)}function Mr(t,e,n){var r=b(t),i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}function Lr(t){t.Bs.forEach((function(t){t.next()}))}var Ur=function(){function t(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bt(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},t.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},t.prototype.zs=function(t){if(t.docChanges.length>0)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=Bt.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},t}(),kr=function(){function t(t){this.uid=t}return t.prototype.Xs=function(){return null!=this.uid},t.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kr.UNAUTHENTICATED=new kr(null),kr.ti=new kr("google-credentials-uid"),kr.ei=new kr("first-party-uid");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}return t.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},t}();function jr(t,e){return"firestore_clients_"+t+"_"+e}function Br(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Xs()&&(r+="_"+e.uid),r}function Vr(t,e){return"firestore_targets_"+t+"_"+e}Fr.oi=-1;var Gr=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ai=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new l(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(v("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),zr=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ai=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new l(r.error.code,r.error.message)),i?new t(e,r.state,o):(v("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Hr=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ai=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=kt(),s=0;i&&s<r.activeTargetIds.length;++s)i=lt(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(v("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Xr=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ai=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(v("SharedClientState","Failed to parse online state: "+e),null)},t}(),qr=function(){function t(){this.activeTargetIds=kt()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Yr=function(){function t(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new Et(Q),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=jr(this.persistenceKey,this.li),this.Ai=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.mi=this.mi.rt(this.li,new qr),this.Ri=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.di)}return t.On=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n,i,o,s,a,u,h,c,l,f=this;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this._i.Vi()];case 1:for(t=r.sent(),e=0,n=t;e<n.length;e++)(i=n[e])!==this.li&&(o=this.getItem(jr(this.persistenceKey,i)))&&(s=Hr.ai(i,o))&&(this.mi=this.mi.rt(s.clientId,s));for(this.pi(),(a=this.storage.getItem(this.yi))&&(u=this.bi(a))&&this.vi(u),h=0,c=this.Ei;h<c.length;h++)l=c[h],this.wi(l);return this.Ei=[],this.window.addEventListener("unload",(function(){return f.Si()})),this.Ti=!0,[2]}}))}))},t.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},t.prototype.Di=function(){return this.Ci(this.mi)},t.prototype.Ni=function(t){var e=!1;return this.mi.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Fi=function(t){this.xi(t,"pending")},t.prototype.$i=function(t,e,n){this.xi(t,e,n),this.ki(t)},t.prototype.Mi=function(t){var e="not-current";if(this.Ni(t)){var n=this.storage.getItem(Vr(this.persistenceKey,t));if(n){var r=zr.ai(t,n);r&&(e=r.state)}}return this.Oi.ui(t),this.pi(),e},t.prototype.Li=function(t){this.Oi.hi(t),this.pi()},t.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},t.prototype.qi=function(t){this.removeItem(Vr(this.persistenceKey,t))},t.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach((function(t){r.ki(t)})),this.currentUser=t,n.forEach((function(t){r.Fi(t)}))},t.prototype.ji=function(t){this.Ki(t)},t.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return d("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){d("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){d("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wi=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(d("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ii)return void v("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds((function(){return r.__awaiter(e,void 0,void 0,(function(){var t,e,i,o,s,a;return r.__generator(this,(function(r){if(this.Ti){if(null!==n.key)if(this.Ri.test(n.key)){if(null==n.newValue)return t=this.Gi(n.key),[2,this.zi(t,null)];if(e=this.Hi(n.key,n.newValue))return[2,this.zi(e.clientId,e)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(i=this.Yi(n.key,n.newValue)))return[2,this.Ji(i)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(o=this.Xi(n.key,n.newValue)))return[2,this.Zi(o)]}else if(n.key===this.yi){if(null!==n.newValue&&(s=this.bi(n.newValue)))return[2,this.vi(s)]}else n.key===this.Ai&&(a=function(t){var e=Fr.oi;if(null!=t)try{var n=JSON.parse(t);_("number"==typeof n),e=n}catch(t){v("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Fr.oi&&this.ni(a)}else this.Ei.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),t.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},t.prototype.xi=function(t,e,n){var r=new Gr(this.currentUser,t,e,n),i=Br(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.ki=function(t){var e=Br(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ki=function(t){var e={clientId:this.li,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},t.prototype.Qi=function(t,e,n){var r=Vr(this.persistenceKey,t),i=new zr(t,e,n);this.setItem(r,i.ci())},t.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},t.prototype.Hi=function(t,e){var n=this.Gi(t);return Hr.ai(n,e)},t.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Gr.ai(new kr(i),r,e)},t.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return zr.ai(r,e)},t.prototype.bi=function(t){return Xr.ai(t)},t.prototype.Ji=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._i.tr(t.batchId,t.state,t.error)]:(d("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},t.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this._i.nr(s,a).then((function(){n.mi=r}))},t.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},t.prototype.Ci=function(t){var e=kt();return t.forEach((function(t,n){e=e.$t(n.activeTargetIds)})),e},t}(),Wr=function(){function t(){this.sr=new qr,this.ir={},this.fi=null,this.ni=null}return t.prototype.Fi=function(t){},t.prototype.$i=function(t,e,n){},t.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},t.prototype.Ui=function(t,e,n){this.ir[t]=e},t.prototype.Li=function(t){this.sr.hi(t)},t.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.qi=function(t){delete this.ir[t]},t.prototype.Di=function(){return this.sr.activeTargetIds},t.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.start=function(){return this.sr=new qr,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Si=function(){},t.prototype.ri=function(t){},t}(),Kr=function(){function t(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}return t.prototype.ar=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=fn(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=pn(i,e,e,this.rr))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=pn(u,e,o,this.rr))}return e},t.prototype.hr=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Lt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Z(this.mutations,t.mutations,(function(t,e){return vn(t,e)}))&&Z(this.baseMutations,t.baseMutations,(function(t,e){return vn(t,e)}))},t}(),Qr=function(){function t(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}return t.from=function(e,n,r){_(e.mutations.length===r.length);for(var i=Rt,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Zr=function(){function t(){this.dr=new st((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.wr=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},t.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},t.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?dr.resolve(n):this.Rr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},t.prototype.Er=function(){},t}(),Jr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",$r=function(){function t(){this.yr=[]}return t.prototype.Vr=function(t){this.yr.push(t)},t.prototype.pr=function(){this.yr.forEach((function(t){return t()}))},t}(),ti=function(){function t(t,e,n){this.br=t,this.vr=e,this.Sr=n}return t.prototype.Dr=function(t,e){var n=this;return this.vr.Cr(t,e).next((function(r){return n.Nr(t,e,r)}))},t.prototype.Nr=function(t,e,n){return this.br.Ar(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t}))},t.prototype.Fr=function(t,e,n){var r=Ct();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.rt(t,e)})),r},t.prototype.$r=function(t,e){var n=this;return this.br.getEntries(t,e).next((function(e){return n.kr(t,e)}))},t.prototype.kr=function(t,e){var n=this;return this.vr.Mr(t,e).next((function(r){var i=n.Fr(t,e,r),o=Pt();return i.forEach((function(t,e){e||(e=new Cn(t,ut.min())),o=o.rt(t,e)})),o}))},t.prototype.Or=function(t,e,n){return function(t){return O.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Lr(t,e.path):jn(e)?this.Br(t,e,n):this.qr(t,e,n)},t.prototype.Lr=function(t,e){return this.Dr(t,new O(e)).next((function(t){var e=Nt();return t instanceof Pn&&(e=e.rt(t.key,t)),e}))},t.prototype.Br=function(t,e,n){var r=this,i=e.collectionGroup,o=Nt();return this.Sr.Ur(t,i).next((function(s){return dr.forEach(s,(function(s){var a=function(t,e){return new Nn(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(e,s.child(i));return r.qr(t,a,n).next((function(t){t.forEach((function(t,e){o=o.rt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.qr=function(t,e,n){var r,i,o=this;return this.br.Or(t,e,n).next((function(n){return r=n,o.vr.Qr(t,e)})).next((function(e){return i=e,o.Wr(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],h=u.key,c=r.get(h),l=pn(u,c,c,o.rr);r=l instanceof Pn?r.rt(h,l):r.remove(h)}}))})).next((function(){return r.forEach((function(t,n){Wn(e,n)||(r=r.remove(t))})),r}))},t.prototype.Wr=function(t,e,n){for(var r=Lt(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof mn&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.br.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Pn&&(h=h.rt(t,e))})),h}))},t}(),ei=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}return t.Gr=function(e,n){for(var r=Lt(),i=Lt(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}();
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Q(n,i);return 0===s?Q(r,o):s}var ri=function(){function t(t){this.zr=t,this.buffer=new At(ni),this.Hr=0}return t.prototype.Yr=function(){return++this.Hr},t.prototype.Jr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.zr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ni(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ii={Xr:!1,Zr:0,eo:0,no:0},oi=function(){function t(t,e,n){this.so=t,this.io=e,this.ro=n}return t.oo=function(e){return new t(e,t.ao,t.co)},t}();oi.uo=-1,oi.ho=1048576,oi.lo=41943040,oi.ao=10,oi.co=1e3,oi._o=new oi(oi.lo,oi.ao,oi.co),oi.fo=new oi(oi.uo,0,0);var si=function(){function t(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}return t.prototype.start=function(t){this.do.params.so!==oi.uo&&this.To(t)},t.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(t.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),t.prototype.To=function(t){var e=this,n=this.wo?3e5:6e4;d("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.mo=this.os.gn("lru_garbage_collection",n,(function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:this.mo=null,this.wo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Eo(this.do)];case 2:return n.sent(),[3,7];case 3:return mr(e=n.sent())?(d("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Eo(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.To(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),ai=function(){function t(t,e){this.Io=t,this.params=e}return t.prototype.Ao=function(t,e){return this.Io.Ro(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Po=function(t,e){var n=this;if(0===e)return dr.resolve(Fr.oi);var r=new ri(e);return this.Io.De(t,(function(t){return r.Jr(t.sequenceNumber)})).next((function(){return n.Io.yo(t,(function(t){return r.Jr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},t.prototype.po=function(t,e){return this.Io.po(t,e)},t.prototype.bo=function(t,e){var n=this;return this.params.so===oi.uo?(d("LruGarbageCollector","Garbage collection skipped; disabled"),dr.resolve(ii)):this.vo(t).next((function(r){return r<n.params.so?(d("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.so),ii):n.So(t,e)}))},t.prototype.vo=function(t){return this.Io.vo(t)},t.prototype.So=function(t,e){var n,r,i,s,a,u,h,c=this,l=Date.now();return this.Ao(t,this.params.io).next((function(e){return e>c.params.ro?(d("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.ro+" from "+e),r=c.params.ro):r=e,s=Date.now(),c.Po(t,r)})).next((function(r){return n=r,a=Date.now(),c.Vo(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.po(t,n)})).next((function(t){return h=Date.now(),p()<=o.LogLevel.DEBUG&&d("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-s)+"ms\n\tRemoved "+i+" targets in "+(u-a)+"ms\n\tRemoved "+t+" documents in "+(h-u)+"ms\nTotal Duration: "+(h-l)+"ms"),dr.resolve({Xr:!0,Zr:r,eo:i,no:t})}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ci(e)),e=hi(t.get(n),e);return ci(e)}function hi(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ci(t){return t+""}function li(t){var e=t.length;if(_(e>=2),2===e)return _(""===t.charAt(0)&&""===t.charAt(1)),I.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&m(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:m()}o=s+2}return new I(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fi=function(t){this.Do=t};function pi(t,e){if(e.document)return function(t,e,n){var r=Se(t,e.name),i=Ee(e.updateTime),o=new In({mapValue:{fields:e.fields}});return new Pn(r,i,o,{hasCommittedMutations:!!n})}(t.Do,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=O.$(e.noDocument.path),r=mi(e.noDocument.readTime);return new Cn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=O.$(e.unknownDocument.path),o=mi(e.unknownDocument.version);return new Dn(i,o)}return m()}function di(t,e,n){var r=vi(n),i=e.key.path.h().A();if(e instanceof Pn){var o=function(t,e){return{name:Ae(t,e.key),fields:e.sn().mapValue.fields,updateTime:be(t,e.version.X())}}(t.Do,e),s=e.hasCommittedMutations;return new zi(null,null,o,s,r,i)}if(e instanceof Cn){var a=e.key.path.A(),u=gi(e.version),h=e.hasCommittedMutations;return new zi(null,new Vi(a,u),null,h,r,i)}if(e instanceof Dn){var c=e.key.path.A(),l=gi(e.version);return new zi(new Gi(c,l),null,null,!0,r,i)}return m()}function vi(t){var e=t.X();return[e.seconds,e.nanoseconds]}function yi(t){var e=new at(t[0],t[1]);return ut.Y(e)}function gi(t){var e=t.X();return new Ui(e.seconds,e.nanoseconds)}function mi(t){var e=new at(t.seconds,t.nanoseconds);return ut.Y(e)}function _i(t,e){var n=(e.baseMutations||[]).map((function(e){return Me(t.Do,e)})),r=e.mutations.map((function(e){return Me(t.Do,e)})),i=at.fromMillis(e.localWriteTimeMs);return new Kr(e.batchId,i,n,r)}function bi(t){var e,n,r=mi(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?mi(t.lastLimboFreeSnapshotVersion):ut.min();return void 0!==t.query.documents?(_(1===(n=t.query).documents.length),e=Vn(Mn(Pe(n.documents[0])))):e=function(t){var e=Pe(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[He(e)]:void 0!==e.fieldFilter?[ze(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):m():[]}(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new hr(Ge(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ht(e="object"==typeof t?t.value:t)?null:e}(n.limit));var h=null;n.startAt&&(h=Fe(n.startAt));var c=null;return n.endAt&&(c=Fe(n.endAt)),Vn(Rn(e,i,a,s,u,"F",h,c))}(t.query),new _t(e,t.targetId,0,t.lastListenSequenceNumber,r,i,$.fromBase64String(t.resumeToken))}function wi(t,e){var n,r=gi(e.et),i=gi(e.lastLimboFreeSnapshotVersion);n=yt(e.target)?Le(t.Do,e.target):Ue(t.Do,e.target);var o=e.resumeToken.toBase64();return new Xi(e.targetId,dt(e.target),r,o,e.sequenceNumber,i,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}return t.Fo=function(e,n,r,i){return _(""!==e.uid),new t(e.Xs()?e.uid:"",n,r,i)},t.prototype.xo=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ii(t).ss({index:ji.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.$o=function(t,e,n,r){var i=this,o=Ai(t),s=Ii(t);return s.add({}).next((function(a){_("number"==typeof a);for(var u=new Kr(a,e,n,r),h=function(t,e,n){var r=n.baseMutations.map((function(e){return Re(t.Do,e)})),i=n.mutations.map((function(e){return Re(t.Do,e)}));return new ji(e,n.batchId,n.rr.toMillis(),r,i)}(i.serializer,i.userId,u),c=[],l=new At((function(t,e){return Q(t.R(),e.R())})),f=0,p=r;f<p.length;f++){var d=p[f],v=Bi.key(i.userId,d.key.path,a);l=l.add(d.key.path.h()),c.push(s.put(h)),c.push(o.put(v,Bi.PLACEHOLDER))}return l.forEach((function(e){c.push(i.Sr.ko(t,e))})),t.Vr((function(){i.No[a]=u.keys()})),dr.xn(c).next((function(){return u}))}))},t.prototype.Mo=function(t,e){var n=this;return Ii(t).get(e).next((function(t){return t?(_(t.userId===n.userId),_i(n.serializer,t)):null}))},t.prototype.Oo=function(t,e){var n=this;return this.No[e]?dr.resolve(this.No[e]):this.Mo(t,e).next((function(t){if(t){var r=t.keys();return n.No[e]=r,r}return null}))},t.prototype.Lo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ii(t).ss({index:ji.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(_(e.batchId>=r),o=_i(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ii(t).ss({index:ji.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ii(t).Zn(ji.userMutationsIndex,n).next((function(t){return t.map((function(t){return _i(e.serializer,t)}))}))},t.prototype.Cr=function(t,e){var n=this,r=Bi.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ai(t).ss({range:i},(function(r,i,s){var a=r[0],u=r[1],h=r[2],c=li(u);if(a===n.userId&&e.path.isEqual(c))return Ii(t).get(h).next((function(t){if(!t)throw m();_(t.userId===n.userId),o.push(_i(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.Mr=function(t,e){var n=this,r=new At(Q),i=[];return e.forEach((function(e){var o=Bi.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Ai(t).ss({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],h=li(a);s===n.userId&&e.path.isEqual(h)?r=r.add(u):o.done()}));i.push(a)})),dr.xn(i).next((function(){return n.Uo(t,r)}))},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Bi.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new At(Q);return Ai(t).ss({range:s},(function(t,e,o){var s=t[0],u=t[1],h=t[2],c=li(u);s===n.userId&&r.T(c)?c.length===i&&(a=a.add(h)):o.done()})).next((function(){return n.Uo(t,a)}))},t.prototype.Uo=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ii(t).get(e).next((function(t){if(null===t)throw m();_(t.userId===n.userId),r.push(_i(n.serializer,t))})))})),dr.xn(i).next((function(){return r}))},t.prototype.Qo=function(t,e){var n=this;return Ti(t.Wo,this.userId,e).next((function(r){return t.Vr((function(){n.jo(e.batchId)})),dr.forEach(r,(function(e){return n.Co.Ko(t,e)}))}))},t.prototype.jo=function(t){delete this.No[t]},t.prototype.Go=function(t){var e=this;return this.xo(t).next((function(n){if(!n)return dr.resolve();var r=IDBKeyRange.lowerBound(Bi.prefixForUser(e.userId)),i=[];return Ai(t).ss({range:r},(function(t,n,r){if(t[0]===e.userId){var o=li(t[1]);i.push(o)}else r.done()})).next((function(){_(0===i.length)}))}))},t.prototype.zo=function(t,e){return Ei(t,this.userId,e)},t.prototype.Ho=function(t){var e=this;return Si(t).get(this.userId).next((function(t){return t||new Fi(e.userId,-1,"")}))},t}();function Ei(t,e,n){var r=Bi.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ai(t).ss({range:o,ns:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Ti(t,e,n){var r=t.store(ji.store),i=t.store(Bi.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.ss({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){_(1===a)})));for(var h=[],c=0,l=n.mutations;c<l.length;c++){var f=l[c],p=Bi.key(e,f.key.path,n.batchId);o.push(i.delete(p)),h.push(f.key)}return dr.xn(o).next((function(){return h}))}function Ii(t){return ao.Un(t,ji.store)}function Ai(t){return ao.Un(t,Bi.store)}function Si(t){return ao.Un(t,Fi.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oi=function(){function t(t,e){this.serializer=t,this.Sr=e}return t.prototype.Tr=function(t,e,n){return Ci(t).put(Di(e),n)},t.prototype.Ir=function(t,e){var n=Ci(t),r=Di(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Yo(t,r)}))},t.prototype.Ar=function(t,e){var n=this;return Ci(t).get(Di(e)).next((function(t){return n.Jo(t)}))},t.prototype.Xo=function(t,e){var n=this;return Ci(t).get(Di(e)).next((function(t){var e=n.Jo(t);return e?{Zo:e,size:Ni(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ct();return this.ta(t,e,(function(t,e){var i=n.Jo(e);r=r.rt(t,i)})).next((function(){return r}))},t.prototype.ea=function(t,e){var n=this,r=Ct(),i=new Et(O.i);return this.ta(t,e,(function(t,e){var o=n.Jo(e);o?(r=r.rt(t,o),i=i.rt(t,Ni(e))):(r=r.rt(t,null),i=i.rt(t,0))})).next((function(){return{na:r,sa:i}}))},t.prototype.ta=function(t,e,n){if(e.m())return dr.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e.lt(),o=i.Et();return Ci(t).ss({range:r},(function(t,e,r){for(var s=O.$(t);o&&O.i(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.It()?i.Et():null}))},t.prototype.Or=function(t,e,n){var r=this,i=Nt(),o=e.path.length+1,s={};if(n.isEqual(ut.min())){var a=e.path.A();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.A(),h=vi(n);s.range=IDBKeyRange.lowerBound([u,h],!0),s.index=zi.collectionReadTimeIndex}return Ci(t).ss(s,(function(t,n,s){if(t.length===o){var a=pi(r.serializer,n);e.path.T(a.key.path)?a instanceof Pn&&Wn(e,a)&&(i=i.rt(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.ia=function(t,e){var n=this,r=Pt(),i=vi(e),o=Ci(t),s=IDBKeyRange.lowerBound(i,!0);return o.ss({index:zi.readTimeIndex,range:s},(function(t,e){var o=pi(n.serializer,e);r=r.rt(o.key,o),i=e.readTime})).next((function(){return{ra:r,readTime:yi(i)}}))},t.prototype.oa=function(t){var e=Ci(t),n=ut.min();return e.ss({index:zi.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=yi(e.readTime)),r.done()})).next((function(){return n}))},t.prototype.aa=function(e){return new t.ca(this,!!e&&e.ua)},t.prototype.ha=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Pi(t).get(Hi.key).next((function(t){return _(!!t),t}))},t.prototype.Yo=function(t,e){return Pi(t).put(Hi.key,e)},t.prototype.Jo=function(t){if(t){var e=pi(this.serializer,t);return e instanceof Cn&&e.version.isEqual(ut.min())?null:e}return null},t}();function Pi(t){return ao.Un(t,Hi.store)}function Ci(t){return ao.Un(t,zi.store)}function Di(t){return t.path.A()}function Ni(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw m();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Oi.ca=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).la=e,r.ua=n,r._a=new st((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return r.__extends(e,t),e.prototype.gr=function(t){var e=this,n=[],r=0,i=new At((function(t,e){return Q(t.R(),e.R())}));return this.dr.forEach((function(o,s){var a=e._a.get(o);if(s){var u=di(e.la.serializer,s,e.readTime);i=i.add(o.path.h());var h=Ni(u);r+=h-a,n.push(e.la.Tr(t,o,u))}else if(r-=a,e.ua){var c=di(e.la.serializer,new Cn(o,ut.min()),e.readTime);n.push(e.la.Tr(t,o,c))}else n.push(e.la.Ir(t,o))})),i.forEach((function(r){n.push(e.la.Sr.ko(t,r))})),n.push(this.la.updateMetadata(t,r)),dr.xn(n)},e.prototype.Rr=function(t,e){var n=this;return this.la.Xo(t,e).next((function(t){return null===t?(n._a.set(e,0),null):(n._a.set(e,t.size),t.Zo)}))},e.prototype.Pr=function(t,e){var n=this;return this.la.ea(t,e).next((function(t){var e=t.na;return t.sa.forEach((function(t,e){n._a.set(t,e)})),e}))},e}(Zr);var Ri=function(){function t(){this.fa=new Mi}return t.prototype.ko=function(t,e){return this.fa.add(e),dr.resolve()},t.prototype.Ur=function(t,e){return dr.resolve(this.fa.getEntries(e))},t}(),Mi=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new At(I.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new At(I.i)).A()},t}(),Li=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;_(n<r&&n>=0&&r<=10);var o=new _r(e);n<1&&r>=1&&(function(t){t.createObjectStore(ki.store)}(t),function(t){t.createObjectStore(Fi.store,{keyPath:Fi.keyPath}),t.createObjectStore(ji.store,{keyPath:ji.keyPath,autoIncrement:!0}).createIndex(ji.userMutationsIndex,ji.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Bi.store)}(t),Ki(t),function(t){t.createObjectStore(zi.store)}(t));var s=dr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(qi.store),t.deleteObjectStore(Xi.store),t.deleteObjectStore(Yi.store)}(t),Ki(t)),s=s.next((function(){return function(t){var e=t.store(Yi.store),n=new Yi(0,0,ut.min().X(),0);return e.put(Yi.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(ji.store).Zn().next((function(n){t.deleteObjectStore(ji.store),t.createObjectStore(ji.store,{keyPath:ji.keyPath,autoIncrement:!0}).createIndex(ji.userMutationsIndex,ji.userMutationsKeyPath,{unique:!0});var r=e.store(ji.store),i=n.map((function(t){return r.put(t)}));return dr.xn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Qi.store,{keyPath:Qi.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Hi.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(zi.store);e.createIndex(zi.readTimeIndex,zi.readTimeIndexPath,{unique:!1}),e.createIndex(zi.collectionReadTimeIndex,zi.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(zi.store).ss((function(t,n){e+=Ni(n)})).next((function(){var n=new Hi(e);return t.store(Hi.store).put(Hi.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Fi.store),r=t.store(ji.store);return n.Zn().next((function(n){return dr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Zn(ji.userMutationsIndex,i).next((function(r){return dr.forEach(r,(function(r){_(r.userId===n.userId);var i=_i(e.serializer,r);return Ti(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(qi.store),n=t.store(zi.store);return t.store(Yi.store).get(Yi.key).next((function(t){var r=[];return n.ss((function(n,i){var o=new I(n),s=function(t){return[0,ui(t)]}(o);r.push(e.get(s).next((function(n){return n?dr.resolve():function(n){return e.put(new qi(0,ui(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return dr.xn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Wi.store,{keyPath:Wi.keyPath});var n=e.store(Wi.store),r=new Mi,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:ui(i)})}};return e.store(zi.store).ss({ns:!0},(function(t,e){var n=new I(t);return i(n.h())})).next((function(){return e.store(Bi.store).ss({ns:!0},(function(t,e){t[0];var n=t[1],r=(t[2],li(n));return i(r.h())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Xi.store);return n.ss((function(t,r){var i=bi(r),o=wi(e.serializer,i);return n.put(o)}))},t}(),Ui=function(t,e){this.seconds=t,this.nanoseconds=e},ki=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ki.store="owner",ki.key="owner";var Fi=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fi.store="mutationQueues",Fi.keyPath="userId";var ji=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ji.store="mutations",ji.keyPath="batchId",ji.userMutationsIndex="userMutationsIndex",ji.userMutationsKeyPath=["userId","batchId"];var Bi=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ui(e)]},t.key=function(t,e,n){return[t,ui(e),n]},t}();Bi.store="documentMutations",Bi.PLACEHOLDER=new Bi;var Vi=function(t,e){this.path=t,this.readTime=e},Gi=function(t,e){this.path=t,this.version=e},zi=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zi.store="remoteDocuments",zi.readTimeIndex="readTimeIndex",zi.readTimeIndexPath="readTime",zi.collectionReadTimeIndex="collectionReadTimeIndex",zi.collectionReadTimeIndexPath=["parentPath","readTime"];var Hi=function(t){this.byteSize=t};Hi.store="remoteDocumentGlobal",Hi.key="remoteDocumentGlobalKey";var Xi=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xi.store="targets",Xi.keyPath="targetId",Xi.queryTargetsIndexName="queryTargetsIndex",Xi.queryTargetsKeyPath=["canonicalId","targetId"];var qi=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};qi.store="targetDocuments",qi.keyPath=["targetId","path"],qi.documentTargetsIndex="documentTargetsIndex",qi.documentTargetsKeyPath=["path","targetId"];var Yi=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Yi.key="targetGlobalKey",Yi.store="targetGlobal";var Wi=function(t,e){this.collectionId=t,this.parent=e};function Ki(t){t.createObjectStore(qi.store,{keyPath:qi.keyPath}).createIndex(qi.documentTargetsIndex,qi.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xi.store,{keyPath:Xi.keyPath}).createIndex(Xi.queryTargetsIndexName,Xi.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Yi.store)}Wi.store="collectionParents",Wi.keyPath=["collectionId","parent"];var Qi=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Qi.store="clientMetadata",Qi.keyPath="clientId";var Zi=r.__spreadArrays(r.__spreadArrays(r.__spreadArrays([Fi.store,ji.store,Bi.store,zi.store,Xi.store,ki.store,Yi.store,qi.store],[Qi.store]),[Hi.store]),[Wi.store]),Ji=function(){function t(){this.da=new Mi}return t.prototype.ko=function(t,e){var n=this;if(!this.da.has(e)){var r=e._(),i=e.h();t.Vr((function(){n.da.add(e)}));var o={collectionId:r,parent:ui(i)};return $i(t).put(o)}return dr.resolve()},t.prototype.Ur=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[J(e),""],!1,!0);return $i(t).Zn(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(li(o.parent))}return n}))},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(t){return ao.Un(t,Wi.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var to=function(){function t(t){this.wa=t}return t.prototype.next=function(){return this.wa+=2,this.wa},t.ma=function(){return new t(0)},t.Ta=function(){return new t(-1)},t}(),eo=function(){function t(t,e){this.Co=t,this.serializer=e}return t.prototype.Ea=function(t){var e=this;return this.Ia(t).next((function(n){var r=new to(n.highestTargetId);return n.highestTargetId=r.next(),e.Aa(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ra=function(t){return this.Ia(t).next((function(t){return ut.Y(new at(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Pa=function(t){return this.Ia(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.ga=function(t,e,n){var r=this;return this.Ia(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.X()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Aa(t,i)}))},t.prototype.ya=function(t,e){var n=this;return this.Va(t,e).next((function(){return n.Ia(t).next((function(r){return r.targetCount+=1,n.pa(e,r),n.Aa(t,r)}))}))},t.prototype.ba=function(t,e){return this.Va(t,e)},t.prototype.va=function(t,e){var n=this;return this.Sa(t,e.targetId).next((function(){return no(t).delete(e.targetId)})).next((function(){return n.Ia(t)})).next((function(e){return _(e.targetCount>0),e.targetCount-=1,n.Aa(t,e)}))},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return no(t).ss((function(s,a){var u=bi(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.va(t,u)))})).next((function(){return dr.xn(o)})).next((function(){return i}))},t.prototype.De=function(t,e){return no(t).ss((function(t,n){var r=bi(n);e(r)}))},t.prototype.Ia=function(t){return ro(t).get(Yi.key).next((function(t){return _(null!==t),t}))},t.prototype.Aa=function(t,e){return ro(t).put(Yi.key,e)},t.prototype.Va=function(t,e){return no(t).put(wi(this.serializer,e))},t.prototype.pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Da=function(t){return this.Ia(t).next((function(t){return t.targetCount}))},t.prototype.Ca=function(t,e){var n=dt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return no(t).ss({range:r,index:Xi.queryTargetsIndexName},(function(t,n,r){var o=bi(n);vt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Na=function(t,e,n){var r=this,i=[],o=io(t);return e.forEach((function(e){var s=ui(e.path);i.push(o.put(new qi(n,s))),i.push(r.Co.Fa(t,n,e))})),dr.xn(i)},t.prototype.xa=function(t,e,n){var r=this,i=io(t);return dr.forEach(e,(function(e){var o=ui(e.path);return dr.xn([i.delete([n,o]),r.Co.$a(t,n,e)])}))},t.prototype.Sa=function(t,e){var n=io(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ka=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=io(t),i=Lt();return r.ss({range:n,ns:!0},(function(t,e,n){var r=li(t[1]),o=new O(r);i=i.add(o)})).next((function(){return i}))},t.prototype.zo=function(t,e){var n=ui(e.path),r=IDBKeyRange.bound([n],[J(n)],!1,!0),i=0;return io(t).ss({index:qi.documentTargetsIndex,ns:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.qe=function(t,e){return no(t).get(e).next((function(t){return t?bi(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(t){return ao.Un(t,Xi.store)}function ro(t){return ao.Un(t,Yi.store)}function io(t){return ao.Un(t,qi.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oo="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",so=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Ma=n,r}return r.__extends(e,t),e}($r),ao=function(){function t(e,n,r,i,o,s,a,u,h,f){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this._n=o,this.window=s,this.document=a,this.Oa=h,this.La=f,this.Ba=null,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.On())throw new l(c.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Co=new co(this,i),this.Ga=n+"main",this.serializer=new fi(u),this.za=new vr(this.Ga,10,new Li(this.serializer)),this.Ha=new eo(this.Co,this.serializer),this.Sr=new Ji,this.br=new Oi(this.serializer,this.Sr),this.window&&this.window.localStorage?this.Ya=this.window.localStorage:(this.Ya=null,!1===f&&v("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Un=function(t,e){if(t instanceof so)return vr.Un(t.Wo,e);throw m()},t.prototype.start=function(){var t=this;return this.Ja().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new l(c.FAILED_PRECONDITION,oo);return t.Xa(),t.Za(),t.tc(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ha.Pa(e)}))})).then((function(e){t.Ba=new Fr(e,t.Oa)})).then((function(){t.qa=!0})).catch((function(e){return t.za&&t.za.close(),Promise.reject(e)}))},t.prototype.ec=function(t){var e=this;return this.Ka=function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.Ti?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.nc=function(t){var e=this;this.za.jn((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.sc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Ti?[4,this.Ja()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Ja=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ho(e).put(new Qi(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.ic(e).next((function(e){e||(t.isPrimary=!1,t._n.Ds((function(){return t.Ka(!1)})))}))})).next((function(){return t.rc(e)})).next((function(n){return t.isPrimary&&!n?t.oc(e).next((function(){return!1})):!!n&&t.ac(e).next((function(){return!0}))}))})).catch((function(e){if(mr(e))return d("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return d("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t._n.Ds((function(){return t.Ka(e)})),t.isPrimary=e}))},t.prototype.ic=function(t){var e=this;return uo(t).get(ki.key).next((function(t){return dr.resolve(e.cc(t))}))},t.prototype.uc=function(t){return ho(t).delete(this.clientId)},t.prototype.hc=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s=this;return r.__generator(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.lc(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Un(e,Qi.store);return n.Zn().next((function(t){var e=s._c(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return dr.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=r.sent(),this.Ya)for(n=0,i=e;n<i.length;n++)o=i[n],this.Ya.removeItem(this.fc(o.clientId));r.label=2;case 2:return[2]}}))}))},t.prototype.tc=function(){var t=this;this.Wa=this._n.gn("client_metadata_refresh",4e3,(function(){return t.Ja().then((function(){return t.hc()})).then((function(){return t.tc()}))}))},t.prototype.cc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.rc=function(t){var e=this;return this.La?dr.resolve(!0):uo(t).get(ki.key).next((function(n){if(null!==n&&e.lc(n.leaseTimestampMs,5e3)&&!e.dc(n.ownerId)){if(e.cc(n)&&e.networkEnabled)return!0;if(!e.cc(n)){if(!n.allowTabSynchronization)throw new l(c.FAILED_PRECONDITION,oo);return!1}}return!(!e.networkEnabled||!e.inForeground)||ho(t).Zn().next((function(t){return void 0===e._c(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&d("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Si=function(){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(e){switch(e.label){case 0:return this.qa=!1,this.wc(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.mc(),this.Tc(),[4,this.za.runTransaction("readwrite",[ki.store,Qi.store],(function(e){var n=new so(e,Fr.oi);return t.oc(n).next((function(){return t.uc(n)}))}))];case 1:return e.sent(),this.za.close(),this.Ec(),[2]}}))}))},t.prototype._c=function(t,e){var n=this;return t.filter((function(t){return n.lc(t.updateTimeMs,e)&&!n.dc(t.clientId)}))},t.prototype.Vi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ho(e).Zn().next((function(e){return t._c(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.Ic=function(t){return xi.Fo(t,this.serializer,this.Sr,this.Co)},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.Pc=function(){return this.Sr},t.prototype.runTransaction=function(t,e,n){var r=this;d("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.za.runTransaction(o,Zi,(function(o){return i=new so(o,r.Ba?r.Ba.next():Fr.oi),"readwrite-primary"===e?r.ic(i).next((function(t){return!!t||r.rc(i)})).next((function(e){if(!e)throw v("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r._n.Ds((function(){return r.Ka(!1)})),new l(c.FAILED_PRECONDITION,Jr);return n(i)})).next((function(t){return r.ac(i).next((function(){return t}))})):r.gc(i).next((function(){return n(i)}))})).then((function(t){return i.pr(),t}))},t.prototype.gc=function(t){var e=this;return uo(t).get(ki.key).next((function(t){if(null!==t&&e.lc(t.leaseTimestampMs,5e3)&&!e.dc(t.ownerId)&&!e.cc(t)&&!(e.La||e.allowTabSynchronization&&t.allowTabSynchronization))throw new l(c.FAILED_PRECONDITION,oo)}))},t.prototype.ac=function(t){var e=new ki(this.clientId,this.allowTabSynchronization,Date.now());return uo(t).put(ki.key,e)},t.On=function(){return vr.On()},t.prototype.oc=function(t){var e=this,n=uo(t);return n.get(ki.key).next((function(t){return e.cc(t)?(d("IndexedDbPersistence","Releasing primary lease."),n.delete(ki.key)):dr.resolve()}))},t.prototype.lc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(v("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Xa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qa=function(){t._n.ds((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ja()}))},this.document.addEventListener("visibilitychange",this.Qa),this.inForeground="visible"===this.document.visibilityState)},t.prototype.mc=function(){this.Qa&&(this.document.removeEventListener("visibilitychange",this.Qa),this.Qa=null)},t.prototype.Za=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ua=function(){e.wc(),e._n.ds((function(){return e.Si()}))},this.window.addEventListener("unload",this.Ua))},t.prototype.Tc=function(){this.Ua&&(this.window.removeEventListener("unload",this.Ua),this.Ua=null)},t.prototype.dc=function(t){var e;try{var n=null!==(null===(e=this.Ya)||void 0===e?void 0:e.getItem(this.fc(t)));return d("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return v("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wc=function(){if(this.Ya)try{this.Ya.setItem(this.fc(this.clientId),String(Date.now()))}catch(t){v("Failed to set zombie client id.",t)}},t.prototype.Ec=function(){if(this.Ya)try{this.Ya.removeItem(this.fc(this.clientId))}catch(t){}},t.prototype.fc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function uo(t){return ao.Un(t,ki.store)}function ho(t){return ao.Un(t,Qi.store)}var co=function(){function t(t,e){this.db=t,this.do=new ai(this,e)}return t.prototype.Ro=function(t){var e=this.yc(t);return this.db.Ac().Da(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.yc=function(t){var e=0;return this.yo(t,(function(t){e++})).next((function(){return e}))},t.prototype.De=function(t,e){return this.db.Ac().De(t,e)},t.prototype.yo=function(t,e){return this.Vc(t,(function(t,n){return e(n)}))},t.prototype.Fa=function(t,e,n){return lo(t,n)},t.prototype.$a=function(t,e,n){return lo(t,n)},t.prototype.Vo=function(t,e,n){return this.db.Ac().Vo(t,e,n)},t.prototype.Ko=function(t,e){return lo(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return Si(t).rs((function(r){return Ei(t,r,e).next((function(t){return t&&(n=!0),dr.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.po=function(t,e){var n=this,r=this.db.Rc().aa(),i=[],o=0;return this.Vc(t,(function(s,a){if(a<=e){var u=n.bc(t,s).next((function(e){if(!e)return o++,r.Ar(t,s).next((function(){return r.Ir(s),io(t).delete([0,ui(s.path)])}))}));i.push(u)}})).next((function(){return dr.xn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Ma);return this.db.Ac().ba(t,n)},t.prototype.vc=function(t,e){return lo(t,e)},t.prototype.Vc=function(t,e){var n,r=io(t),i=Fr.oi;return r.ss({index:qi.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==Fr.oi&&e(new O(li(n)),i),i=a,n=s):i=Fr.oi})).next((function(){i!==Fr.oi&&e(new O(li(n)),i)}))},t.prototype.vo=function(t){return this.db.Rc().ha(t)},t}();function lo(t,e){return io(t).put(function(t,e){return new qi(0,ui(t.path),e)}(e,t.Ma))}function fo(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var po=function(){function t(t,e,n){this.persistence=t,this.Sc=e,this.Dc=new Et(Q),this.Cc=new st((function(t){return dt(t)}),vt),this.Nc=ut.min(),this.vr=t.Ic(n),this.Fc=t.Rc(),this.Ha=t.Ac(),this.xc=new ti(this.Fc,this.vr,this.persistence.Pc()),this.Sc.$c(this.xc)}return t.prototype.Eo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.bo(n,e.Dc)}))},t}();function vo(t,e){var n=b(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Fc.aa({ua:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=dr.resolve();return o.forEach((function(t){s=s.next((function(){return r.Ar(e,t)})).next((function(e){var o=e,s=n._r.get(t);_(null!==s),(!o||o.version.L(s)<0)&&(o=i.ar(t,o,n))&&r.Tr(o,n.lr)}))})),s.next((function(){return t.vr.Qo(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.vr.Go(t)})).next((function(){return n.xc.$r(t,r)}))}))}function yo(t){var e=b(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ha.Ra(t)}))}function go(t,e){var n=b(t),r=e.et,i=n.Dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Fc.aa({ua:!0});i=n.Dc;var s=[];e.Gt.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.Ha.xa(t,e.ne,o).next((function(){return n.Ha.Na(t,e.te,o)})));var u=e.resumeToken;if(u.O()>0){var h=a.st(u,r).nt(t.Ma);i=i.rt(o,h),function(t,e,n){return _(e.resumeToken.O()>0),0===t.resumeToken.O()||e.et.J()-t.et.J()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(a,h,e)&&s.push(n.Ha.ba(t,h))}}}));var a=Pt(),u=Lt();if(e.Ht.forEach((function(t,e){u=u.add(t)})),s.push(o.getEntries(t,u).next((function(i){e.Ht.forEach((function(u,h){var c=i.get(u);h instanceof Cn&&h.version.isEqual(ut.min())?(o.Ir(u,r),a=a.rt(u,h)):null==c||h.version.L(c.version)>0||0===h.version.L(c.version)&&c.hasPendingWrites?(o.Tr(h,r),a=a.rt(u,h)):d("LocalStore","Ignoring outdated watch update for ",u,". Current version:",c.version," Watch version:",h.version),e.Yt.has(u)&&s.push(n.persistence.Co.vc(t,u))}))}))),!r.isEqual(ut.min())){var h=n.Ha.Ra(t).next((function(e){return n.Ha.ga(t,t.Ma,r)}));s.push(h)}return dr.xn(s).next((function(){return o.apply(t)})).next((function(){return n.xc.kr(t,a)}))})).then((function(t){return n.Dc=i,t}))}function mo(t,e){var n=b(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.vr.Lo(t,e)}))}function _o(t,e){var n=b(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ha.Ca(t,e).next((function(i){return i?(r=i,dr.resolve(r)):n.Ha.Ea(t).next((function(i){return r=new _t(e,i,0,t.Ma),n.Ha.ya(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Dc.get(t.targetId);return(null===r||t.et.L(r.et)>0)&&(n.Dc=n.Dc.rt(t.targetId,t),n.Cc.set(e,t.targetId)),t}))}function bo(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:i=b(t),o=i.Dc.get(e),s=n?"readwrite":"readwrite-primary",r.label=1;case 1:return r.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",s,(function(t){return i.persistence.Co.removeTarget(t,o)}))];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:if(!mr(a=r.sent()))throw a;return d("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return i.Dc=i.Dc.remove(e),i.Cc.delete(o.target),[2]}}))}))}function wo(t,e,n){var r=b(t),i=ut.min(),o=Lt();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=b(t),i=r.Cc.get(n);return void 0!==i?dr.resolve(r.Dc.get(i)):r.Ha.Ca(e,n)}(r,t,Vn(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ha.ka(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Sc.Or(t,e,n?i:ut.min(),n?o:Lt())})).next((function(t){return{documents:t,kc:o}}))}))}function xo(t,e){var n=b(t),r=b(n.Ha),i=n.Dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.qe(t,e).next((function(t){return t?t.target:null}))}))}function Eo(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){if(t.code!==c.FAILED_PRECONDITION||t.message!==Jr)throw t;return d("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var To=function(){function t(){this.Mc=new At(Io.Oc),this.Lc=new At(Io.Bc)}return t.prototype.m=function(){return this.Mc.m()},t.prototype.Fa=function(t,e){var n=new Io(t,e);this.Mc=this.Mc.add(n),this.Lc=this.Lc.add(n)},t.prototype.qc=function(t,e){var n=this;t.forEach((function(t){return n.Fa(t,e)}))},t.prototype.$a=function(t,e){this.Uc(new Io(t,e))},t.prototype.Qc=function(t,e){var n=this;t.forEach((function(t){return n.$a(t,e)}))},t.prototype.Wc=function(t){var e=this,n=new O(new I([])),r=new Io(n,t),i=new Io(n,t+1),o=[];return this.Lc.Nt([r,i],(function(t){e.Uc(t),o.push(t.key)})),o},t.prototype.jc=function(){var t=this;this.Mc.forEach((function(e){return t.Uc(e)}))},t.prototype.Uc=function(t){this.Mc=this.Mc.delete(t),this.Lc=this.Lc.delete(t)},t.prototype.Kc=function(t){var e=new O(new I([])),n=new Io(e,t),r=new Io(e,t+1),i=Lt();return this.Lc.Nt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.zo=function(t){var e=new Io(t,0),n=this.Mc.xt(e);return null!==n&&t.isEqual(n.key)},t}(),Io=function(){function t(t,e){this.key=t,this.Gc=e}return t.Oc=function(t,e){return O.i(t.key,e.key)||Q(t.Gc,e.Gc)},t.Bc=function(t,e){return Q(t.Gc,e.Gc)||O.i(t.key,e.key)},t}(),Ao=function(t,e){this.user=e,this.type="OAuth",this.zc={},this.zc.Authorization="Bearer "+t},So=function(){function t(){this.Hc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Yc=function(){},t.prototype.Jc=function(t){this.Hc=t,t(kr.UNAUTHENTICATED)},t.prototype.Xc=function(){this.Hc=null},t}(),Oo=function(){function t(t){var e=this;this.Zc=null,this.currentUser=kr.UNAUTHENTICATED,this.tu=!1,this.eu=0,this.Hc=null,this.forceRefresh=!1,this.Zc=function(){e.eu++,e.currentUser=e.nu(),e.tu=!0,e.Hc&&e.Hc(e.currentUser)},this.eu=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Zc):(this.Zc(null),t.get().then((function(t){e.auth=t,e.Zc&&e.auth.addAuthTokenListener(e.Zc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.eu,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.eu!==e?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(_("string"==typeof n.accessToken),new Ao(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.Yc=function(){this.forceRefresh=!0},t.prototype.Jc=function(t){this.Hc=t,this.tu&&t(this.currentUser)},t.prototype.Xc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Zc),this.Zc=null,this.Hc=null},t.prototype.nu=function(){var t=this.auth&&this.auth.getUid();return _(null===t||"string"==typeof t),new kr(t)},t}(),Po=function(){function t(t,e){this.su=t,this.iu=e,this.type="FirstParty",this.user=kr.ei}return Object.defineProperty(t.prototype,"zc",{get:function(){var t={"X-Goog-AuthUser":this.iu},e=this.su.auth.ru([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Co=function(){function t(t,e){this.su=t,this.iu=e}return t.prototype.getToken=function(){return Promise.resolve(new Po(this.su,this.iu))},t.prototype.Jc=function(t){t(kr.ei)},t.prototype.Xc=function(){},t.prototype.Yc=function(){},t}(),Do=function(){function t(t,e,n,r,i,o){this._n=t,this.ou=n,this.au=r,this.cu=i,this.listener=o,this.state=0,this.uu=0,this.hu=null,this.stream=null,this.gs=new pr(t,e)}return t.prototype.lu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype._u=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.fu()},t.prototype.stop=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.lu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.du=function(){this.state=0,this.gs.reset()},t.prototype.wu=function(){var t=this;this._u()&&null===this.hu&&(this.hu=this._n.gn(this.ou,6e4,(function(){return t.mu()})))},t.prototype.Tu=function(t){this.Eu(),this.stream.send(t)},t.prototype.mu=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return this._u()?[2,this.close(0)]:[2]}))}))},t.prototype.Eu=function(){this.hu&&(this.hu.cancel(),this.hu=null)},t.prototype.close=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.Eu(),this.gs.cancel(),this.uu++,3!==t?this.gs.reset():e&&e.code===c.RESOURCE_EXHAUSTED?(v(e.toString()),v("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):e&&e.code===c.UNAUTHENTICATED&&this.cu.Yc(),null!==this.stream&&(this.Iu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Au(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Iu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Ru(this.uu),n=this.uu;this.cu.getToken().then((function(e){t.uu===n&&t.Pu(e)}),(function(n){e((function(){var e=new l(c.UNKNOWN,"Fetching auth token failed: "+n.message);return t.gu(e)}))}))},t.prototype.Pu=function(t){var e=this,n=this.Ru(this.uu);this.stream=this.yu(t),this.stream.Vu((function(){n((function(){return e.state=2,e.listener.Vu()}))})),this.stream.Au((function(t){n((function(){return e.gu(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.fu=function(){var t=this;this.state=4,this.gs.Rn((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.gu=function(t){return d("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Ru=function(t){var e=this;return function(n){e._n.ds((function(){return e.uu===t?n():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),No=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return r.__extends(e,t),e.prototype.yu=function(t){return this.au.pu("Listen",t)},e.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:m()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(_(void 0===e||"string"==typeof e),$.fromBase64String(e||"")):(_(void 0===e||e instanceof Uint8Array),$.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(t){var e=void 0===t.code?c.UNKNOWN:xt(t.code);return new l(e,t.message||"")}(s);n=new Xt(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var h=Se(t,u.document.name),f=Ee(u.document.updateTime),p=new In({mapValue:{fields:u.document.fields}}),d=new Pn(h,f,p,{}),v=u.targetIds||[],y=u.removedTargetIds||[];n=new zt(v,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;var g=e.documentDelete;g.document;var b=Se(t,g.document),w=g.readTime?Ee(g.readTime):ut.min(),x=new Cn(b,w),E=g.removedTargetIds||[];n=new zt([],E,x.key,x)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var I=Se(t,T.document),A=T.removedTargetIds||[];n=new zt([],A,I,null)}else{if(!("filter"in e))return m();e.filter;var S=e.filter;S.targetId;var O=S.count||0,P=new bt(O),C=S.targetId;n=new Ht(C,P)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ut.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ut.min():e.readTime?Ee(e.readTime):ut.min()}(t);return this.listener.bu(e,n)},e.prototype.vu=function(t){var e={};e.database=Ce(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=yt(r)?{documents:Le(t,r)}:{query:Ue(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=we(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return m()}}(0,e.tt);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Tu(e)},e.prototype.Su=function(t){var e={};e.database=Ce(this.serializer),e.removeTarget=t,this.Tu(e)},e}(Do),Ro=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Du=!1,s}return r.__extends(e,t),Object.defineProperty(e.prototype,"Cu",{get:function(){return this.Du},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Du=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Iu=function(){this.Du&&this.Nu([])},e.prototype.yu=function(t){return this.au.pu("Write",t)},e.prototype.onMessage=function(t){if(_(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Du){this.gs.reset();var e=function(t,e){return t&&t.length>0?(_(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ee(t.updateTime):Ee(e);n.isEqual(ut.min())&&(n=Ee(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new un(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ee(t.commitTime);return this.listener.Fu(n,e)}return _(!t.writeResults||0===t.writeResults.length),this.Du=!0,this.listener.xu()},e.prototype.$u=function(){var t={};t.database=Ce(this.serializer),this.Tu(t)},e.prototype.Nu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Re(e.serializer,t)}))};this.Tu(n)},e}(Do),Mo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.au=n,i.serializer=r,i.ku=!1,i}return r.__extends(e,t),e.prototype.Mu=function(){if(this.ku)throw new l(c.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ou=function(t,e,n){var r=this;return this.Mu(),this.credentials.getToken().then((function(i){return r.au.Ou(t,e,n,i)})).catch((function(t){throw t.code===c.UNAUTHENTICATED&&r.credentials.Yc(),t}))},e.prototype.Lu=function(t,e,n){var r=this;return this.Mu(),this.credentials.getToken().then((function(i){return r.au.Lu(t,e,n,i)})).catch((function(t){throw t.code===c.UNAUTHENTICATED&&r.credentials.Yc(),t}))},e.prototype.terminate=function(){this.ku=!1},e}((function(){})),Lo=function(){function t(t,e){this.os=t,this.fi=e,this.state="Unknown",this.Bu=0,this.qu=null,this.Uu=!0}return t.prototype.Qu=function(){var t=this;0===this.Bu&&(this.Wu("Unknown"),this.qu=this.os.gn("online_state_timeout",1e4,(function(){return t.qu=null,t.ju("Backend didn't respond within 10 seconds."),t.Wu("Offline"),Promise.resolve()})))},t.prototype.Ku=function(t){"Online"===this.state?this.Wu("Unknown"):(this.Bu++,this.Bu>=1&&(this.Gu(),this.ju("Connection failed 1 times. Most recent error: "+t.toString()),this.Wu("Offline")))},t.prototype.set=function(t){this.Gu(),this.Bu=0,"Online"===t&&(this.Uu=!1),this.Wu(t)},t.prototype.Wu=function(t){t!==this.state&&(this.state=t,this.fi(t))},t.prototype.ju=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Uu?(v(e),this.Uu=!1):d("OnlineStateTracker",e)},t.prototype.Gu=function(){null!==this.qu&&(this.qu.cancel(),this.qu=null)},t}(),Uo=function(t,e,n,i,o){var s=this;this.zu=t,this.Hu=e,this.os=n,this.Yu={},this.Ju=[],this.Xu=new Map,this.Zu=new Set,this.th=[],this.eh=o,this.eh.nh((function(t){n.ds((function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return qo(this)?(d("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return(e=b(t)).Zu.add(4),[4,Fo(e)];case 1:return n.sent(),e.sh.set("Unknown"),e.Zu.delete(4),[4,ko(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.sh=new Lo(n,i)};function ko(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:if(!qo(t))return[3,4];e=0,n=t.th,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Fo(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:e=0,n=t.th,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function jo(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return e=b(t),d("RemoteStore","RemoteStore shutting down."),e.Zu.add(5),[4,Fo(e)];case 1:return n.sent(),e.eh.Si(),e.sh.set("Unknown"),[2]}}))}))}function Bo(t,e){var n=b(t);n.Xu.has(e.targetId)||(n.Xu.set(e.targetId,e),Xo(n)?Ho(n):as(n)._u()&&Go(n,e))}function Vo(t,e){var n=b(t),r=as(n);n.Xu.delete(e),r._u()&&zo(n,e),0===n.Xu.size&&(r._u()?r.wu():qo(n)&&n.sh.set("Unknown"))}function Go(t,e){t.ih.Ee(e.targetId),as(t).vu(e)}function zo(t,e){t.ih.Ee(e),as(t).Su(e)}function Ho(t){t.ih=new Yt({Be:function(e){return t.Yu.Be(e)},qe:function(e){return t.Xu.get(e)||null}}),as(t).start(),t.sh.Qu()}function Xo(t){return qo(t)&&!as(t).lu()&&t.Xu.size>0}function qo(t){return 0===b(t).Zu.size}function Yo(t){t.ih=void 0}function Wo(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return t.Xu.forEach((function(e,n){Go(t,e)})),[2]}))}))}function Ko(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){return Yo(t),Xo(t)?(t.sh.Ku(e),Ho(t)):t.sh.set("Unknown"),[2]}))}))}function Qo(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s;return r.__generator(this,(function(a){switch(a.label){case 0:if(t.sh.set("Online"),!(e instanceof Xt&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:n=e.cause,i=0,o=e.targetIds,r.label=1;case 1:return i<o.length?(s=o[i],t.Xu.has(s)?[4,t.Yu.rh(s,n)]:[3,3]):[3,5];case 2:r.sent(),t.Xu.delete(s),t.ih.removeTarget(s),r.label=3;case 3:r.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return i=a.sent(),d("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),[4,Zo(t,i)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof zt?t.ih.pe(e):e instanceof Ht?t.ih.xe(e):t.ih.Se(e),n.isEqual(ut.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,yo(t.zu)];case 8:return o=a.sent(),n.L(o)>=0?[4,function(t,e){var n=t.ih.Me(e);return n.Gt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=t.Xu.get(r);i&&t.Xu.set(r,i.st(n.resumeToken,e))}})),n.zt.forEach((function(e){var n=t.Xu.get(e);if(n){t.Xu.set(e,n.st($.B,n.et)),zo(t,e);var r=new _t(n.target,e,1,n.sequenceNumber);Go(t,r)}})),t.Yu.oh(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return d("RemoteStore","Failed to raise snapshot:",s=a.sent()),[4,Zo(t,s)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Zo(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i=this;return r.__generator(this,(function(o){switch(o.label){case 0:if(!mr(e))throw e;return t.Zu.add(1),[4,Fo(t)];case 1:return o.sent(),t.sh.set("Offline"),n||(n=function(){return yo(t.zu)}),t.os.Ds((function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return d("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Zu.delete(1),[4,ko(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Jo(t,e){return e().catch((function(n){return Zo(t,n,e)}))}function $o(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:e=b(t),n=us(e),i=e.Ju.length>0?e.Ju[e.Ju.length-1].batchId:-1,r.label=1;case 1:if(!function(t){return qo(t)&&t.Ju.length<10}(e))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,mo(e.zu,i)];case 3:return null===(o=r.sent())?(0===e.Ju.length&&n.wu(),[3,7]):(i=o.batchId,function(t,e){t.Ju.push(e);var n=us(t);n._u()&&n.Cu&&n.Nu(e.mutations)}(e,o),[3,6]);case 4:return s=r.sent(),[4,Zo(e,s)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return ts(e)&&es(e),[2]}}))}))}function ts(t){return qo(t)&&!us(t).lu()&&t.Ju.length>0}function es(t){us(t).start()}function ns(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return us(t).$u(),[2]}))}))}function rs(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,i,o;return r.__generator(this,(function(r){for(e=us(t),n=0,i=t.Ju;n<i.length;n++)o=i[n],e.Nu(o.mutations);return[2]}))}))}function is(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return i=t.Ju.shift(),o=Qr.from(i,e,n),[4,Jo(t,(function(){return t.Yu.ah(o)}))];case 1:return r.sent(),[4,$o(t)];case 2:return r.sent(),[2]}}))}))}function os(t,e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return e&&us(t).Cu?[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return wt(i=e.code)&&i!==c.ABORTED?(n=t.Ju.shift(),us(t).du(),[4,Jo(t,(function(){return t.Yu.uh(n.batchId,e)}))]):[3,3];case 1:return r.sent(),[4,$o(t)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ts(t)&&es(t),[2]}}))}))}function ss(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return n=b(t),e?(n.Zu.delete(2),[4,ko(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Zu.add(2),[4,Fo(n)]);case 3:r.sent(),n.sh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function as(t){var e=this;return t.hh||(t.hh=function(t,e,n){var r=b(t);return r.Mu(),new No(e,r.au,r.credentials,r.serializer,n)}(t.Hu,t.os,{Vu:Wo.bind(null,t),Au:Ko.bind(null,t),bu:Qo.bind(null,t)}),t.th.push((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return n?(t.hh.du(),Xo(t)?Ho(t):t.sh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.hh.stop()];case 2:e.sent(),Yo(t),e.label=3;case 3:return[2]}}))}))}))),t.hh}function us(t){var e=this;return t.lh||(t.lh=function(t,e,n){var r=b(t);return r.Mu(),new Ro(e,r.au,r.credentials,r.serializer,n)}(t.Hu,t.os,{Vu:ns.bind(null,t),Au:os.bind(null,t),xu:rs.bind(null,t),Fu:is.bind(null,t)}),t.th.push((function(n){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return n?(t.lh.du(),[4,$o(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.lh.stop()];case 3:e.sent(),t.Ju.length>0&&(d("RemoteStore","Stopping write stream with "+t.Ju.length+" pending writes"),t.Ju=[]),e.label=4;case 4:return[2]}}))}))}))),t.lh
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var hs=function(t){this.key=t},cs=function(t){this.key=t},ls=function(){function t(t,e){this.query=t,this._h=e,this.fh=null,this.Zt=!1,this.dh=Lt(),this.Qt=Lt(),this.wh=Kn(t),this.mh=new Ft(this.wh)}return Object.defineProperty(t.prototype,"Th",{get:function(){return this._h},enumerable:!1,configurable:!0}),t.prototype.Eh=function(t,e){var n=this,r=e?e.Ih:new jt,i=e?e.mh:this.mh,o=e?e.Qt:this.Qt,s=i,a=!1,u=Ln(this.query)&&i.size===this.query.limit?i.last():null,h=Un(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut((function(t,e){var c=i.get(t),l=e instanceof Pn?e:null;l&&(l=Wn(n.query,l)?l:null);var f=!!c&&n.Qt.has(c.key),p=!!l&&(l.Ye||n.Qt.has(l.key)&&l.hasCommittedMutations),d=!1;c&&l?c.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.Ah(c,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.wh(l,u)>0||h&&n.wh(l,h)<0)&&(a=!0)):!c&&l?(r.track({type:0,doc:l}),d=!0):c&&!l&&(r.track({type:1,doc:c}),d=!0,(u||h)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ln(this.query)||Un(this.query))for(;s.size>this.query.limit;){var c=Ln(this.query)?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{mh:s,Ih:r,Rh:a,Qt:o}},t.prototype.Ah=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.gr=function(t,e,n){var r=this,i=this.mh;this.mh=t.mh,this.Qt=t.Qt;var o=t.Ih.qt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return m()}};return n(t)-n(e)}(t.type,e.type)||r.wh(t.doc,e.doc)})),this.Ph(n);var s=e?this.gh():[],a=0===this.dh.size&&this.Zt?1:0,u=a!==this.fh;return this.fh=a,0!==o.length||u?{snapshot:new Bt(this.query,t.mh,i,o,t.Qt,0===a,u,!1),yh:s}:{yh:s}},t.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({mh:this.mh,Ih:new jt,Qt:this.Qt,Rh:!1},!1)):{yh:[]}},t.prototype.Vh=function(t){return!this._h.has(t)&&!!this.mh.has(t)&&!this.mh.get(t).Ye},t.prototype.Ph=function(t){var e=this;t&&(t.te.forEach((function(t){return e._h=e._h.add(t)})),t.ee.forEach((function(t){})),t.ne.forEach((function(t){return e._h=e._h.delete(t)})),this.Zt=t.Zt)},t.prototype.gh=function(){var t=this;if(!this.Zt)return[];var e=this.dh;this.dh=Lt(),this.mh.forEach((function(e){t.Vh(e.key)&&(t.dh=t.dh.add(e.key))}));var n=[];return e.forEach((function(e){t.dh.has(e)||n.push(new cs(e))})),this.dh.forEach((function(t){e.has(t)||n.push(new hs(t))})),n},t.prototype.ph=function(t){this._h=t.kc,this.dh=Lt();var e=this.Eh(t.documents);return this.gr(e,!0)},t.prototype.bh=function(){return Bt.Kt(this.query,this.mh,this.Qt,0===this.fh)},t}(),fs=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ps=function(t){this.key=t,this.Sh=!1},ds=function(){function t(t,e,n,r,i,o){this.zu=t,this.Dh=e,this.Ch=n,this.Nh=r,this.currentUser=i,this.Fh=o,this.xh={},this.$h=new st((function(t){return qn(t)}),Xn),this.kh=new Map,this.Mh=[],this.Oh=new Et(O.i),this.Lh=new Map,this.Bh=new To,this.qh={},this.Uh=new Map,this.Qh=to.Ta(),this.onlineState="Unknown",this.Wh=void 0}return Object.defineProperty(t.prototype,"jh",{get:function(){return!0===this.Wh},enumerable:!1,configurable:!0}),t}();function vs(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u;return r.__generator(this,(function(r){switch(r.label){case 0:return n=Vs(t),(s=n.$h.get(e))?(i=s.targetId,n.Nh.Mi(i),o=s.view.bh(),[3,4]):[3,1];case 1:return[4,_o(n.zu,Vn(e))];case 2:return a=r.sent(),u=n.Nh.Mi(a.targetId),i=a.targetId,[4,ys(n,e,i,"current"===u)];case 3:o=r.sent(),n.jh&&Bo(n.Dh,a),r.label=4;case 4:return[2,o]}}))}))}function ys(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,a,u,h,c;return r.__generator(this,(function(l){switch(l.label){case 0:return t.Kh=function(e,n,i){return function(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=e.view.Eh(n)).Rh?[4,wo(t.zu,e.query,!1).then((function(t){var n=t.documents;return e.view.Eh(n,o)}))]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return s=i&&i.Gt.get(e.targetId),a=e.view.gr(o,t.jh,s),[2,(Ss(t,e.targetId,a.yh),a.snapshot)]}}))}))}(t,e,n,i)},[4,wo(t.zu,e,!0)];case 1:return o=l.sent(),s=new ls(e,o.kc),a=s.Eh(o.documents),u=Gt.Xt(n,i&&"Offline"!==t.onlineState),h=s.gr(a,t.jh,u),Ss(t,n,h.yh),c=new fs(e,n,s),[2,(t.$h.set(e,c),t.kh.has(n)?t.kh.get(n).push(e):t.kh.set(n,[e]),h.snapshot)]}}))}))}function gs(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=b(t),i=n.$h.get(e),(o=n.kh.get(i.targetId)).length>1?[2,(n.kh.set(i.targetId,o.filter((function(t){return!Xn(t,e)}))),void n.$h.delete(e))]:n.jh?(n.Nh.Li(i.targetId),n.Nh.Ni(i.targetId)?[3,2]:[4,bo(n.zu,i.targetId,!1).then((function(){n.Nh.qi(i.targetId),Vo(n.Dh,i.targetId),Is(n,i.targetId)})).catch(Eo)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return Is(n,i.targetId),[4,bo(n.zu,i.targetId,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}function ms(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=b(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,go(n.zu,e)];case 2:return i=r.sent(),e.Gt.forEach((function(t,e){var r=n.Lh.get(e);r&&(_(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?r.Sh=!0:t.ee.size>0?_(r.Sh):t.ne.size>0&&(_(r.Sh),r.Sh=!1))})),[4,Cs(n,i,e)];case 3:return r.sent(),[3,6];case 4:return[4,Eo(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function _s(t,e,n){var r=b(t);if(r.jh&&0===n||!r.jh&&1===n){var i=[];r.$h.forEach((function(t,n){var r=n.view.Us(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=b(t);n.onlineState=e;var r=!1;n.Ls.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Us(e)&&(r=!0)})),r&&Lr(n)}(r.Ch,e),i.length&&r.xh.bu(i),r.onlineState=e,r.jh&&r.Nh.ji(e)}}function bs(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:return(i=b(t)).Nh.Ui(e,"rejected",n),o=i.Lh.get(e),(s=o&&o.key)?(a=(a=new Et(O.i)).rt(s,new Cn(s,ut.min())),u=Lt().add(s),h=new Vt(ut.min(),new Map,new At(Q),a,u),[4,ms(i,h)]):[3,2];case 1:return r.sent(),i.Oh=i.Oh.remove(s),i.Lh.delete(e),Ps(i),[3,4];case 2:return[4,bo(i.zu,e,!1).then((function(){return Is(i,e,n)})).catch(Eo)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}function ws(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:n=b(t),i=e.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,vo(n.zu,e)];case 2:return o=r.sent(),Ts(n,i,null),Es(n,i),n.Nh.$i(i,"acknowledged"),[4,Cs(n,o)];case 3:return r.sent(),[3,6];case 4:return[4,Eo(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function xs(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:i=b(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=b(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.vr.Mo(t,e).next((function(e){return _(null!==e),r=e.keys(),n.vr.Qo(t,e)})).next((function(){return n.vr.Go(t)})).next((function(){return n.xc.$r(t,r)}))}))}(i.zu,e)];case 2:return o=r.sent(),Ts(i,e,n),Es(i,e),i.Nh.$i(e,"rejected",n),[4,Cs(i,o)];case 3:return r.sent(),[3,6];case 4:return[4,Eo(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Es(t,e){(t.Uh.get(e)||[]).forEach((function(t){t.resolve()})),t.Uh.delete(e)}function Ts(t,e,n){var r=b(t),i=r.qh[r.currentUser.Zs()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.qh[r.currentUser.Zs()]=i}}function Is(t,e,n){void 0===n&&(n=null),t.Nh.Li(e);for(var r=0,i=t.kh.get(e);r<i.length;r++){var o=i[r];t.$h.delete(o),n&&t.xh.Gh(o,n)}t.kh.delete(e),t.jh&&t.Bh.Wc(e).forEach((function(e){t.Bh.zo(e)||As(t,e)}))}function As(t,e){var n=t.Oh.get(e);null!==n&&(Vo(t.Dh,n),t.Oh=t.Oh.remove(e),t.Lh.delete(n),Ps(t))}function Ss(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof hs?(t.Bh.Fa(o.key,e),Os(t,o)):o instanceof cs?(d("SyncEngine","Document no longer in limbo: "+o.key),t.Bh.$a(o.key,e),t.Bh.zo(o.key)||As(t,o.key)):m()}}function Os(t,e){var n=e.key;t.Oh.get(n)||(d("SyncEngine","New document in limbo: "+n),t.Mh.push(n),Ps(t))}function Ps(t){for(;t.Mh.length>0&&t.Oh.size<t.Fh;){var e=t.Mh.shift(),n=t.Qh.next();t.Lh.set(n,new ps(e)),t.Oh=t.Oh.rt(e,n),Bo(t.Dh,new _t(Vn(Mn(e.path)),n,2,Fr.oi))}}function Cs(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a;return r.__generator(this,(function(u){switch(u.label){case 0:return i=b(t),o=[],s=[],a=[],i.$h.m()?[3,3]:(i.$h.forEach((function(t,r){a.push(i.Kh(r,e,n).then((function(t){if(t){i.jh&&i.Nh.Ui(r.targetId,t.fromCache?"not-current":"current"),o.push(t);var e=ei.Gr(r.targetId,t);s.push(e)}})))})),[4,Promise.all(a)]);case 1:return u.sent(),i.xh.bu(o),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u,h,c,l;return r.__generator(this,(function(r){switch(r.label){case 0:n=b(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return dr.forEach(e,(function(e){return dr.forEach(e.jr,(function(r){return n.persistence.Co.Fa(t,e.targetId,r)})).next((function(){return dr.forEach(e.Kr,(function(r){return n.persistence.Co.$a(t,e.targetId,r)}))}))}))}))];case 2:return r.sent(),[3,4];case 3:if(!mr(i=r.sent()))throw i;return d("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,s=e;o<s.length;o++)a=s[o],u=a.targetId,a.fromCache||(h=n.Dc.get(u),c=h.et,l=h.it(c),n.Dc=n.Dc.rt(u,l));return[2]}}))}))}(i.zu,s)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))}function Ds(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(o){switch(o.label){case 0:return(n=b(t)).currentUser.isEqual(e)?[3,3]:(d("SyncEngine","User change. New user:",e.Zs()),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return n=b(t),i=n.vr,o=n.xc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var r;return n.vr.qo(t).next((function(s){return r=s,i=n.persistence.Ic(e),o=new ti(n.Fc,i,n.persistence.Pc()),i.qo(t)})).next((function(e){for(var n=[],i=[],s=Lt(),a=0,u=r;a<u.length;a++){var h=u[a];n.push(h.batchId);for(var c=0,l=h.mutations;c<l.length;c++){var f=l[c];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];i.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return o.$r(t,s).next((function(t){return{zh:t,Hh:n,Yh:i}}))}))}))];case 1:return s=r.sent(),[2,(n.vr=i,n.xc=o,n.Sc.$c(n.xc),s)]}}))}))}(n.zu,e)]);case 1:return i=o.sent(),n.currentUser=e,function(t,e){t.Uh.forEach((function(t){t.forEach((function(t){t.reject(new l(c.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Uh.clear()}(n),n.Nh.Wi(e,i.Hh,i.Yh),[4,Cs(n,i.zh)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function Ns(t,e){var n=b(t),r=n.Lh.get(e);if(r&&r.Sh)return Lt().add(r.key);var i=Lt(),o=n.kh.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],h=n.$h.get(u);i=i.$t(h.view.Th)}return i}function Rs(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,wo((n=b(t)).zu,e.query,!0)];case 1:return i=r.sent(),o=e.view.ph(i),[2,(n.jh&&Ss(n,e.targetId,o.yh),o)]}}))}))}function Ms(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,function(t,e){var n=b(t),r=b(n.vr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Oo(t,e).next((function(e){return e?n.xc.$r(t,e):dr.resolve(null)}))}))}((o=b(t)).zu,e)];case 1:return null===(s=r.sent())?[3,6]:"pending"!==n?[3,3]:[4,$o(o.Dh)];case 2:return r.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ts(o,e,i||null),function(t,e){b(b(t).vr).jo(e)}(o.zu,e)):m(),r.label=4;case 4:return[4,Cs(o,s)];case 5:return r.sent(),[3,7];case 6:d("SyncEngine","Cannot apply mutation batch with id: "+e),r.label=7;case 7:return[2]}}))}))}function Ls(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u,h,c;return r.__generator(this,(function(r){switch(r.label){case 0:return Vs(n=b(t)),Gs(n),!0!==e||!0===n.Wh?[3,3]:(i=n.Nh.Di(),[4,Us(n,i.A())]);case 1:return o=r.sent(),n.Wh=!0,[4,ss(n.Dh,!0)];case 2:for(r.sent(),s=0,a=o;s<a.length;s++)u=a[s],Bo(n.Dh,u);return[3,7];case 3:return!1!==e||!1===n.Wh?[3,7]:(h=[],c=Promise.resolve(),n.kh.forEach((function(t,e){n.Nh.Bi(e)?h.push(e):c=c.then((function(){return Is(n,e),bo(n.zu,e,!0)})),Vo(n.Dh,e)})),[4,c]);case 4:return r.sent(),[4,Us(n,h)];case 5:return r.sent(),function(t){var e=b(t);e.Lh.forEach((function(t,n){Vo(e.Dh,n)})),e.Bh.jc(),e.Lh=new Map,e.Oh=new Et(O.i)}(n),n.Wh=!1,[4,ss(n.Dh,!1)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))}function Us(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u,h,c,l,f,p,d,v,y;return r.__generator(this,(function(r){switch(r.label){case 0:n=b(t),i=[],o=[],s=0,a=e,r.label=1;case 1:return s<a.length?(u=a[s],h=void 0,(c=n.kh.get(u))&&0!==c.length?[4,_o(n.zu,Vn(c[0]))]:[3,7]):[3,13];case 2:h=r.sent(),l=0,f=c,r.label=3;case 3:return l<f.length?(p=f[l],d=n.$h.get(p),[4,Rs(n,d)]):[3,6];case 4:(v=r.sent()).snapshot&&o.push(v.snapshot),r.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,xo(n.zu,u)];case 8:return y=r.sent(),[4,_o(n.zu,y)];case 9:return h=r.sent(),[4,ys(n,ks(y),u,!1)];case 10:r.sent(),r.label=11;case 11:i.push(h),r.label=12;case 12:return s++,[3,1];case 13:return[2,(n.xh.bu(o),i)]}}))}))}function ks(t){return Rn(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Fs(t){var e=b(t);return b(b(e.zu).persistence).Vi()}function js(t,e,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=b(t)).Wh?(d("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.kh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=b(t),n=b(e.Fc);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n.ia(t,e.Nc)})).then((function(t){var n=t.ra,r=t.readTime;return e.Nc=r,n}))}(o.zu)];case 3:return s=r.sent(),a=Vt.Jt(e,"current"===n),[4,Cs(o,s,a)];case 4:return r.sent(),[3,8];case 5:return[4,bo(o.zu,e,!0)];case 6:return r.sent(),Is(o,e,i),[3,8];case 7:m(),r.label=8;case 8:return[2]}}))}))}function Bs(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a,u,h,c,l,f,p;return r.__generator(this,(function(v){switch(v.label){case 0:if(!(i=Vs(t)).Wh)return[3,10];o=0,s=e,v.label=1;case 1:return o<s.length?(a=s[o],i.kh.has(a)?(d("SyncEngine","Adding an already active target "+a),[3,5]):[4,xo(i.zu,a)]):[3,6];case 2:return u=v.sent(),[4,_o(i.zu,u)];case 3:return h=v.sent(),[4,ys(i,ks(u),h.targetId,!1)];case 4:v.sent(),Bo(i.Dh,h),v.label=5;case 5:return o++,[3,1];case 6:c=function(t){return r.__generator(this,(function(e){switch(e.label){case 0:return i.kh.has(t)?[4,bo(i.zu,t,!1).then((function(){Vo(i.Dh,t),Is(i,t)})).catch(Eo)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,v.label=7;case 7:return l<f.length?(p=f[l],[5,c(p)]):[3,10];case 8:v.sent(),v.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Vs(t){var e=b(t);return e.Dh.Yu.oh=ms.bind(null,e),e.Dh.Yu.Be=Ns.bind(null,e),e.Dh.Yu.rh=bs.bind(null,e),e.xh.bu=Rr.bind(null,e.Ch),e.xh.Gh=Mr.bind(null,e.Ch),e}function Gs(t){var e=b(t);return e.Dh.Yu.ah=ws.bind(null,e),e.Dh.Yu.uh=xs.bind(null,e),e}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zs=function(){function t(){}return t.prototype.$c=function(t){this.Jh=t},t.prototype.Or=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.p())}(e)||n.isEqual(ut.min())?this.Xh(t,e):this.Jh.$r(t,r).next((function(s){var a=i.Zh(e,s);return(Ln(e)||Un(e))&&i.Rh(e.on,a,r,n)?i.Xh(t,e):(p()<=o.LogLevel.DEBUG&&d("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Yn(e)),i.Jh.Or(t,e,n).next((function(t){return a.forEach((function(e){t=t.rt(e.key,e)})),t})))}))},t.prototype.Zh=function(t,e){var n=new At(Kn(t));return e.forEach((function(e,r){r instanceof Pn&&Wn(t,r)&&(n=n.add(r))})),n},t.prototype.Rh=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Xh=function(t,e){return p()<=o.LogLevel.DEBUG&&d("IndexFreeQueryEngine","Using full collection scan to execute query:",Yn(e)),this.Jh.Or(t,e,ut.min())},t}(),Hs=function(){function t(t,e){this.Sr=t,this.Co=e,this.vr=[],this.tl=1,this.el=new At(Io.Oc)}return t.prototype.xo=function(t){return dr.resolve(0===this.vr.length)},t.prototype.$o=function(t,e,n,r){var i=this.tl;this.tl++,this.vr.length>0&&this.vr[this.vr.length-1];var o=new Kr(i,e,n,r);this.vr.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.el=this.el.add(new Io(u.key,i)),this.Sr.ko(t,u.key.path.h())}return dr.resolve(o)},t.prototype.Mo=function(t,e){return dr.resolve(this.nl(e))},t.prototype.Lo=function(t,e){var n=e+1,r=this.sl(n),i=r<0?0:r;return dr.resolve(this.vr.length>i?this.vr[i]:null)},t.prototype.Bo=function(){return dr.resolve(0===this.vr.length?-1:this.tl-1)},t.prototype.qo=function(t){return dr.resolve(this.vr.slice())},t.prototype.Cr=function(t,e){var n=this,r=new Io(e,0),i=new Io(e,Number.POSITIVE_INFINITY),o=[];return this.el.Nt([r,i],(function(t){var e=n.nl(t.Gc);o.push(e)})),dr.resolve(o)},t.prototype.Mr=function(t,e){var n=this,r=new At(Q);return e.forEach((function(t){var e=new Io(t,0),i=new Io(t,Number.POSITIVE_INFINITY);n.el.Nt([e,i],(function(t){r=r.add(t.Gc)}))})),dr.resolve(this.il(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;O.F(i)||(i=i.child(""));var o=new Io(new O(i),0),s=new At(Q);return this.el.Ft((function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Gc)),!0)}),o),dr.resolve(this.il(s))},t.prototype.il=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.nl(t);null!==r&&n.push(r)})),n},t.prototype.Qo=function(t,e){var n=this;_(0===this.rl(e.batchId,"removed")),this.vr.shift();var r=this.el;return dr.forEach(e.mutations,(function(i){var o=new Io(i.key,e.batchId);return r=r.delete(o),n.Co.Ko(t,i.key)})).next((function(){n.el=r}))},t.prototype.jo=function(t){},t.prototype.zo=function(t,e){var n=new Io(e,0),r=this.el.xt(n);return dr.resolve(e.isEqual(r&&r.key))},t.prototype.Go=function(t){return this.vr.length,dr.resolve()},t.prototype.rl=function(t,e){return this.sl(t)},t.prototype.sl=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},t.prototype.nl=function(t){var e=this.sl(t);return e<0||e>=this.vr.length?null:this.vr[e]},t}(),Xs=function(){function t(t,e){this.Sr=t,this.ol=e,this.docs=new Et(O.i),this.size=0}return t.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ol(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},t.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ar=function(t,e){var n=this.docs.get(e);return dr.resolve(n?n.Zo:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ct();return e.forEach((function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)})),dr.resolve(r)},t.prototype.Or=function(t,e,n){for(var r=Nt(),i=new O(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.key,u=s.value,h=u.Zo,c=u.readTime;if(!e.path.T(a.path))break;c.L(n)<=0||h instanceof Pn&&Wn(e,h)&&(r=r.rt(h.key,h))}return dr.resolve(r)},t.prototype.al=function(t,e){return dr.forEach(this.docs,(function(t){return e(t)}))},t.prototype.aa=function(e){return new t.ca(this)},t.prototype.ha=function(t){return dr.resolve(this.size)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xs.ca=function(t){function e(e){var n=this;return(n=t.call(this)||this).la=e,n}return r.__extends(e,t),e.prototype.gr=function(t){var e=this,n=[];return this.dr.forEach((function(r,i){i?n.push(e.la.Tr(t,i,e.readTime)):e.la.Ir(r)})),dr.xn(n)},e.prototype.Rr=function(t,e){return this.la.Ar(t,e)},e.prototype.Pr=function(t,e){return this.la.getEntries(t,e)},e}(Zr);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qs=function(){function t(t){this.persistence=t,this.cl=new st((function(t){return dt(t)}),vt),this.lastRemoteSnapshotVersion=ut.min(),this.highestTargetId=0,this.ul=0,this.hl=new To,this.targetCount=0,this.ll=to.ma()}return t.prototype.De=function(t,e){return this.cl.forEach((function(t,n){return e(n)})),dr.resolve()},t.prototype.Ra=function(t){return dr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Pa=function(t){return dr.resolve(this.ul)},t.prototype.Ea=function(t){return this.highestTargetId=this.ll.next(),dr.resolve(this.highestTargetId)},t.prototype.ga=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ul&&(this.ul=e),dr.resolve()},t.prototype.Va=function(t){this.cl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ll=new to(e),this.highestTargetId=e),t.sequenceNumber>this.ul&&(this.ul=t.sequenceNumber)},t.prototype.ya=function(t,e){return this.Va(e),this.targetCount+=1,dr.resolve()},t.prototype.ba=function(t,e){return this.Va(e),dr.resolve()},t.prototype.va=function(t,e){return this.cl.delete(e.target),this.hl.Wc(e.targetId),this.targetCount-=1,dr.resolve()},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return this.cl.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.cl.delete(s),o.push(r.Sa(t,a.targetId)),i++)})),dr.xn(o).next((function(){return i}))},t.prototype.Da=function(t){return dr.resolve(this.targetCount)},t.prototype.Ca=function(t,e){var n=this.cl.get(e)||null;return dr.resolve(n)},t.prototype.Na=function(t,e,n){return this.hl.qc(e,n),dr.resolve()},t.prototype.xa=function(t,e,n){this.hl.Qc(e,n);var r=this.persistence.Co,i=[];return r&&e.forEach((function(e){i.push(r.Ko(t,e))})),dr.xn(i)},t.prototype.Sa=function(t,e){return this.hl.Wc(e),dr.resolve()},t.prototype.ka=function(t,e){var n=this.hl.Kc(e);return dr.resolve(n)},t.prototype.zo=function(t,e){return dr.resolve(this.hl.zo(e))},t}(),Ys=function(){function t(t){var e=this;this._l={},this.Ba=new Fr(0),this.qa=!1,this.qa=!0,this.Co=t(this),this.Ha=new qs(this),this.Sr=new Ri,this.br=new Xs(this.Sr,(function(t){return e.Co.fl(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Si=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.nc=function(){},t.prototype.sc=function(){},t.prototype.Pc=function(){return this.Sr},t.prototype.Ic=function(t){var e=this._l[t.Zs()];return e||(e=new Hs(this.Sr,this.Co),this._l[t.Zs()]=e),e},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.runTransaction=function(t,e,n){var r=this;d("MemoryPersistence","Starting transaction:",t);var i=new Ws(this.Ba.next());return this.Co.dl(),n(i).next((function(t){return r.Co.wl(i).next((function(){return t}))})).Nn().then((function(t){return i.pr(),t}))},t.prototype.ml=function(t,e){return dr.$n(Object.values(this._l).map((function(n){return function(){return n.zo(t,e)}})))},t}(),Ws=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ma=e,n}return r.__extends(e,t),e}($r),Ks=function(){function t(t){this.persistence=t,this.Tl=new To,this.El=null}return t.Il=function(e){return new t(e)},Object.defineProperty(t.prototype,"Al",{get:function(){if(this.El)return this.El;throw m()},enumerable:!1,configurable:!0}),t.prototype.Fa=function(t,e,n){return this.Tl.Fa(n,e),this.Al.delete(n.toString()),dr.resolve()},t.prototype.$a=function(t,e,n){return this.Tl.$a(n,e),this.Al.add(n.toString()),dr.resolve()},t.prototype.Ko=function(t,e){return this.Al.add(e.toString()),dr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Tl.Wc(e.targetId).forEach((function(t){return n.Al.add(t.toString())}));var r=this.persistence.Ac();return r.ka(t,e.targetId).next((function(t){t.forEach((function(t){return n.Al.add(t.toString())}))})).next((function(){return r.va(t,e)}))},t.prototype.dl=function(){this.El=new Set},t.prototype.wl=function(t){var e=this,n=this.persistence.Rc().aa();return dr.forEach(this.Al,(function(r){var i=O.D(r);return e.Rl(t,i).next((function(t){t||n.Ir(i)}))})).next((function(){return e.El=null,n.apply(t)}))},t.prototype.vc=function(t,e){var n=this;return this.Rl(t,e).next((function(t){t?n.Al.delete(e.toString()):n.Al.add(e.toString())}))},t.prototype.fl=function(t){return 0},t.prototype.Rl=function(t,e){var n=this;return dr.$n([function(){return dr.resolve(n.Tl.zo(e))},function(){return n.persistence.Ac().zo(t,e)},function(){return n.persistence.ml(t,e)}])},t}(),Qs=function(){function t(t){this.Pl=t.Pl,this.gl=t.gl}return t.prototype.Vu=function(t){this.yl=t},t.prototype.Au=function(t){this.Vl=t},t.prototype.onMessage=function(t){this.pl=t},t.prototype.close=function(){this.gl()},t.prototype.send=function(t){this.Pl(t)},t.prototype.bl=function(){this.yl()},t.prototype.vl=function(t){this.Vl(t)},t.prototype.Sl=function(t){this.pl(t)},t}(),Zs={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Js=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n}return r.__extends(e,t),e.prototype.$l=function(t,e,n,r){return new Promise((function(i,o){var s=new a.XhrIo;s.listenOnce(a.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case a.ErrorCode.NO_ERROR:var e=s.getResponseJson();d("Connection","XHR received:",JSON.stringify(e)),i(e);break;case a.ErrorCode.TIMEOUT:d("Connection",'RPC "'+t+'" timed out'),o(new l(c.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(d("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(c).indexOf(e)>=0?e:c.UNKNOWN}(r.status);o(new l(u,r.message))}else o(new l(c.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new l(c.UNAVAILABLE,"Connection failed."));break;default:m()}}finally{d("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.pu=function(t,e){var n=[this.Cl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=a.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.xl(i.initMessageHeaders,e),s.isMobileCordova()||s.isReactNative()||s.isElectron()||s.isIE()||s.isUWP()||s.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");d("Connection","Creating WebChannel: "+o,i);var u=r.createWebChannel(o,i),h=!1,f=!1,p=new Qs({Pl:function(t){f?d("Connection","Not sending because WebChannel is closed:",t):(h||(d("Connection","Opening WebChannel transport."),u.open(),h=!0),d("Connection","WebChannel sending:",t),u.send(t))},gl:function(){return u.close()}}),v=function(t,e){u.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return v(a.WebChannel.EventType.OPEN,(function(){f||d("Connection","WebChannel transport opened.")})),v(a.WebChannel.EventType.CLOSE,(function(){f||(f=!0,d("Connection","WebChannel transport closed"),p.vl())})),v(a.WebChannel.EventType.ERROR,(function(t){f||(f=!0,y("Connection","WebChannel transport errored:",t),p.vl(new l(c.UNAVAILABLE,"The operation could not be completed")))})),v(a.WebChannel.EventType.MESSAGE,(function(t){var e;if(!f){var n=t.data[0];_(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){d("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=gt[t];if(void 0!==e)return xt(e)}(o),a=i.message;void 0===s&&(s=c.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),f=!0,p.vl(new l(s,a)),u.close()}else d("Connection","WebChannel received:",n),p.Sl(n)}})),setTimeout((function(){p.bl()}),0),p},e}(function(){function t(t){this.Dl=t,this.U=t.U;var e=t.ssl?"https":"http";this.Cl=e+"://"+t.host,this.Nl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return t.prototype.Ou=function(t,e,n,r){var i=this.Fl(t,e);d("RestConnection","Sending: ",i,n);var o={};return this.xl(o,r),this.$l(t,i,o,n).then((function(t){return d("RestConnection","Received: ",t),t}),(function(e){throw y("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Lu=function(t,e,n,r){return this.Ou(t,e,n,r)},t.prototype.xl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.0",t["Content-Type"]="text/plain",e)for(var n in e.zc)e.zc.hasOwnProperty(n)&&(t[n]=e.zc[n])},t.prototype.Fl=function(t,e){var n=Zs[t];return this.Cl+"/v1/"+e+":"+n},t}()),$s=function(){function t(){var t=this;this.kl=function(){return t.Ml()},this.Ol=function(){return t.Ll()},this.Bl=[],this.ql()}return t.prototype.nh=function(t){this.Bl.push(t)},t.prototype.Si=function(){window.removeEventListener("online",this.kl),window.removeEventListener("offline",this.Ol)},t.prototype.ql=function(){window.addEventListener("online",this.kl),window.addEventListener("offline",this.Ol)},t.prototype.Ml=function(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Bl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ll=function(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Bl;t<e.length;t++)(0,e[t])(1)},t.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ta=function(){function t(){}return t.prototype.nh=function(t){},t.prototype.Si=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t){return new ye(t,!0)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var na="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ra=function(){function t(){}return t.prototype.initialize=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Nh=this.Ul(t),this.persistence=this.Ql(t),[4,this.persistence.start()];case 1:return e.sent(),this.Wl=this.jl(t),this.zu=this.Kl(t),[2]}}))}))},t.prototype.jl=function(t){return null},t.prototype.Kl=function(t){return e=this.persistence,n=new zs,r=t.Gl,new po(e,n,r);var e,n,r},t.prototype.Ql=function(t){if(t.persistenceSettings.zl)throw new l(c.FAILED_PRECONDITION,na);return new Ys(Ks.Il)},t.prototype.Ul=function(t){return new Wr},t.prototype.terminate=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Wl&&this.Wl.stop(),[4,this.Nh.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}}))}))},t.prototype.clearPersistence=function(t,e){throw new l(c.FAILED_PRECONDITION,na)},t}(),ia=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),n=this.Hl._i,this.Nh instanceof Yr?(this.Nh._i={tr:Ms.bind(null,n),er:js.bind(null,n),nr:Bs.bind(null,n),Vi:Fs.bind(null,n)},[4,this.Nh.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.ec((function(t){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,Ls(this.Hl._i,t)];case 1:return e.sent(),this.Wl&&(t&&!this.Wl.Ti?this.Wl.start(this.zu):t||this.Wl.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},e.prototype.Ul=function(t){if(t.persistenceSettings.zl&&t.persistenceSettings.synchronizeTabs){var e=Tr();if(!Yr.On(e))throw new l(c.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=fo(t.Dl.U,t.Dl.persistenceKey);return new Yr(e,t.os,n,t.clientId,t.Gl)}return new Wr},e}(function(t){function e(e){var n=this;return(n=t.call(this)||this).Hl=e,n}return r.__extends(e,t),e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){return e=b(t),n=b(e.Fc),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return n.oa(t)})).then((function(t){e.Nc=t}))]}))}))}(this.zu)];case 2:return n.sent(),[4,this.Hl.initialize(this,e)];case 3:return n.sent(),[4,Gs(this.Hl._i)];case 4:return n.sent(),[4,$o(this.Hl.Dh)];case 5:return n.sent(),[2]}}))}))},e.prototype.jl=function(t){var e=this.persistence.Co.do;return new si(e,t.os)},e.prototype.Ql=function(t){var e=fo(t.Dl.U,t.Dl.persistenceKey),n=ea(t.Dl.U);return new ao(t.persistenceSettings.synchronizeTabs,e,t.clientId,oi.oo(t.persistenceSettings.cacheSizeBytes),t.os,Tr(),Ir(),n,this.Nh,t.persistenceSettings.La)},e.prototype.Ul=function(t){return new Wr},e.prototype.clearPersistence=function(t,e){return function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return vr.On()?(e=t+"main",[4,vr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(fo(t,e))},e}(ra)),oa=function(){function t(){}return t.prototype.initialize=function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.zu?[3,2]:(this.zu=t.zu,this.Nh=t.Nh,this.Hu=this.Yl(e),this.Dh=this.Jl(e),this.Ch=this.Xl(e),this._i=this.Zl(e),this.Nh.fi=function(t){return _s(n._i,t,1)},this.Dh.Yu.t_=Ds.bind(null,this._i),[4,ss(this.Dh,this._i.jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.Xl=function(t){return new Cr},t.prototype.Yl=function(t){var e,n=ea(t.Dl.U),r=(e=t.Dl,new Js(e));return function(t,e,n){return new Mo(t,e,n)}(t.credentials,r,n)},t.prototype.Jl=function(t){var e,n,r,i,o,s=this;return e=this.zu,n=this.Hu,r=t.os,i=function(t){return _s(s._i,t,0)},o=$s.On()?new $s:new ta,new Uo(e,n,r,i,o)},t.prototype.Zl=function(t){return function(t,e,n,r,i,o,s){var a=new ds(t,e,n,r,i,o);return s&&(a.Wh=!0),a}(this.zu,this.Dh,this.Ch,this.Nh,t.Gl,t.Fh,!t.persistenceSettings.zl||!t.persistenceSettings.synchronizeTabs)},t.prototype.terminate=function(){return jo(this.Dh)},t}(),sa=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.e_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.e_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.n_=function(){this.muted=!0},t.prototype.e_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),aa=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new l(c.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Y(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(R("FieldPath","string",e,t[e]),0===t[e].length)throw new l(c.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.s_=new S(t)},ua=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return r.__extends(e,t),e.documentId=function(){return new e(S.v().R())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw H("isEqual","FieldPath",1,t);return this.s_.isEqual(t.s_)},e}(aa),ha=new RegExp("[~\\*/\\[\\]]"),ca=function(){this.i_=this},la=function(t){function e(e){var n=this;return(n=t.call(this)||this).r_=e,n}return r.__extends(e,t),e.prototype.o_=function(t){if(2!==t.a_)throw 1===t.a_?t.c_(this.r_+"() can only appear at the top level of your update data"):t.c_(this.r_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(ca);function fa(t,e,n){return new Ia({a_:3,u_:e.settings.u_,methodName:t.r_,h_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var pa=function(t){function e(e){var n=this;return(n=t.call(this)||this).r_=e,n}return r.__extends(e,t),e.prototype.o_=function(t){return new an(t.path,new Ze)},e.prototype.isEqual=function(t){return t instanceof e},e}(ca),da=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).r_=e,r.l_=n,r}return r.__extends(e,t),e.prototype.o_=function(t){var e=fa(this,t,!0),n=this.l_.map((function(t){return Da(t,e)})),r=new Je(n);return new an(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ca),va=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).r_=e,r.l_=n,r}return r.__extends(e,t),e.prototype.o_=function(t){var e=fa(this,t,!0),n=this.l_.map((function(t){return Da(t,e)})),r=new tn(n);return new an(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ca),ya=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).r_=e,r.__=n,r}return r.__extends(e,t),e.prototype.o_=function(t){var e=new nn(t.serializer,_e(t.serializer,this.__));return new an(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(ca),ga=function(t){function e(){return t.call(this)||this}return r.__extends(e,t),e.delete=function(){return P("FieldValue.delete",arguments),new ma(new la("FieldValue.delete"))},e.serverTimestamp=function(){return P("FieldValue.serverTimestamp",arguments),new ma(new pa("FieldValue.serverTimestamp"))},e.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D("FieldValue.arrayUnion",arguments,1),new ma(new da("FieldValue.arrayUnion",t))},e.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D("FieldValue.arrayRemove",arguments,1),new ma(new va("FieldValue.arrayRemove",t))},e.increment=function(t){return R("FieldValue.increment","number",1,t),C("FieldValue.increment",arguments,1),new ma(new ya("FieldValue.increment",t))},e}(ca),ma=function(t){function e(e){var n=this;return(n=t.call(this)||this).i_=e,n.r_=e.r_,n}return r.__extends(e,t),e.prototype.o_=function(t){return this.i_.o_(t)},e.prototype.isEqual=function(t){return t instanceof e&&this.i_.isEqual(t.i_)},e}(ga),_a=function(){function t(t,e){if(C("GeoPoint",arguments,2),R("GeoPoint","number",1,t),R("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new l(c.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new l(c.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.f_=t,this.d_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.f_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.d_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.f_===t.f_&&this.d_===t.d_},t.prototype.toJSON=function(){return{latitude:this.f_,longitude:this.d_}},t.prototype.H=function(t){return Q(this.f_,t.f_)||Q(this.d_,t.d_)},t}(),ba=/^__.*__$/,wa=function(t,e,n){this.w_=t,this.m_=e,this.T_=n},xa=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.E_=function(t,e){var n=[];return null!==this.Qe?n.push(new mn(t,this.data,this.Qe,e)):n.push(new gn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new bn(t,this.fieldTransforms)),n},t}(),Ea=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.E_=function(t,e){var n=[new mn(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new bn(t,this.fieldTransforms)),n},t}();function Ta(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}var Ia=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.I_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.A_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.R_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.A_({path:n,h_:!1});return r.P_(t),r},t.prototype.g_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.A_({path:n,h_:!1});return r.I_(),r},t.prototype.y_=function(t){return this.A_({path:void 0,h_:!0})},t.prototype.c_=function(t){return ka(t,this.settings.methodName,this.settings.V_||!1,this.path,this.settings.u_)},t.prototype.contains=function(t){return void 0!==this.Qe.find((function(e){return t.T(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.T(e.field)}))},t.prototype.I_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.P_(this.path.get(t))},t.prototype.P_=function(t){if(0===t.length)throw this.c_("Document fields must not be empty");if(Ta(this.a_)&&ba.test(t))throw this.c_('Document fields cannot begin and end with "__"')},t}(),Aa=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||ea(t)}return t.prototype.p_=function(t,e,n,r){return void 0===r&&(r=!1),new Ia({a_:t,methodName:e,u_:n,path:S.g(),h_:!1,V_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function Sa(t,e,n,r,i,o){void 0===o&&(o={});var s=t.p_(o.merge||o.mergeFields?2:0,e,n,i);Ma("Data must be an object, but it was:",s,r);var a,u,h=Na(r,s);if(o.merge)a=new sn(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var f=[],p=0,d=o.mergeFields;p<d.length;p++){var v=d[p],y=void 0;if(v instanceof aa)y=v.s_;else{if("string"!=typeof v)throw m();y=Ua(e,v,n)}if(!s.contains(y))throw new l(c.INVALID_ARGUMENT,"Field '"+y+"' is specified in your field mask but missing from your input data.");Fa(f,y)||f.push(y)}a=new sn(f),u=s.fieldTransforms.filter((function(t){return a.He(t.field)}))}else a=null,u=s.fieldTransforms;return new xa(new In(h),a,u)}function Oa(t,e,n,r){var i=t.p_(1,e,n);Ma("Data must be an object, but it was:",i,r);var o=[],s=new An;x(r,(function(t,r){var a=Ua(e,t,n),u=i.g_(a);if(r instanceof ca&&r.i_ instanceof la)o.push(a);else{var h=Da(r,u);null!=h&&(o.push(a),s.set(a,h))}}));var a=new sn(o);return new Ea(s.Je(),a,i.fieldTransforms)}function Pa(t,e,n,r,i,o){var s=t.p_(1,e,n),a=[La(e,r,n)],u=[i];if(o.length%2!=0)throw new l(c.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(La(e,o[h])),u.push(o[h+1]);for(var f=[],p=new An,d=a.length-1;d>=0;--d)if(!Fa(f,a[d])){var v=a[d],y=u[d],g=s.g_(v);if(y instanceof ca&&y.i_ instanceof la)f.push(v);else{var m=Da(y,g);null!=m&&(f.push(v),p.set(v,m))}}var _=new sn(f);return new Ea(p.Je(),_,s.fieldTransforms)}function Ca(t,e,n,r){return void 0===r&&(r=!1),Da(n,t.p_(r?4:3,e))}function Da(t,e){if(Ra(t))return Ma("Unsupported field value:",e,t),Na(t,e);if(t instanceof ca)return function(t,e){if(!Ta(e.a_))throw e.c_(t.r_+"() can only be used with update() and set()");if(!e.path)throw e.c_(t.r_+"() is not currently supported inside arrays");var n=t.o_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.h_&&4!==e.a_)throw e.c_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Da(o[i],e.y_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return _e(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=at.fromDate(t);return{timestampValue:be(e.serializer,n)}}if(t instanceof at){var r=new at(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:be(e.serializer,r)}}if(t instanceof _a)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof tt)return{bytesValue:we(e.serializer,t.q)};if(t instanceof wa){var i=e.U,o=t.w_;if(!o.isEqual(i))throw e.c_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Te(t.w_||e.U,t.m_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.c_("Unsupported field value: "+V(t))}(t,e)}function Na(t,e){var n={};return E(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):x(t,(function(t,r){var i=Da(r,e.R_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ra(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof at||t instanceof _a||t instanceof tt||t instanceof wa||t instanceof ca)}function Ma(t,e,n){if(!Ra(n)||!B(n)){var r=V(n);throw"an object"===r?e.c_(t+" a custom object"):e.c_(t+" "+r)}}function La(t,e,n){if(e instanceof aa)return e.s_;if("string"==typeof e)return Ua(t,e);throw ka("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ua(t,e,n){try{return function(t){if(t.search(ha)>=0)throw new l(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ua.bind.apply(ua,r.__spreadArrays([void 0],t.split("."))))}catch(e){throw new l(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).s_}catch(e){throw ka((i=e)instanceof Error?i.message:i.toString(),t,!1,void 0,n)}var i}function ka(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new l(c.INVALID_ARGUMENT,(a+=". ")+t+u)}function Fa(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ja=function(){function t(t){this.Hu=t,this.b_=new Map,this.mutations=[],this.v_=!1,this.S_=null,this.D_=new Set}return t.prototype.C_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:if(this.N_(),this.mutations.length>0)throw new l(c.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a,u;return r.__generator(this,(function(r){switch(r.label){case 0:return n=b(t),i=Ce(n.serializer)+"/documents",o={documents:e.map((function(t){return Ae(n.serializer,t)}))},[4,n.Lu("BatchGetDocuments",i,o)];case 1:return s=r.sent(),a=new Map,s.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){_(!!e.found),e.found.name,e.found.updateTime;var n=Se(t,e.found.name),r=Ee(e.found.updateTime),i=new In({mapValue:{fields:e.found.fields}});return new Pn(n,r,i,{})}(t,e):"missing"in e?function(t,e){_(!!e.missing),_(!!e.readTime);var n=Se(t,e.missing),r=Ee(e.readTime);return new Cn(n,r)}(t,e):m()}(n.serializer,t);a.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=a.get(t.toString());_(!!e),u.push(e)})),u)]}}))}))}(this.Hu,t)];case 1:return[2,((e=i.sent()).forEach((function(t){t instanceof Cn||t instanceof Pn?n.F_(t):m()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.E_(t,this.Ke(t))),this.D_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.E_(t,this.x_(t)))}catch(t){this.S_=t}this.D_.add(t.toString())},t.prototype.delete=function(t){this.write([new En(t,this.Ke(t))]),this.D_.add(t.toString())},t.prototype.commit=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(this.N_(),this.S_)throw this.S_;return t=this.b_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=O.D(n);e.mutations.push(new Tn(r,e.Ke(r)))})),[4,function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=b(t),i=Ce(n.serializer)+"/documents",o={writes:e.map((function(t){return Re(n.serializer,t)}))},[4,n.Ou("Commit",i,o)];case 1:return r.sent(),[2]}}))}))}(this.Hu,this.mutations)];case 1:return n.sent(),this.v_=!0,[2]}}))}))},t.prototype.F_=function(t){var e;if(t instanceof Pn)e=t.version;else{if(!(t instanceof Cn))throw m();e=ut.min()}var n=this.b_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new l(c.ABORTED,"Document version changed between two reads.")}else this.b_.set(t.key.toString(),e)},t.prototype.Ke=function(t){var e=this.b_.get(t.toString());return!this.D_.has(t.toString())&&e?hn.updateTime(e):hn.Ge()},t.prototype.x_=function(t){var e=this.b_.get(t.toString());if(!this.D_.has(t.toString())&&e){if(e.isEqual(ut.min()))throw new l(c.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hn.updateTime(e)}return hn.exists(!0)},t.prototype.write=function(t){this.N_(),this.mutations=this.mutations.concat(t)},t.prototype.N_=function(){},t}(),Ba=function(){function t(t,e,n,r){this.os=t,this.Hu=e,this.updateFunction=n,this.hs=r,this.k_=5,this.gs=new pr(this.os,"transaction_retry")}return t.prototype.run=function(){this.M_()},t.prototype.M_=function(){var t=this;this.gs.Rn((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return r.__generator(this,(function(r){return t=new ja(this.Hu),(e=this.O_(t))&&e.then((function(e){n.os.ds((function(){return t.commit().then((function(){n.hs.resolve(e)})).catch((function(t){n.L_(t)}))}))})).catch((function(t){n.L_(t)})),[2]}))}))}))},t.prototype.O_=function(t){try{var e=this.updateFunction(t);return!ht(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},t.prototype.L_=function(t){var e=this;this.k_>0&&this.B_(t)?(this.k_-=1,this.os.ds((function(){return e.M_(),Promise.resolve()}))):this.hs.reject(t)},t.prototype.B_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!wt(e)}return!1},t}(),Va=function(){function t(t,e){this.credentials=t,this.os=e,this.clientId=K.k(),this.q_=new fr}return t.prototype.start=function(t,e,n,i){var o=this;this.U_(),this.Dl=t;var s=new fr,a=!1;return this.credentials.Jc((function(t){if(!a)return a=!0,d("FirestoreClient","Initializing. user=",t.uid),o.Q_(e,n,i,t,s).then(o.q_.resolve,o.q_.reject);o.os.Ds((function(){return function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return(n=b(t)).os.Fs(),d("RemoteStore","RemoteStore received new credentials"),i=qo(n),n.Zu.add(3),[4,Fo(n)];case 1:return r.sent(),i&&n.sh.set("Unknown"),[4,n.Yu.t_(e)];case 2:return r.sent(),n.Zu.delete(3),[4,ko(n)];case 3:return r.sent(),[2]}}))}))}(o.Dh,t)}))})),this.os.ds((function(){return o.q_.promise})),s.promise},t.prototype.enableNetwork=function(){var t=this;return this.U_(),this.os.enqueue((function(){return t.persistence.sc(!0),function(t){var e=b(t);return e.Zu.delete(0),ko(e)}(t.Dh)}))},t.prototype.Q_=function(t,e,n,i,o){return r.__awaiter(this,void 0,void 0,(function(){var s,a,u=this;return r.__generator(this,(function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),s={os:this.os,Dl:this.Dl,clientId:this.clientId,credentials:this.credentials,Gl:i,Fh:100,persistenceSettings:n},[4,t.initialize(s)];case 1:return h.sent(),[4,e.initialize(t,s)];case 2:return h.sent(),this.persistence=t.persistence,this.Nh=t.Nh,this.zu=t.zu,this.Wl=t.Wl,this.Hu=e.Hu,this.Dh=e.Dh,this._i=e._i,this.W_=e.Ch,this.W_.qs=vs.bind(null,this._i),this.W_.Ws=gs.bind(null,this._i),this.persistence.nc((function(){return r.__awaiter(u,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(a=h.sent(),o.reject(a),!this.j_(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.Q_(new ra,new oa,{zl:!1},i,o))];case 4:return[2]}}))}))},t.prototype.j_=function(t){return"FirebaseError"===t.name?t.code===c.FAILED_PRECONDITION||t.code===c.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.U_=function(){if(this.os.Vs)throw new l(c.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.U_(),this.os.enqueue((function(){return t.persistence.sc(!1),function(t){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return(e=b(t)).Zu.add(0),[4,Fo(e)];case 1:return n.sent(),e.sh.set("Offline"),[2]}}))}))}(t.Dh)}))},t.prototype.terminate=function(){var t=this;this.os.Ss();var e=new fr;return this.os.ps((function(){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.Wl&&this.Wl.stop(),[4,jo(this.Dh)];case 1:return r.sent(),[4,this.Nh.Si()];case 2:return r.sent(),[4,this.persistence.Si()];case 3:return r.sent(),this.credentials.Xc(),e.resolve(),[3,5];case 4:return t=r.sent(),n=Or(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}}))}))})),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.U_();var e=new fr;return this.os.ds((function(){return function(t,e){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:qo((n=b(t)).Dh)||d("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,function(t){var e=b(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.vr.Bo(t)}))}(n.zu)];case 2:return-1===(i=r.sent())?[2,void e.resolve()]:((o=n.Uh.get(i)||[]).push(e),n.Uh.set(i,o),[3,4]);case 3:return s=r.sent(),a=Or(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}(t._i,e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.U_();var i=new sa(n),o=new Ur(t,i,e);return this.os.ds((function(){return Dr(r.W_,o)})),function(){i.n_(),r.os.ds((function(){return Nr(r.W_,o)}))}},t.prototype.K_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.U_(),[4,this.q_.promise];case 1:return i.sent(),e=new fr,[2,(this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t,e){var n=b(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.xc.Dr(t,e)}))}(t,e)];case 1:return(i=r.sent())instanceof Pn?n.resolve(i):i instanceof Cn?n.resolve(null):n.reject(new l(c.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=r.sent(),s=Or(o,"Failed to get document '"+e+" from cache"),n.reject(s),[3,3];case 3:return[2]}}))}))}(n.zu,t,e)})),e.promise)]}}))}))},t.prototype.G_=function(t,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.U_(),[4,this.q_.promise];case 1:return r.sent(),n=new fr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new sa({next:function(o){e.ds((function(){return Nr(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new l(c.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new l(c.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Ur(Mn(n.path),o,{includeMetadataChanges:!0,Js:!0});return Dr(t,s)}(i.W_,i.os,t,e,n)})),n.promise)]}}))}))},t.prototype.z_=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.U_(),[4,this.q_.promise];case 1:return i.sent(),e=new fr,[2,(this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,wo(t,e,!0)];case 1:return i=r.sent(),o=new ls(e,i.kc),s=o.Eh(i.documents),a=o.gr(s,!1),n.resolve(a.snapshot),[3,3];case 2:return u=r.sent(),h=Or(u,"Failed to execute query '"+e+" against cache"),n.reject(h),[3,3];case 3:return[2]}}))}))}(n.zu,t,e)})),e.promise)]}}))}))},t.prototype.H_=function(t,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.U_(),[4,this.q_.promise];case 1:return r.sent(),n=new fr,[2,(this.os.ds((function(){return function(t,e,n,r,i){var o=new sa({next:function(n){e.ds((function(){return Nr(t,s)})),n.fromCache&&"server"===r.source?i.reject(new l(c.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Ur(n,o,{includeMetadataChanges:!0,Js:!0});return Dr(t,s)}(i.W_,i.os,t,e,n)})),n.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.U_();var n=new fr;return this.os.ds((function(){return function(t,e,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,s,a;return r.__generator(this,(function(r){switch(r.label){case 0:i=Gs(t),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,function(t,e){var n,r=b(t),i=at.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Lt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.xc.$r(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var h=u[a],c=dn(h,n.get(h.key));null!=c&&s.push(new mn(h.key,c,Sn(c.proto.mapValue),hn.exists(!0)))}return r.vr.$o(t,i,s,e)}))})).then((function(t){var e=t.hr(n);return{batchId:t.batchId,dr:e}}))}(i.zu,e)];case 2:return o=r.sent(),i.Nh.Fi(o.batchId),function(t,e,n){var r=t.qh[t.currentUser.Zs()];r||(r=new Et(Q)),r=r.rt(e,n),t.qh[t.currentUser.Zs()]=r}(i,o.batchId,n),[4,Cs(i,o.dr)];case 3:return r.sent(),[4,$o(i.Dh)];case 4:return r.sent(),[3,6];case 5:return s=r.sent(),a=Or(s,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}(e._i,t,n)})),n.promise},t.prototype.U=function(){return this.Dl.U},t.prototype.Y_=function(t){var e=this;this.U_();var n=new sa(t);return this.os.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,function(t,e){b(t).Bs.add(e),e.next()}(this.W_,n)]}))}))})),function(){n.n_(),e.os.ds((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,function(t,e){b(t).Bs.delete(e)}(this.W_,n)]}))}))}))}},Object.defineProperty(t.prototype,"J_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.U_();var n=new fr;return this.os.ds((function(){return new Ba(e.os,e.Hu,t,n).run(),Promise.resolve()})),n.promise},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var za=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.X_=n,this.Z_=r,this.tf=i}return t.prototype.ef=function(t){switch($t(t)){case 0:return null;case 1:return t.booleanValue;case 2:return se(t.integerValue||t.doubleValue);case 3:return this.nf(t.timestampValue);case 4:return this.sf(t);case 5:return t.stringValue;case 6:return this.tf(ae(t.bytesValue));case 7:return this.if(t.referenceValue);case 8:return this.rf(t.geoPointValue);case 9:return this.af(t.arrayValue);case 10:return this.cf(t.mapValue);default:throw m()}},t.prototype.cf=function(t){var e=this,n={};return x(t.fields||{},(function(t,r){n[t]=e.ef(r)})),n},t.prototype.rf=function(t){return new _a(se(t.latitude),se(t.longitude))},t.prototype.af=function(t){var e=this;return(t.values||[]).map((function(t){return e.ef(t)}))},t.prototype.sf=function(t){switch(this.X_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Qt(n)?t(n):n}(t);return null==e?null:this.ef(e);case"estimate":return this.nf(Zt(t));default:return null}},t.prototype.nf=function(t){var e=oe(t),n=new at(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.if=function(t){var e=I.P(t);_(qe(e));var n=new ot(e.get(1),e.get(3)),r=new O(e.u(5));return n.isEqual(this.U)||v("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Z_(r)},t}(),Ha=oi.uo,Xa=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new l(c.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else L("settings","non-empty string","host",t.host),this.host=t.host,U("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(z("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),U("settings","object","credentials",t.credentials),this.credentials=t.credentials,U("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),U("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?v("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&v("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,U("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=oi.lo;else{if(t.cacheSizeBytes!==Ha&&t.cacheSizeBytes<oi.ho)throw new l(c.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+oi.ho);this.cacheSizeBytes=t.cacheSizeBytes}U("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),qa=function(){function t(e,n,i,o){var s=this;if(void 0===i&&(i=new ra),void 0===o&&(o=new oa),this.uf=i,this.hf=o,this.lf=null,this._f=new Sr,this.INTERNAL={delete:function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.ff(),[4,this.df.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var a=e;this.lf=a,this.w_=t.wf(a),this.mf=a.name,this.Tf=new Oo(n)}else{var u=e;if(!u.projectId)throw new l(c.INVALID_ARGUMENT,"Must provide projectId");this.w_=new ot(u.projectId,u.database),this.mf="[DEFAULT]",this.Tf=new So}this.Ef=new Xa({})}return Object.defineProperty(t.prototype,"If",{get:function(){return this.Af||(this.Af=new Aa(this.w_,this.Ef.ignoreUndefinedProperties)),this.Af},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){C("Firestore.settings",arguments,1),R("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Ef),t)).merge;var e=new Xa(t);if(this.df&&!this.Ef.isEqual(e))throw new l(c.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.Ef=e,void 0!==e.credentials&&(this.Tf=function(t){if(!t)return new So;switch(t.type){case"gapi":var e=t.Rf;return _(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Co(e,t.iu||"0");case"provider":return t.Rf;default:throw new l(c.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ff(),this.df.enableNetwork()},t.prototype.disableNetwork=function(){return this.ff(),this.df.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.df)throw new l(c.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&v("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new l(c.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Pf(this.uf,this.hf,{zl:!0,cacheSizeBytes:this.Ef.cacheSizeBytes,synchronizeTabs:r,La:i})},t.prototype.clearPersistence=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e=this;return r.__generator(this,(function(n){if(void 0!==this.df&&!this.df.J_)throw new l(c.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new fr,[2,(this._f.ps((function(){return r.__awaiter(e,void 0,void 0,(function(){var e;return r.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.uf.clearPersistence(this.w_,this.mf)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"gf",{get:function(){return this.ff(),this.df.J_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ff(),this.df.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ff(),Ga(t))return this.df.Y_(t);R("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.df.Y_(e)},t.prototype.ff=function(){return this.df||this.Pf(new ra,new oa,{zl:!1}),this.df},t.prototype.yf=function(){return new it(this.w_,this.mf,this.Ef.host,this.Ef.ssl,this.Ef.experimentalForceLongPolling)},t.prototype.Pf=function(t,e,n){var r=this.yf();return this.df=new Va(this.Tf,this._f),this.df.start(r,t,e,n)},t.wf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new l(c.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(!n||"string"!=typeof n)throw new l(c.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ot(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.lf)throw new l(c.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.lf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return C("Firestore.collection",arguments,1),R("Firestore.collection","non-empty string",1,t),this.ff(),new au(I.P(t),this,null)},t.prototype.doc=function(t){return C("Firestore.doc",arguments,1),R("Firestore.doc","non-empty string",1,t),this.ff(),Ka.Vf(I.P(t),this,null)},t.prototype.collectionGroup=function(t){if(C("Firestore.collectionGroup",arguments,1),R("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new l(c.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ff(),new ou(function(t){return new Nn(I.g(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return C("Firestore.runTransaction",arguments,1),R("Firestore.runTransaction","function",1,t),this.ff().transaction((function(n){return t(new Ya(e,n))}))},t.prototype.batch=function(){return this.ff(),new Wa(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(p()){case o.LogLevel.DEBUG:return"debug";case o.LogLevel.ERROR:return"error";case o.LogLevel.SILENT:return"silent";case o.LogLevel.WARN:return"warn";case o.LogLevel.INFO:return"info";case o.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;C("Firestore.setLogLevel",arguments,1),F("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,f.setLogLevel(e)},t.prototype.pf=function(){return this.Ef.timestampsInSnapshots},t.prototype.bf=function(){return this.Ef},t}(),Ya=function(){function t(t,e){this.vf=t,this.Sf=e}return t.prototype.get=function(t){var e=this;C("Transaction.get",arguments,1);var n=lu("Transaction.get",t,this.vf);return this.Sf.C_([n.m_]).then((function(t){if(!t||1!==t.length)return m();var r=t[0];if(r instanceof Cn)return new Za(e.vf,n.m_,null,!1,!1,n.T_);if(r instanceof Pn)return new Za(e.vf,n.m_,r,!1,!1,n.T_);throw m()}))},t.prototype.set=function(t,e,n){N("Transaction.set",arguments,2,3);var r=lu("Transaction.set",t,this.vf);n=uu("Transaction.set",n);var i=pu(r.T_,e,n),o=Sa(this.vf.If,"Transaction.set",r.m_,i,null!==r.T_,n);return this.Sf.set(r.m_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof ua?(D("Transaction.update",arguments,3),r=lu("Transaction.update",t,this.vf),i=Pa(this.vf.If,"Transaction.update",r.m_,e,n,o)):(C("Transaction.update",arguments,2),r=lu("Transaction.update",t,this.vf),i=Oa(this.vf.If,"Transaction.update",r.m_,e)),this.Sf.update(r.m_,i),this},t.prototype.delete=function(t){C("Transaction.delete",arguments,1);var e=lu("Transaction.delete",t,this.vf);return this.Sf.delete(e.m_),this},t}(),Wa=function(){function t(t){this.vf=t,this.Df=[],this.Cf=!1}return t.prototype.set=function(t,e,n){N("WriteBatch.set",arguments,2,3),this.Nf();var r=lu("WriteBatch.set",t,this.vf);n=uu("WriteBatch.set",n);var i=pu(r.T_,e,n),o=Sa(this.vf.If,"WriteBatch.set",r.m_,i,null!==r.T_,n);return this.Df=this.Df.concat(o.E_(r.m_,hn.Ge())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Nf(),"string"==typeof e||e instanceof ua?(D("WriteBatch.update",arguments,3),r=lu("WriteBatch.update",t,this.vf),i=Pa(this.vf.If,"WriteBatch.update",r.m_,e,n,o)):(C("WriteBatch.update",arguments,2),r=lu("WriteBatch.update",t,this.vf),i=Oa(this.vf.If,"WriteBatch.update",r.m_,e)),this.Df=this.Df.concat(i.E_(r.m_,hn.exists(!0))),this},t.prototype.delete=function(t){C("WriteBatch.delete",arguments,1),this.Nf();var e=lu("WriteBatch.delete",t,this.vf);return this.Df=this.Df.concat(new En(e.m_,hn.Ge())),this},t.prototype.commit=function(){return this.Nf(),this.Cf=!0,this.Df.length>0?this.vf.ff().write(this.Df):Promise.resolve()},t.prototype.Nf=function(){if(this.Cf)throw new l(c.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ka=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.w_,e,r)||this).m_=e,i.firestore=n,i.T_=r,i.df=i.firestore.ff(),i}return r.__extends(e,t),e.Vf=function(t,n,r){if(t.length%2!=0)throw new l(c.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new e(new O(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.m_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new au(this.m_.path.h(),this.firestore,this.T_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.m_.path.R()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(C("DocumentReference.collection",arguments,1),R("DocumentReference.collection","non-empty string",1,t),!t)throw new l(c.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=I.P(t);return new au(this.m_.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw H("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.m_.isEqual(t.m_)&&this.T_===t.T_},e.prototype.set=function(t,e){N("DocumentReference.set",arguments,1,2),e=uu("DocumentReference.set",e);var n=pu(this.T_,t,e),r=Sa(this.firestore.If,"DocumentReference.set",this.m_,n,null!==this.T_,e);return this.df.write(r.E_(this.m_,hn.Ge()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof ua?(D("DocumentReference.update",arguments,2),n=Pa(this.firestore.If,"DocumentReference.update",this.m_,t,e,r)):(C("DocumentReference.update",arguments,1),n=Oa(this.firestore.If,"DocumentReference.update",this.m_,t)),this.df.write(n.E_(this.m_,hn.exists(!0)))},e.prototype.delete=function(){return C("DocumentReference.delete",arguments,0),this.df.write([new En(this.m_,hn.Ge())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];N("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Ga(i[a])||(z("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),U("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u={includeMetadataChanges:s.includeMetadataChanges};if(Ga(i[a])){var h=i[a];i[a]=null===(t=h.next)||void 0===t?void 0:t.bind(h),i[a+1]=null===(e=h.error)||void 0===e?void 0:e.bind(h),i[a+2]=null===(n=h.complete)||void 0===n?void 0:n.bind(h)}else R("DocumentReference.onSnapshot","function",a,i[a]),M("DocumentReference.onSnapshot","function",a+1,i[a+1]),M("DocumentReference.onSnapshot","function",a+2,i[a+2]);var c={next:function(t){i[a]&&i[a](r.Ff(t))},error:i[a+1],complete:i[a+2]};return this.df.listen(Mn(this.m_.path),u,c)},e.prototype.get=function(t){var e=this;N("DocumentReference.get",arguments,0,1),cu("DocumentReference.get",t);var n=this.firestore.ff();return t&&"cache"===t.source?n.K_(this.m_).then((function(t){return new Za(e.firestore,e.m_,t,!0,t instanceof Pn&&t.Ye,e.T_)})):n.G_(this.m_,t).then((function(t){return e.Ff(t)}))},e.prototype.withConverter=function(t){return new e(this.m_,this.firestore,t)},e.prototype.Ff=function(t){var e=t.docs.get(this.m_);return new Za(this.firestore,this.m_,e,t.fromCache,t.hasPendingWrites,this.T_)},e}(wa),Qa=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Za=function(){function t(t,e,n,r,i,o){this.vf=t,this.m_=e,this.xf=n,this.$f=r,this.kf=i,this.T_=o}return t.prototype.data=function(t){var e=this;if(N("DocumentSnapshot.data",arguments,0,1),t=hu("DocumentSnapshot.data",t),this.xf){if(this.T_){var n=new Ja(this.vf,this.m_,this.xf,this.$f,this.kf,null);return this.T_.fromFirestore(n,t)}return new za(this.vf.w_,this.vf.pf(),t.serverTimestamps||"none",(function(t){return new Ka(t,e.vf,null)}),(function(t){return new rt(t)})).ef(this.xf.sn())}},t.prototype.get=function(t,e){var n=this;if(N("DocumentSnapshot.get",arguments,1,2),e=hu("DocumentSnapshot.get",e),this.xf){var r=this.xf.data().field(La("DocumentSnapshot.get",t,this.m_));if(null!==r)return new za(this.vf.w_,this.vf.pf(),e.serverTimestamps||"none",(function(t){return new Ka(t,n.vf,n.T_)}),(function(t){return new rt(t)})).ef(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.m_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ka(this.m_,this.vf,this.T_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.xf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Qa(this.kf,this.$f)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","DocumentSnapshot",1,e);return this.vf===e.vf&&this.$f===e.$f&&this.m_.isEqual(e.m_)&&(null===this.xf?null===e.xf:this.xf.isEqual(e.xf))&&this.T_===e.T_},t}(),Ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Za);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t,e,n,r,i,o,s){var a;if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new l(c.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){nu(s,o);for(var u=[],h=0,f=s;h<f.length;h++){var p=f[h];u.push(eu(r,t,p))}a={arrayValue:{values:u}}}else a=eu(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||nu(s,o),a=Ca(n,e,s,"in"===o||"not-in"===o);var d=Qn.create(i,o,a);return function(t,e){if(e.un()){var n=Fn(t);if(null!==n&&!n.isEqual(e.field))throw new l(c.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=kn(t);null!==r&&ru(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new l(c.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new l(c.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,d),d}function tu(t,e,n){if(null!==t.startAt)throw new l(c.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new l(c.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new hr(e,n);return function(t,e){if(null===kn(t)){var n=Fn(t);null!==n&&ru(t,n,e.field)}}(t,r),r}function eu(t,e,n){if("string"==typeof n){if(""===n)throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!jn(e)&&-1!==n.indexOf("/"))throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(I.P(n));if(!O.F(r))throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ue(t,new O(r))}if(n instanceof wa)return ue(t,n.m_);throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+V(n)+".")}function nu(t,e){if(!Array.isArray(t)||0===t.length)throw new l(c.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new l(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new l(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new l(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function ru(t,e,n){if(!n.isEqual(e))throw new l(c.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function iu(t){if(Un(t)&&0===t.rn.length)throw new l(c.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ou=function(){function t(t,e,n){this.Mf=t,this.firestore=e,this.T_=n}return t.prototype.where=function(e,n,r){C("Query.where",arguments,3),G("Query.where",3,r);var i=F("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),o=La("Query.where",e),s=$a(this.Mf,"Query.where",this.firestore.If,this.firestore.w_,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new Nn(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.on,t.startAt,t.endAt)}(this.Mf,s),this.firestore,this.T_)},t.prototype.orderBy=function(e,n){var r;if(N("Query.orderBy",arguments,1,2),M("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new l(c.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=La("Query.orderBy",e),o=tu(this.Mf,i,r);return new t(function(t,e){var n=t.rn.concat([e]);return new Nn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(this.Mf,o),this.firestore,this.T_)},t.prototype.limit=function(e){return C("Query.limit",arguments,1),R("Query.limit","number",1,e),X("Query.limit",1,e),new t(Gn(this.Mf,e,"F"),this.firestore,this.T_)},t.prototype.limitToLast=function(e){return C("Query.limitToLast",arguments,1),R("Query.limitToLast","number",1,e),X("Query.limitToLast",1,e),new t(Gn(this.Mf,e,"L"),this.firestore,this.T_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.startAt",arguments,1);var i=this.Of("Query.startAt",e,n,!0);return new t(zn(this.Mf,i),this.firestore,this.T_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.startAfter",arguments,1);var i=this.Of("Query.startAfter",e,n,!1);return new t(zn(this.Mf,i),this.firestore,this.T_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.endBefore",arguments,1);var i=this.Of("Query.endBefore",e,n,!0);return new t(Hn(this.Mf,i),this.firestore,this.T_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];D("Query.endAt",arguments,1);var i=this.Of("Query.endAt",e,n,!1);return new t(Hn(this.Mf,i),this.firestore,this.T_)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","Query",1,e);return this.firestore===e.firestore&&Xn(this.Mf,e.Mf)&&this.T_===e.T_},t.prototype.withConverter=function(e){return new t(this.Mf,this.firestore,e)},t.prototype.Of=function(t,e,n,i){if(G(t,1,e),e instanceof Za)return C(t,r.__spreadArrays([e],n),1),function(t,e,n,r,i){if(!r)throw new l(c.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Bn(t);s<a.length;s++){var u=a[s];if(u.field.p())o.push(ue(e,r.key));else{var h=r.field(u.field);if(Qt(h))throw new l(c.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===h){var f=u.field.R();throw new l(c.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+f+"' (used as the orderBy) does not exist.")}o.push(h)}}return new or(o,i)}(this.Mf,this.firestore.w_,t,e.xf,i);var o=[e].concat(n);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new l(c.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.p()){if("string"!=typeof h)throw new l(c.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!jn(t)&&-1!==h.indexOf("/"))throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var f=t.path.child(I.P(h));if(!O.F(f))throw new l(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+f+"' is not because it contains an odd number of segments.");var p=new O(f);a.push(ue(e,p))}else{var d=Ca(n,r,h);a.push(d)}}return new or(a,o)}(this.Mf,this.firestore.w_,this.firestore.If,t,o,i)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];N("Query.onSnapshot",arguments,1,4);var s={},a=0;if("object"!=typeof i[a]||Ga(i[a])||(z("Query.onSnapshot",s=i[a],["includeMetadataChanges"]),U("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++),Ga(i[a])){var u=i[a];i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)}else R("Query.onSnapshot","function",a,i[a]),M("Query.onSnapshot","function",a+1,i[a+1]),M("Query.onSnapshot","function",a+2,i[a+2]);var h={next:function(t){i[a]&&i[a](new su(r.firestore,r.Mf,t,r.T_))},error:i[a+1],complete:i[a+2]};return iu(this.Mf),this.firestore.ff().listen(this.Mf,s,h)},t.prototype.get=function(t){var e=this;N("Query.get",arguments,0,1),cu("Query.get",t),iu(this.Mf);var n=this.firestore.ff();return(t&&"cache"===t.source?n.z_(this.Mf):n.H_(this.Mf,t)).then((function(t){return new su(e.firestore,e.Mf,t,e.T_)}))},t}(),su=function(){function t(t,e,n,r){this.vf=t,this.Lf=e,this.Bf=n,this.T_=r,this.qf=null,this.Uf=null,this.metadata=new Qa(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Bf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Bf.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;N("QuerySnapshot.forEach",arguments,1,2),R("QuerySnapshot.forEach","function",1,t),this.Bf.docs.forEach((function(r){t.call(e,n.Qf(r,n.metadata.fromCache,n.Bf.Qt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new ou(this.Lf,this.vf,this.T_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(z("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),U("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Bf.jt)throw new l(c.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.qf&&this.Uf===e||(this.qf=function(t,e,n){if(t.Ut.m()){var r=0;return t.docChanges.map((function(e){var i=n(e.doc,t.fromCache,t.Qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=t.Ut;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:fu(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Bf,e,this.Qf.bind(this)),this.Uf=e),this.qf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw H("isEqual","QuerySnapshot",1,e);return this.vf===e.vf&&Xn(this.Lf,e.Lf)&&this.Bf.isEqual(e.Bf)&&this.T_===e.T_},t.prototype.Qf=function(t,e,n){return new Ja(this.vf,t.key,t,e,n,this.T_)},t}(),au=function(t){function e(e,n,r){var i=this;if((i=t.call(this,Mn(e),n,r)||this).Wf=e,e.length%2!=1)throw new l(c.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.R()+" has "+e.length);return i}return r.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Mf.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Mf.path.h();return t.m()?null:new Ka(new O(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Mf.path.R()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){N("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=K.k()),R("CollectionReference.doc","non-empty string",1,t);var e=I.P(t);return Ka.Vf(this.Mf.path.child(e),this.firestore,this.T_)},e.prototype.add=function(t){C("CollectionReference.add",arguments,1);var e=this.T_?this.T_.toFirestore(t):t;R("CollectionReference.add","object",1,e);var n=this.doc();return new Ka(n.m_,this.firestore,null).set(e).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Wf,this.firestore,t)},e}(ou);function uu(t,e){if(void 0===e)return{merge:!1};if(z(t,e,["merge","mergeFields"]),U(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+V(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new l(c.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+V(r[o]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof ua}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new l(c.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function hu(t,e){return void 0===e?{}:(z(t,e,["serverTimestamps"]),k(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function cu(t,e){M(t,"object",1,e),e&&(z(t,e,["source"]),k(t,0,"source",e.source,["default","server","cache"]))}function lu(t,e,n){if(e instanceof wa){if(e.firestore!==n)throw new l(c.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw H(t,"DocumentReference",1,e)}function fu(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return m()}}function pu(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var du={Firestore:qa,GeoPoint:_a,Timestamp:at,Blob:rt,Transaction:Ya,WriteBatch:Wa,DocumentReference:Ka,DocumentSnapshot:Za,Query:ou,QueryDocumentSnapshot:Ja,QuerySnapshot:su,CollectionReference:au,FieldPath:ua,FieldValue:ga,setLogLevel:qa.setLogLevel,CACHE_SIZE_UNLIMITED:Ha};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t){!function(t,e){t.INTERNAL.registerComponent(new u.Component("firestore",(function(t){return function(t,e){var n=new oa,r=new ia(n);return new qa(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},du)))}(t),t.registerVersion("@firebase/firestore","1.17.0")}vu(h.default),e.__PRIVATE_registerFirestore=vu}).call(this,n(42))},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"ErrorCode",(function(){return nr})),n.d(e,"EventType",(function(){return rr})),n.d(e,"WebChannel",(function(){return ir})),n.d(e,"XhrIo",(function(){return or})),n.d(e,"createWebChannelTransport",(function(){return er}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var o,s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},a=a||{},u=s||self;function h(){}function c(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function l(t){var e=c(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var p="closure_uid_"+(1e9*Math.random()>>>0),d=0;function v(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function g(t,e,n){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:y).apply(null,arguments)}function m(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now;function b(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function w(){this.j=this.j,this.i=this.i}w.prototype.j=!1,w.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,p)&&t[p]||(t[p]=++d)})(this)},w.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},E=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function T(t){return Array.prototype.concat.apply([],arguments)}function I(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var S,O=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function P(t,e){return-1!=t.indexOf(e)}function C(t,e){return t<e?-1:t>e?1:0}t:{var D=u.navigator;if(D){var N=D.userAgent;if(N){S=N;break t}}S=""}function R(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<L.length;o++)n=L[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function k(t){return k[" "](t),t}k[" "]=h;var F,j,B=P(S,"Opera"),V=P(S,"Trident")||P(S,"MSIE"),G=P(S,"Edge"),z=G||V,H=P(S,"Gecko")&&!(P(S.toLowerCase(),"webkit")&&!P(S,"Edge"))&&!(P(S,"Trident")||P(S,"MSIE"))&&!P(S,"Edge"),X=P(S.toLowerCase(),"webkit")&&!P(S,"Edge");function q(){var t=u.document;return t?t.documentMode:void 0}t:{var Y="",W=(j=S,H?/rv:([^\);]+)(\)|;)/.exec(j):G?/Edge\/([\d\.]+)/.exec(j):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(j):X?/WebKit\/(\S+)/.exec(j):B?/(?:Version)[ \/]?(\S+)/.exec(j):void 0);if(W&&(Y=W?W[1]:""),V){var K=q();if(null!=K&&K>parseFloat(Y)){F=String(K);break t}}F=Y}var Q,Z={};function J(t){return function(t,e){var n=Z;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=O(String(F)).split("."),r=O(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=C(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||C(0==s[2].length,0==a[2].length)||C(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(u.document&&V){var $=q();Q=$||(parseInt(F,10)||void 0)}else Q=void 0;var tt=Q,et=!V||9<=Number(tt),nt=V&&!J("9"),rt=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",h,e),u.removeEventListener("test",h,e)}catch(t){}return t}();function it(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function ot(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{k(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}it.prototype.b=function(){this.defaultPrevented=!0},b(ot,it);var st={2:"touch",3:"pen",4:"mouse"};ot.prototype.b=function(){ot.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,nt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var at="closure_listenable_"+(1e6*Math.random()|0),ut=0;function ht(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ut,this.Y=this.Z=!1}function ct(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function lt(t){this.src=t,this.a={},this.b=0}function ft(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=x(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ct(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new ht(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var dt="closure_lm_"+(1e6*Math.random()|0),vt={};function yt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Tt(r),e&&e[at]?e.wa(n,r,f(i)?!!i.capture:!!i,o):gt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=Tt(n),t&&t[at]?t.va(e,n,f(r)?!!r.capture:!!r,i):gt(t,e,n,!1,r,i)}function gt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=f(i)?!!i.capture:!!i;if(s&&!et)return null;var a=xt(t);if(a||(t[dt]=a=new lt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=wt,e=et?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)rt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function mt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[at])ft(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(ft(n,t),0==n.b&&(n.src=null,e[dt]=null)):ct(t)}}}function _t(t){return t in vt?vt[t]:vt[t]="on"+t}function bt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&mt(t),n.call(r,e)}function wt(t,e){if(t.Y)return!0;if(!et){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return bt(t,e=new ot(e,this))}return bt(t,new ot(e,this))}function xt(t){return(t=t[dt])instanceof lt?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tt(t){return"function"==c(t)?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function It(){w.call(this),this.c=new lt(this),this.J=this,this.C=null}function At(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&ft(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}b(It,w),It.prototype[at]=!0,(o=It.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},o.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=f(i)?!!i.capture:!!i,r=Tt(r),e&&e[at]?(e=e.c,(n=String(n).toString())in e.a&&(-1<(r=pt(s=e.a[n],r,i,o))&&(ct(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--)))):e&&(e=xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=pt(n,r,i,o)),(r=-1<e?n[e]:null)&&mt(r))}(this,t,e,n,r)},o.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new it(t,n);else if(t instanceof it)t.target=t.target||n;else{var i=t;U(t=new it(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=At(s,r,!0,t)&&i}if(i=At(s=t.a=n,r,!0,t)&&i,i=At(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=At(s=t.a=e[o],r,!1,t)&&i;return i},o.G=function(){if(It.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ct(n[r]);delete e.a[t],e.b--}}this.C=null},o.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},o.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var St=u.JSON.stringify;function Ot(){this.b=this.a=null}var Pt,Ct=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Nt}),(function(t){t.reset()}),100);function Dt(){var t=Ut,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Nt(){this.next=this.b=this.a=null}function Rt(t){u.setTimeout((function(){throw t}),0)}function Mt(t,e){Pt||function(){var t=u.Promise.resolve(void 0);Pt=function(){t.then(kt)}}(),Lt||(Pt(),Lt=!0),Ut.add(t,e)}Ot.prototype.add=function(t,e){var n=Ct.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Nt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Nt.prototype.reset=function(){this.next=this.b=this.a=null};var Lt=!1,Ut=new Ot;function kt(){for(var t;t=Dt();){try{t.a.call(t.b)}catch(t){Rt(t)}var e=Ct;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Lt=!1}function Ft(t,e){It.call(this),this.b=t||1,this.a=e||u,this.f=g(this.Ya,this),this.g=_()}function jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Bt(t,e,n){if("function"==c(t))n&&(t=g(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Vt(t){t.a=Bt((function(){t.a=null,t.c&&(t.c=!1,Vt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}b(Ft,It),(o=Ft.prototype).aa=!1,o.M=null,o.Ya=function(){if(this.aa){var t=_()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(jt(this),this.start()))}},o.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=_())},o.G=function(){Ft.S.G.call(this),jt(this),delete this.a};var Gt=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Vt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(u.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(w);function zt(t){w.call(this),this.b=t,this.a={}}b(zt,w);var Ht=[];function Xt(t,e,n,r){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function qt(t){R(t.a,(function(t,e){this.a.hasOwnProperty(e)&&mt(t)}),t),t.a={}}function Yt(){this.a=!0}function Wt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return St(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}zt.prototype.G=function(){zt.S.G.call(this),qt(this)},zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yt.prototype.info=function(){};var Kt=null;function Qt(){return Kt=Kt||new It}function Zt(t){it.call(this,"serverreachability",t)}function Jt(t){var e=Qt();e.dispatchEvent(new Zt(e,t))}function $t(t){it.call(this,"statevent",t)}function te(t){var e=Qt();e.dispatchEvent(new $t(e,t))}function ee(t){it.call(this,"timingevent",t)}function ne(t,e){if("function"!=c(t))throw Error("Fn must not be null and must be a function");return u.setTimeout((function(){t()}),e)}b(Zt,it),b($t,it),b(ee,it);var re={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function oe(){}function se(t){var e;return(e=t.a)||(e=t.a={}),e}function ae(){}oe.prototype.a=null;var ue,he={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ce(){it.call(this,"d")}function le(){it.call(this,"c")}function fe(){}function pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new zt(this),this.P=de,t=z?125:void 0,this.R=new Ft(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}b(ce,it),b(le,it),b(fe,oe),ue=new fe;var de=45e3,ve={},ye={};function ge(t,e,n){t.H=1,t.i=je(Re(e)),t.j=n,t.I=!0,me(t,null)}function me(t,e){t.u=_(),we(t),t.l=Re(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),Je(n.b,"t",r),t.D=0,t.a=Yn(t.g,t.g.C?e:null),0<t.O&&(t.F=new Gt(g(t.Ca,t,t.a),t.O)),Xt(t.J,t.a,"readystatechange",t.Wa),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Jt(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var h=a[u].split("=");if(1<h.length){var c=h[0];h=h[1];var l=c.split("_");s=2<=l.length&&"type"==l[1]?s+(c+"=")+h+"&":s+(c+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.T,t.j)}function _e(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=be(t,n);if(i==ye){4==e&&(t.h=4,te(14),r=!1),Wt(t.c,t.f,null,"[Incomplete Response]");break}if(i==ve){t.h=4,te(15),Wt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Wt(t.c,t.f,i,null),Ae(t,i)}4==e&&0==n.length&&(t.h=1,te(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),jn(e),e.F=!0)):(Wt(t.c,t.f,n,"[Invalid Chunked Response]"),Ie(t),Te(t))}function be(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ye:(n=Number(e.substring(n,r)),isNaN(n)?ve:(r+=1)+n>e.length?ye:(e=e.substr(r,n),t.D=r+n,e))}function we(t){t.U=_()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ne(g(t.Ua,t),e)}function Ee(t){t.o&&(u.clearTimeout(t.o),t.o=null)}function Te(t){0==t.g.v||t.A||Gn(t.g,t)}function Ie(t){Ee(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,jt(t.R),qt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ae(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||sn(n.b,t)))if(n.I=t.N,!t.C&&sn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Vn(n),Cn(n)}Fn(n),te(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=ne(g(n.Ra,n),6e3));if(1>=on(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Hn(n,11)}else if((t.C||n.a==t)&&Vn(n),!A(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var h=t.a;if(h){var c=h.a?h.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(c){var l=u.b;!l.a&&(P(c,"spdy")||P(c,"quic")||P(c,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(an(l,l.b),l.b=null))}if(u.A){var f=h.a?h.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Fe(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=_()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=qn(u,u.C?u.ga:null,u.fa),p.C){un(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(Ee(d),we(d)),u.a=p}else kn(u);0<n.g.length&&Rn(n)}else"stop"!=i[0]&&"close"!=i[0]||Hn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Hn(n,7):Pn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Jt(4)}catch(t){}}function Se(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)E(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(l(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Oe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Oe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Pe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ce(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ce(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ce(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(o=pe.prototype).setTimeout=function(t){this.P=t},o.Wa=function(t){t=t.target;var e=this.F;e&&3==In(t)?e.f():this.Ca(t)},o.Ca=function(t){try{if(t==this.a)t:{var e=In(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!z&&!this.a.$())){this.A||4!=e||7==n||Jt(8==n||0>=r?3:2),Ee(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,te(12),Ie(this),Te(this);break t}Wt(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ae(this,u)}this.I?(_e(this,e,o),z&&this.b&&3==e&&(Xt(this.J,this.R,"tick",this.Va),this.R.start())):(Wt(this.c,this.f,o,null),Ae(this,o)),4==e&&Ie(this),this.b&&!this.A&&(4==e?Gn(this.g,this):(this.b=!1,we(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,te(12)):(this.h=0,te(13)),Ie(this),Te(this)}}}catch(t){}},o.Va=function(){if(this.a){var t=In(this.a),e=this.a.$();this.D<e.length&&(Ee(this),_e(this,t,e),this.b&&4!=t&&we(this))}},o.cancel=function(){this.A=!0,Ie(this)},o.Ua=function(){this.o=null;var t=_();0<=t-this.U?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Jt(3),te(17)),Ie(this),this.h=2,Te(this)):xe(this,this.U-t)},(o=Oe.prototype).K=function(){Pe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},o.L=function(){return Pe(this),this.a.concat()},o.get=function(t,e){return Ce(this.b,t)?this.b[t]:e},o.set=function(t,e){Ce(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},o.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ne(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ne){this.a=void 0!==e?e:t.a,Me(this,t.f),this.j=t.j,Le(this,t.c),Ue(this,t.h),this.g=t.g,e=t.b;var n=new We;n.c=e.c,e.a&&(n.a=new Oe(e.a),n.b=e.b),ke(this,n),this.i=t.i}else t&&(n=String(t).match(De))?(this.a=!!e,Me(this,n[1]||"",!0),this.j=Be(n[2]||""),Le(this,n[3]||"",!0),Ue(this,n[4]),this.g=Be(n[5]||"",!0),ke(this,n[6]||"",!0),this.i=Be(n[7]||"")):(this.a=!!e,this.b=new We(null,this.a))}function Re(t){return new Ne(t)}function Me(t,e,n){t.f=n?Be(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Le(t,e,n){t.c=n?Be(e,!0):e}function Ue(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function ke(t,e,n){e instanceof We?(t.b=e,function(t,e){e&&!t.f&&(Ke(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qe(this,e),Je(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Ve(e,qe)),t.b=new We(e,t.a))}function Fe(t,e,n){t.b.set(e,n)}function je(t){return Fe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36)),t}function Be(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ve(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ge),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ge(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ne.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ve(e,ze,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Ve(e,ze,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ve(n,"/"==n.charAt(0)?Xe:He,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ve(n,Ye)),t.join("")};var ze=/[#\/\?@]/g,He=/[#\?:]/g,Xe=/[#\?]/g,qe=/[#\?@]/g,Ye=/#/g;function We(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ke(t){t.a||(t.a=new Oe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Qe(t,e){Ke(t),e=$e(t,e),Ce(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ce((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Pe(t)))}function Ze(t,e){return Ke(t),e=$e(t,e),Ce(t.a.b,e)}function Je(t,e,n){Qe(t,e),0<n.length&&(t.c=null,t.a.set($e(t,e),I(n)),t.b+=n.length)}function $e(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function tn(t,e){this.b=t,this.a=e}function en(t){this.g=t||nn,u.PerformanceNavigationTiming?t=0<(t=u.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(u.ia&&u.ia.ya&&u.ia.ya()&&u.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(o=We.prototype).add=function(t,e){Ke(this),this.c=null,t=$e(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},o.forEach=function(t,e){Ke(this),this.a.forEach((function(n,r){E(n,(function(n){t.call(e,n,r,this)}),this)}),this)},o.L=function(){Ke(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},o.K=function(t){Ke(this);var e=[];if("string"==typeof t)Ze(this,t)&&(e=T(e,this.a.get($e(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=T(e,t[n])}return e},o.set=function(t,e){return Ke(this),this.c=null,Ze(this,t=$e(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},o.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},o.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var nn=10;function rn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function on(t){return t.b?1:t.a?t.a.size:0}function sn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function an(t,e){t.a?t.a.add(e):t.b=e}function un(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function hn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var o=i(t.a.values()),s=o.next();!s.done;s=o.next()){var a=s.value;r=r.concat(a.s)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}return I(t.c)}function cn(){}function ln(){this.a=new cn}function fn(t,e,n){var r=n||"";try{Se(t,(function(t,n){var i=t;f(t)&&(i=St(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}en.prototype.cancel=function(){var t,e;if(this.c=hn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=i(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},cn.prototype.stringify=function(t){return u.JSON.stringify(t,void 0)},cn.prototype.parse=function(t){return u.JSON.parse(t,void 0)};var dn=u.JSON.parse;function vn(t){It.call(this),this.headers=new Oe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=yn,this.D=this.F=!1}b(vn,It);var yn="",gn=/^https?$/i,mn=["POST","PUT"];function _n(t){return"content-type"==t.toLowerCase()}function bn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,wn(t),En(t)}function wn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function xn(t){if(t.b&&void 0!==a&&(!t.s[1]||4!=In(t)||2!=t.X()))if(t.l&&4==In(t))Bt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==In(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(De)[1]||null;if(!o&&u.self&&u.self.location){var s=u.self.location.protocol;o=s.substr(0,s.length-1)}i=!gn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var h=2<In(t)?t.a.statusText:""}catch(t){h=""}t.f=h+" ["+t.X()+"]",wn(t)}}finally{En(t)}}}function En(t,e){if(t.a){Tn(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Tn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(u.clearTimeout(t.m),t.m=null)}function In(t){return t.a?t.a.readyState:0}function An(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return R(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Fe(t,e,n))}function Sn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function On(t){this.pa=0,this.g=[],this.c=new Yt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Sn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Sn("baseRetryDelayMs",5e3,t),this.Ma=Sn("retryDelaySeedMs",1e4,t),this.Ja=Sn("forwardChannelMaxRetries",2,t),this.ma=Sn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new en(t&&t.concurrentRequestLimit),this.ka=new ln,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Pn(t){if(Dn(t),3==t.v){var e=t.R++,n=Re(t.B);Fe(n,"SID",t.J),Fe(n,"RID",e),Fe(n,"TYPE","terminate"),Ln(t,n),(e=new pe(t,t.c,e,void 0)).H=2,e.i=je(Re(n)),n=!1,u.navigator&&u.navigator.sendBeacon&&(n=u.navigator.sendBeacon(e.i.toString(),"")),!n&&u.Image&&((new Image).src=e.i,n=!0),n||(e.a=Yn(e.g,null),e.a.ba(e.i)),e.u=_(),we(e)}Xn(t)}function Cn(t){t.a&&(jn(t),t.a.cancel(),t.a=null)}function Dn(t){Cn(t),t.j&&(u.clearTimeout(t.j),t.j=null),Vn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&u.clearTimeout(t.h),t.h=null)}function Nn(t,e){t.g.push(new tn(t.La++,e)),3==t.v&&Rn(t)}function Rn(t){rn(t.b)||t.h||(t.h=!0,Mt(t.Ba,t),t.u=0)}function Mn(t,e){var n;n=e?e.f:t.R++;var r=Re(t.B);Fe(r,"SID",t.J),Fe(r,"RID",n),Fe(r,"AID",t.P),Ln(t,r),t.i&&t.l&&An(r,t.i,t.l),n=new pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Un(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),an(t.b,n),ge(n,r,e)}function Ln(t,e){t.f&&Se({},(function(t,n){Fe(e,n,t)}))}function Un(t,e,n){n=Math.min(t.g.length,n);var r=t.f?g(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if(0>(h-=o))o=Math.max(0,i[u].b-100),a=!1;else try{fn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function kn(t){t.a||t.j||(t.U=1,Mt(t.Aa,t),t.o=0)}function Fn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=ne(g(t.Aa,t),zn(t,t.o)),t.o++,!0)}function jn(t){null!=t.s&&(u.clearTimeout(t.s),t.s=null)}function Bn(t){t.a=new pe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Re(t.la);Fe(e,"RID","rpc"),Fe(e,"SID",t.J),Fe(e,"CI",t.H?"0":"1"),Fe(e,"AID",t.P),Ln(t,e),Fe(e,"TYPE","xmlhttp"),t.i&&t.l&&An(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=je(Re(e)),n.j=null,n.I=!0,me(n,t)}function Vn(t){null!=t.m&&(u.clearTimeout(t.m),t.m=null)}function Gn(t,e){var n=null;if(t.a==e){Vn(t),jn(t),t.a=null;var r=2}else{if(!sn(t.b,e))return;n=e.s,un(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=_()-e.u;var i=t.u;(r=Qt()).dispatchEvent(new ee(r,n,e,i)),Rn(t)}else kn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(on(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.g=e.s.concat(t.g),!0):!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja))&&(t.h=ne(g(t.Ba,t,e),zn(t,t.u)),t.u++,!0))}(t,e)||2==r&&Fn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Hn(t,5);break;case 4:Hn(t,10);break;case 3:Hn(t,6);break;default:Hn(t,2)}}function zn(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function Hn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=g(t.Xa,t);n||(n=new Ne("//www.google.com/images/cleardot.gif"),u.location&&"http"==u.location.protocol||Me(n,"https"),je(n)),function(t,e){var n=new Yt;if(u.Image){var r=new Image;r.onload=m(pn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=m(pn,n,r,"TestLoadImage: error",!1,e),r.onabort=m(pn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=m(pn,n,r,"TestLoadImage: timeout",!1,e),u.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else te(2);t.v=0,t.f&&t.f.ra(e),Xn(t),Dn(t)}function Xn(t){t.v=0,t.I=-1,t.f&&(0==hn(t.b).length&&0==t.g.length||(t.b.c.length=0,I(t.g),t.g.length=0),t.f.qa())}function qn(t,e,n){var r=function(t){return t instanceof Ne?Re(t):new Ne(t,void 0)}(n);if(""!=r.c)e&&Le(r,e+"."+r.c),Ue(r,r.h);else{var i=u.location;r=function(t,e,n,r){var i=new Ne(null,void 0);return t&&Me(i,t),e&&Le(i,e),n&&Ue(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&R(t.W,(function(t,e){Fe(r,e,t)})),e=t.A,n=t.na,e&&n&&Fe(r,e,n),Fe(r,"VER",t.ha),Ln(t,r),r}function Yn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new vn(t.Ka)).F=t.C,e}function Wn(){}function Kn(){if(V&&!(10<=Number(tt)))throw Error("Environmental error: no available transport.")}function Qn(t,e){It.call(this),this.a=new On(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new $n(this)}function Zn(t){ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Jn(){le.call(this),this.status=1}function $n(t){this.a=t}(o=vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?se(this.H):se(ue),this.a.onreadystatechange=g(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void bn(this,t)}t=n||"";var i=new Oe(this.headers);r&&Se(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=_n,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=u.FormData&&t instanceof u.FormData,!(0<=x(mn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Tn(this),0<this.o&&((this.D=function(t){return V&&J(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=g(this.xa,this)):this.m=Bt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){bn(this,t)}},o.xa=function(){void 0!==a&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},o.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),En(this))},o.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),En(this,!0)),vn.S.G.call(this)},o.za=function(){this.j||(this.A||this.l||this.g?xn(this):this.Ta())},o.Ta=function(){xn(this)},o.X=function(){try{return 2<In(this)?this.a.status:-1}catch(t){return-1}},o.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},o.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),dn(e)}},o.ua=function(){return this.h},o.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(o=On.prototype).ha=8,o.v=1,o.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?U(r=M(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Un(this,n,e),Fe(i=Re(this.B),"RID",t),Fe(i,"CVER",22),this.A&&Fe(i,"X-HTTP-Session-Id",this.A),Ln(this,i),this.i&&r&&An(i,this.i,r),an(this.b,n),this.Ga&&Fe(i,"TYPE","init"),this.da?(Fe(i,"$req",e),Fe(i,"SID","null"),n.V=!0,ge(n,i,null)):ge(n,i,e),this.v=2}}else 3==this.v&&(t?Mn(this,t):0==this.g.length||rn(this.b)||Mn(this))},o.Aa=function(){if(this.j=null,Bn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=ne(g(this.Sa,this),t)}},o.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Cn(this),Bn(this))},o.Ra=function(){null!=this.m&&(this.m=null,Cn(this),Fn(this),te(19))},o.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),te(2)):(this.c.info("Failed to ping google.com"),te(1))},(o=Wn.prototype).ta=function(){},o.sa=function(){},o.ra=function(){},o.qa=function(){},o.Ha=function(){},Kn.prototype.a=function(t,e){return new Qn(t,e)},b(Qn,It),(o=Qn.prototype).addEventListener=function(t,e,n,r){Qn.S.addEventListener.call(this,t,e,n,r)},o.removeEventListener=function(t,e,n,r){Qn.S.removeEventListener.call(this,t,e,n,r)},o.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;te(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=qn(t,null,t.fa),Rn(t)},o.close=function(){Pn(this.a)},o.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,Nn(this.a,e)}else this.g?((e={}).__data__=St(t),Nn(this.a,e)):Nn(this.a,t)},o.G=function(){this.a.f=null,delete this.f,Pn(this.a),delete this.a,Qn.S.G.call(this)},b(Zn,ce),b(Jn,le),b($n,Wn),$n.prototype.ta=function(){this.a.dispatchEvent("a")},$n.prototype.sa=function(t){this.a.dispatchEvent(new Zn(t))},$n.prototype.ra=function(t){this.a.dispatchEvent(new Jn(t))},$n.prototype.qa=function(){this.a.dispatchEvent("b")},Kn.prototype.createWebChannel=Kn.prototype.a,Qn.prototype.send=Qn.prototype.Pa,Qn.prototype.open=Qn.prototype.Oa,Qn.prototype.close=Qn.prototype.close,re.NO_ERROR=0,re.TIMEOUT=8,re.HTTP_ERROR=6,ie.COMPLETE="complete",ae.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",It.prototype.listen=It.prototype.va,vn.prototype.listenOnce=vn.prototype.wa,vn.prototype.getLastError=vn.prototype.Qa,vn.prototype.getLastErrorCode=vn.prototype.ua,vn.prototype.getStatus=vn.prototype.X,vn.prototype.getResponseJson=vn.prototype.Na,vn.prototype.getResponseText=vn.prototype.$,vn.prototype.send=vn.prototype.ba;var tr={createWebChannelTransport:function(){return new Kn},ErrorCode:re,EventType:ie,WebChannel:ae,XhrIo:vn},er=tr.createWebChannelTransport,nr=tr.ErrorCode,rr=tr.EventType,ir=tr.WebChannel,or=tr.XhrIo;e.default=tr}.call(this,n(25))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.alea=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xor128=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xorwow=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xorshift7=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,i=0==(n=a[127&o]^=r+s)?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;t.w=s,t.X=a,t.i=i}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.xor4096=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){(function(t){var r;!function(t,i,o){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=u:n(18)&&n(30)?void 0===(r=function(){return u}.call(e,n,e,i))||(i.exports=r):this.tychei=u}(0,t,n(18))}).call(this,n(26)(t))},function(t,e,n){var r;!function(i,o,s){var a,u=s.pow(256,6),h=s.pow(2,52),c=2*h;function l(t,e,n){var r=[],l=d(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(o)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(256):(t=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(t)),v(t)}catch(t){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,v(o)]}}():t,3),r),y=new f(r),g=function(){for(var t=y.g(6),e=u,n=0;t<h;)t=256*(t+n),e*=256,n=y.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return g.int32=function(){return 0|y.g(4)},g.quick=function(){return y.g(4)/4294967296},g.double=g,d(v(y.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&p(r,y),t.state=function(){return p(y,{})}),n?(s.random=t,e):t})(g,l,"global"in e?e.global:this==s,e.state)}function f(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<256;)s[i]=i++;for(i=0;i<256;i++)s[i]=s[o=255&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=255&i+1],n=256*n+s[255&(s[i]=s[o=255&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(d(s.random(),o),t.exports){t.exports=l;try{a=n(68)}catch(t){}}else void 0===(r=function(){return l}.call(e,n,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)}]]);
//# sourceMappingURL=vendors~main~main_replay.bb6e892b11c3180eddc7.js.map